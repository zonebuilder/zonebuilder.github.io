/*
	JUL - The JavaScript UI Language version 1.6.1
	Copyright (c) 2012 - 2018 The Zonebuilder <zone.builder@gmx.com>
	http://sourceforge.net/projects/jul-javascript/
	Licenses: GNU GPLv2 or later; GNU LGPLv3 or later (http://sourceforge.net/p/jul-javascript/wiki/License/)
 */
!function(t){"use strict";t.JUL={},JUL={nsRoot:null,version:"1.6.1",Instance:function(t){if(!(this instanceof JUL.Instance))return new JUL.Instance(t);JUL.apply(this,t||{});var e=this,r=function(){return e},s=function(t,e){if(!(this instanceof s))return new s(t,e);JUL.Ref.call(this,t,e)};s.prototype=new JUL.Ref,s.prototype.constructor=s,s.prototype._getJulInstance=r,this.ref=s,this.ui=new JUL.UI.Parser,this.ui._getJulInstance=r,this.parser=this.ui.Parser},apply:function(t,e,r,s,i){if(!e||"object"!=typeof e)return t;s&&(s=[].concat(s)),i&&(i=[].concat(i));for(var n=r?{}:t,o=[].concat(e),a=0;a<o.length;a++){e=o[a];for(var h in e)e.hasOwnProperty(h)&&(!s||s.indexOf(h)<0)&&(!i||i.indexOf(h)>-1)&&(n[h]=e[h])}if(!r)return t;for(h in n)n.hasOwnProperty(h)&&void 0===t[h]&&(t[h]=n[h]);return t},get:function(e,r){var s=r||this.nsRoot||t;if(!e)return s;if("string"!=typeof e)return e;var i=e.replace(/\\\./g,":::::").split(".");!r&&i.length>1&&("window"===i[0]||"global"===i[0])&&(i.shift(),s=t);for(var n="";i.length;)if(n=i.shift().replace(/:{5}/g,".")){if(void 0===s[n])return s[n];s=s[n]}return s},getInstance:function(t){return t instanceof JUL.Ref||t instanceof JUL.UI.Parser?t._getJulInstance?t._getJulInstance():JUL:t===JUL.UI?JUL:null},makeCaller:function(t,e,r){if(!t||!e&&0!==e)return null;if("function"!=typeof e&&"function"!=typeof(e=t[e]))return null;r=(r||!1)&&!0,this._callers=this._callers||[];for(var s=0;s<this._callers.length;s++)if(t===this._callers[s][0]&&e===this._callers[s][1]&&r===this._callers[s][2])return this._callers[s][3];var i=r?function(){return e.apply(t,[].slice.call(arguments).concat([this]))}:function(){return e.apply(t,[].slice.call(arguments))};return this._callers.length>16383&&(this._callers=this._callers.slice(1024,16384)),this._callers.push([t,e,r,i]),i},ns:function(e,r,s){var i=e?e.replace(/\\\./g,":::::").split("."):[],n="",o=/^(\d|[1-9]\d+)$/,a=s||this.nsRoot||t;for(!s&&i.length>1&&("window"===i[0]||"global"===i[0])&&(i.shift(),a=t);i.length;)(n=i.shift().replace(/:{5}/g,"."))&&(void 0===a[n]&&(a[n]=i.length&&o.test(i[0])?[]:{}),i.length||void 0===r||(a[n]=r),a=a[n]);return a},trim:function(t,e,r){if("string"!=typeof t&&(t=t.toString()),!t)return t;var s=void 0===r;if(!s&&!0!==r&&!1!==r||s&&!e&&0!==e)return"function"==typeof String.prototype.trim?t.trim():t.replace(/\s+$/,"").replace(/^\s+/,"");if(!e&&0!==e)return r?t.replace(/^\s+/,""):t.replace(/\s+$/,"");if("string"!=typeof e&&(e=e.toString()),s||!1===r){for(var i=t.length;i>=e.length&&t.slice(i-e.length,i)===e;)i-=e.length;i<t.length&&(t=t.slice(0,i))}if(t.length<e.length)return t;if(s||!0===r){for(var n=0;n<=t.length-e.length&&t.slice(n,n+e.length)===e;)n+=e.length;n&&(t=t.substr(n))}return t},typeOf:function(t){return{}.toString.call(t).match(/\w+/g)[1]},_getAutoInstance:function(t){if((t=t||null)===this.nsRoot)return this;this._autoInstances=this._autoInstances||[];for(var e=0;e<this._autoInstances.length;e++)if(t===this._autoInstances[e].nsRoot)return this._autoInstances[e].getInstance;var r=new JUL.Instance({nsRoot:t}),s=function(){return r};return this._autoInstances.length>1023&&(this._autoInstances=this._autoInstances.slice(64,1024)),this._autoInstances.push({nsRoot:t,getInstance:s}),s}},"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(t,e){for(var r=e||0;r<this.length;r++)if(this[r]===t)return r;return-1}),"function"!=typeof Array.prototype.map&&(Array.prototype.map=function(t,e){if("function"!=typeof t)return null;for(var r=[],s=0;s<this.length;s++)r.push(e?t.call(e,this[s],s,this):t(this[s],s,this));return r}),JUL.apply(JUL.Instance.prototype,JUL,!1,["Instance","Ref","UI","version","_getAutoInstance"])}("undefined"!=typeof global?global:window),function(){"use strict";var t=JUL;t.ns("JUL.Ref"),t.ns("JUL.Ref",function(t,e){if(!(this instanceof JUL.Ref))return new JUL.Ref(t,e);if(void 0!==t)if(void 0===e){if(t&&"string"==typeof t)t=t.replace(/\\\./g,":::::").split("."),e=t.pop().replace(/:{5}/g,"."),void 0!==(t=JUL.getInstance(this).get(t.join(".").replace(/:{5}/g,"\\.")))&&(this._ref=t,this._key=e);else if(t instanceof JUL.Ref)JUL.apply(this,t);else if("Object"===JUL.typeOf(t)&&t.hasOwnProperty("ref")&&t.hasOwnProperty("key")){t.nsRoot&&(this._getJulInstance=JUL._getAutoInstance(t.nsRoot)),this._ref=t.ref,this._key=t.key;for(var r in t)t.hasOwnProperty(r)&&"key"!==r&&"ref"!==r&&"nsRoot"!==r&&(this[r]=t[r])}}else this._ref=t,this._key=e}),t.apply(t.get("JUL.Ref").prototype,{del:function(){return delete this._ref[this._key],this},key:function(t){return void 0!==t?(this._key=t,this):this._key},ref:function(t,e){if(void 0===t)return this._ref;if(!0===t)return this._key;if(void 0!==e)this._key=e;else if(t&&"string"==typeof t)return t=t.replace(/\\\./g,":::::").split("."),e=t.pop().replace(/:{5}/g,"."),t=JUL.getInstance(this).get(t.join(".").replace(/:{5}/g,"\\.")),void 0!==t&&(this._ref=t,this._key=e),this;return!1!==t&&(this._ref=t),this},val:function(t){return void 0!==t?(this._ref[this._key]=t,this):this._ref[this._key]}})}(),function(t){"use strict";var e=JUL;e.ns("JUL.UI"),e.apply(e.get("JUL.UI"),{bindingProperty:"cid",childrenProperty:"children",classProperty:"xclass",cssProperty:"css",customFactory:null,defaultClass:"Object",htmlProperty:"html",idProperty:"id",includeProperty:"include",instantiateProperty:"instantiate",membersMappings:{},membersProperties:[],parentProperty:"parent",parserProperty:"parserConfig",referencePrefix:"=ref:",tagProperty:"tag",textProperty:"text",topDown:!1,useTags:!1,xmlNS:{aml:"http://www.amplesdk.com/ns/aml",aui:"http://www.amplesdk.com/ns/aui",chart:"http://www.amplesdk.com/ns/chart",html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",xform:"http://www.w3.org/2002/xforms",xul:"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"},Parser:function(t){if(!(this instanceof JUL.UI.Parser)||this.hasOwnProperty("Parser"))return this&&"function"==typeof this.Parser&&this.Parser.prototype instanceof JUL.UI.Parser?new this.Parser(t):this&&this.ui&&this.ui instanceof JUL.UI.Parser?new this.ui.Parser(t):new JUL.UI.Parser(t);t=t||{},t.nsRoot&&(this._getJulInstance=JUL._getAutoInstance(t.nsRoot)),JUL.apply(this,t,!1,"nsRoot"),this.Parser=function(t){var e=JUL.UI.Parser.call(this,t);if("object"==typeof e)return e},this.Parser.prototype=this},compact:function(t,e,r){if(!t||"object"!=typeof t)return t;if("Array"===JUL.typeOf(t)){for(var s=[],i=0;i<t.length;i++)s.push(this.compact(t[i],e,r));return s}if(t=this.include(t),"Array"!==JUL.typeOf(t[this.childrenProperty]))return t;for(var n=[],o={},a=0;a<t[this.childrenProperty].length;a++){var h=t[this.childrenProperty][a],l=h[this.classProperty]||this.defaultClass,c=this.useTags?l+":"+h[this.tagProperty]:l;n.indexOf(c)<0?n.push(c):o[c]=!0}var p={};for(var u in t)t.hasOwnProperty(u)&&u!==this.childrenProperty&&(p[u]=t[u]);var f={};for(void 0===r&&(r=(this.membersProperties||[]).length),a=0;a<t[this.childrenProperty].length;a++){h=t[this.childrenProperty][a],l=h[this.classProperty]||this.defaultClass,c=this.useTags?l+":"+h[this.tagProperty]:l;var y=this.useTags&&l===this.defaultClass?h[this.tagProperty]:c,g="object"==typeof h[this.childrenProperty]&&h[this.childrenProperty].length,d=(this.membersProperties||[]).indexOf(y);if(g&&(d<0||d>=r))if(e){for(u in h)if(h.hasOwnProperty(u)&&u!==this.classProperty&&u!==this.childrenProperty&&(!this.useTags||u!==this.tagProperty)){g=!1;break}}else g=!1;g&&!o[c]?f[y]=h[this.childrenProperty]:(f[this.childrenProperty]=f[this.childrenProperty]||[],f[this.childrenProperty].push(h))}for(u in f)if(f.hasOwnProperty(u))for(p[u]=f[u],u!==this.childrenProperty&&(this.membersProperties||[]).indexOf(u)<0&&(this.membersProperties=this.membersProperties||[],this.membersProperties.push(u)),a=0;a<f[u].length;a++)f[u][a]=this.compact(f[u][a],e,r);return p},create:function(t,e,r,s){var i=JUL.typeOf(t);if(["Array","Object"].indexOf(i)<0)return null;if(["Array","Object"].indexOf(JUL.typeOf(e))<0&&(e=null),e){var n=[].concat(e);e={};for(var o=0;o<n.length;o++){var a=n[o];if(a[this.includeProperty]){e[this.includeProperty]||(e[this.includeProperty]=[]);for(var h=[].concat(a[this.includeProperty]),l=0;l<h.length;l++)e[this.includeProperty].indexOf(h[l])<0&&e[this.includeProperty].push(h[l])}JUL.apply(e,a,!1,this.includeProperty)}e[this.includeProperty]&&(e=this.include(e))}if("Array"===i)return t.map(function(t){return this.create(t,e,r)},this);for(var c=JUL.getInstance(this),p={root:t},u={root:r},f=[new JUL.Ref({ref:p,key:"root",parent:r?new JUL.Ref(u,"root"):null})],y=f;f.length;){for(var g=[],d=0;d<f.length;d++){var P=f[d];if(P.config=P.val(),"Object"===(i=JUL.typeOf(P.config))||s&&"Array"===i)if("Array"!==i){if(!P.config[this.parserProperty]){var m=!s||P.config[this.classProperty]||this.useTags&&P.config[this.tagProperty];delete P.config[this._instanceProperty];var v=m?this.include(P.config):JUL.apply({},P.config);if(m){if(v[this.bindingProperty]){if(e)for(var _=[].concat(v[this.bindingProperty]),b=0;b<_.length;b++)e[_[b]]&&JUL.apply(v,e[_[b]]);delete v[this.bindingProperty]}v[this.idProperty]&&e&&e[v[this.idProperty]]&&JUL.apply(v,e[v[this.idProperty]])}P.val(v),P.sparse=!m;var x=m?this.getMembers(v):[];m&&delete v[this.instantiateProperty];for(var w in v){if(v.hasOwnProperty(w)){var U=m&&x.indexOf(w)>-1;if(i=JUL.typeOf(v[w]),["Array","Object"].indexOf(i)>-1&&(U||s)){var J=[].concat(v[w]);if("Array"===i||U&&this.topDown)for(var L=0;L<J.length;L++)["Array","Object"].indexOf(JUL.typeOf(J[L]))>-1&&g.push(new JUL.Ref({ref:J,key:L,parent:P}));else g.push(new JUL.Ref({ref:v,key:w,parent:P}));U&&this.topDown?delete v[w]:"Array"===i&&(v[w]=J)}}if("String"===i&&this.referencePrefix&&!U&&w!==this.idProperty){var O=v[w].substr(0,this.referencePrefix.length+1);O==="\\"+this.referencePrefix?v[w]=v[w].substr(1):O.substr(0,this.referencePrefix.length)===this.referencePrefix&&JUL.trim(v[w].substr(this.referencePrefix.length))&&(v[w]=c.get(JUL.trim(v[w].substr(this.referencePrefix.length))))}}}}else{for(var j=[].concat(P.config),I=0;I<j.length;I++)["Array","Object"].indexOf(JUL.typeOf(j[I]))>-1&&g.push(new JUL.Ref(j,I));P.val(j),P.sparse=!0,delete P.config}}y=this.topDown?y.concat(g):g.concat(y),f=g}for(d=0;d<y.length;d++)if(P=y[d],P.val())if(P.val()[this.parserProperty]){var S=JUL.apply({},P.val()),T=new this.Parser(S[this.parserProperty]);delete S[this.parserProperty],P.val(T.create(S,e,this.topDown&&P.parent?P.parent.val():null))}else P.sparse||(this.topDown&&(P.val()[this.parentProperty]=P.parent?P.parent.val():null),P.val(this.createComponent(P.val()))),this._keepInstance&&P.config&&(P.config[this._instanceProperty]=P.val());return p.root},createComponent:function(t){t[this.classProperty]||(t[this.classProperty]=this.defaultClass);var e="";t[this.idProperty]&&(e=t[this.idProperty].replace(/\\\./g,":::::"),t[this.idProperty]=t[this.idProperty].replace(/\\\./g,"--").replace(/\./g,"-"),["window.","global."].indexOf(e.substr(0,7))>-1&&(t[this.idProperty]=t[this.idProperty].substr(7)),"."===e.substr(0,1)&&(t[this.idProperty]=t[this.idProperty].substr(1)));var r=JUL.getInstance(this),s=t[this.classProperty];this.customFactory||delete t[this.classProperty];var i=this.customFactory?r.get(this.customFactory).call(this,t):this.factory(s,t);return e.indexOf(".")>-1?r.ns(e.replace(/:{5}/g,"\\.").replace(/-/g,"_"),i):i},createDom:function(e,r){if(!e)return null;var s=JUL.getInstance(this),i=this.useTags?-1:e[this.classProperty].indexOf(":"),n=i>-1?e[this.classProperty].substr(0,i):this.useTags?e[this.classProperty]:"html",o=this._domDocument?s.get(this._domDocument):t.document||(t.window?t.window.document:null),a="object"==typeof t.ample;if(a&&(o=t.ample),"#text"===(this.useTags?e[this.tagProperty]:e[this.classProperty].substr(i+1)))return r?r.nodeValue=e.value:r=o.createTextNode(e.value),r;if(!(r=r||("html"===n||"function"!=typeof o.createElementNS?o.createElement.apply(o,[i>-1?e[this.classProperty].substr(i+1):this.useTags?e[this.tagProperty]:e[this.classProperty]].concat(e.is||[])):o.createElementNS.apply(o,[this.xmlNS[n]||null,i>-1?e[this.classProperty]:n+":"+(this.useTags?e[this.tagProperty]:e[this.classProperty])].concat(e.is||[])))))return null;if(e.listeners&&"object"==typeof e.listeners){var h=e.listeners,l=h.scope?s.get(h.scope):null;for(var c in h)if(h.hasOwnProperty(c)&&"scope"!==c)for(var p=[].concat(h[c]),u=0;u<p.length;u++){var f=s.get(p[u]);if(f){var y={fn:f,scope:l,useCapture:!1};"object"==typeof f&&(JUL.apply(y,f),f.scope&&(y.scope=s.get(f.scope))),a||r.addEventListener?r.addEventListener(c,y.scope?s.makeCaller(y.scope,y.fn,!0):y.fn,y.useCapture):r.attachEvent("on"+c,s.makeCaller(y.scope||r,y.fn,!0))}}}var g=this.getMembers(e);for(c in e)if(e.hasOwnProperty(c)&&g.indexOf(c)<0&&["listeners",this.cssProperty,"style",this.textProperty,this.htmlProperty,this.tagProperty,this.classProperty,this.parentProperty].indexOf(c)<0){i=c.indexOf(":");var d=["Array","Date","Function","Object","Null","RegExp"].indexOf(JUL.typeOf(e[c]))>-1?this.obj2str(e[c]):e[c];i>-1&&"function"==typeof r.setAttributeNS?r.setAttributeNS(this.xmlNS[c.substr(0,i)]||null,c,d):r.setAttribute(c,d)}e[this.cssProperty]&&r.setAttribute("class",e[this.cssProperty]),e.style&&(a?r.setAttribute("style",e.style):r.style.cssText=r.style.cssText+";"+e.style),e[this.textProperty]&&(a?t.ample.query(r).text(e[this.textProperty]):r["textContent"in r?"textContent":"innerText"]=e[this.textProperty]),e[this.htmlProperty]&&(a?t.ample.query(r).html("<"===e[this.htmlProperty].substr(0,1)&&">"===e[this.htmlProperty].substr(-1)?e[this.htmlProperty]:"<span>"+e[this.htmlProperty]+"</span>"):r.innerHTML=e[this.htmlProperty]);for(c in e)if(e.hasOwnProperty(c)&&e[c]&&"object"==typeof e[c]&&g.indexOf(c)>-1){var P=[].concat(e[c]),m=r;c!==this.childrenProperty&&(i=c.indexOf(":"),n=i>-1?c.substr(0,i):this.useTags?this.defaultClass:"html",m="html"===n||"function"!=typeof o.createElementNS?o.createElement.apply(o,[i>-1?c.substr(i+1):c].concat(e.is||[])):o.createElementNS.apply(o,[this.xmlNS[n]||null,i>-1?c:n+":"+c].concat(e.is||[])));for(var v=0;v<P.length;v++)m.appendChild(P[v]);c!==this.childrenProperty&&r.appendChild(m)}return this.topDown&&e[this.parentProperty]&&"object"==typeof e[this.parentProperty]&&e[this.parentProperty].appendChild(r),r},createVDom:function(e){if(!e)return null;var r=JUL.getInstance(this),s=this._createElement?r.get(this._createElement):null,i="function"==typeof s,n=this._domDocument?r.get(this._domDocument):null;if(!(s=s||(n?n.createElement:null)))return null;e=JUL.apply({},e);var o=this.useTags?e[this.tagProperty]:e[this.classProperty];if("string"==typeof o){if("#text"===o.split(":").pop())return e.value;this.useTags&&e[this.classProperty]!==this.defaultClass&&(o=e[this.classProperty]+":"+o)}delete e[this.classProperty],delete e[this.tagProperty];var a=[];if(e[this.textProperty]&&a.push(e[this.textProperty]),delete e[this.textProperty],e[this.htmlProperty]){if("string"==typeof e[this.htmlProperty])try{this._createDiv=this._createDiv||(t.document||(t.window?t.window.document:null)).createElement("div"),this._createDiv.innerHTML=e[this.htmlProperty].replace(/<script(\s|\S)+?\/script>/g,""),e[this.htmlProperty]=this.xml2jul(this._createDiv,!1,!0)[this.childrenProperty]||[],this._createDiv.innerHTML=""}catch(t){a=[e[this.htmlProperty]]}"object"==typeof e[this.htmlProperty]&&(a=[].concat(this.create(e[this.htmlProperty])))}delete e[this.htmlProperty],e[this.cssProperty]&&("string"==typeof e[this.cssProperty]?e.className=e[this.cssProperty]:e.class=e[this.cssProperty]),delete e[this.cssProperty];var h="Object"===JUL.typeOf(e[this.childrenProperty]);a=a.concat(e[this.childrenProperty]||[]),delete e[this.childrenProperty];for(var l in e)e.hasOwnProperty(l)&&"string"==typeof e[l]&&"{<"===e[l].substr(0,2)&&">}"===e[l].substr(-2)&&(e[l]=this.xml2jul("<div>"+e[l].slice(1,-1)+"</div>")[this.childrenProperty],e[l].length<2&&(e[l]=e[l][0]),e[l]=this.create(e[l]));return a.length?a.length<2&&(h||"string"==typeof a[0])&&(a=a[0]):a=null,i?s(o,e,a):s.call(n,o,e,a)},expand:function(t){if(!t||"object"!=typeof t)return t;if("Array"===JUL.typeOf(t))return t.map(this.expand,this);t=this.include(t);var e=[],r=this.getMembers(t);delete t[this.instantiateProperty];for(var s in t)if(t.hasOwnProperty(s)&&t[s]&&"object"==typeof t[s]&&r.indexOf(s)>-1)if(s===this.childrenProperty)e=e.concat(t[s]);else{var i={};if(this.useTags||s===this.defaultClass||(i[this.classProperty]=s),this.useTags){var n=s.indexOf(":");n>-1&&s.substr(0,n)!==this.defaultClass&&(i[this.classProperty]=s.substr(0,n)),i[this.tagProperty]=n>-1?s.substr(n+1):s}i[this.childrenProperty]=[].concat(t[s]),delete t[s],e.push(i)}if(e.length){t[this.childrenProperty]=e;for(var o=0;o<e.length;o++)e[o]=this.expand(e[o])}return t},factory:function(t,e){var r=JUL.getInstance(this).get(t);return"function"!=typeof r?null:e?new r(e):new r},getMembers:function(t){var e=[].concat(this.childrenProperty,this.membersProperties||[]);if(!t)return e;var r=[];(!this.useTags||t[this.classProperty]&&t[this.classProperty]!==this.defaultClass)&&r.push(t[this.classProperty]||this.defaultClass),this.useTags&&r.push(t[this.tagProperty]);var s=this.membersMappings||{};return e.concat(s[r.join(":")]||[],t[this.instantiateProperty]||[])},include:function(t,e){var r={};if(!t[this.includeProperty])return JUL.apply(r,t);var s=e&&"function"==typeof e;!s&&this._includeMerger&&(e=this._includeMerger,s="function"==typeof e);for(var i=JUL.getInstance(this),n=[].concat(t[this.includeProperty]),o=0;o<n.length;o++){var a=i.get(n[o]);a&&(s?e.call(this,r,this.include(a,e)):JUL.apply(r,this.include(a)))}var h=r[this.bindingProperty]?[].concat(r[this.bindingProperty]):[];return t[this.bindingProperty]&&h.indexOf(t[this.bindingProperty])<0&&h.push(t[this.bindingProperty]),s?e.call(this,r,t):JUL.apply(r,t),h.length&&(r[this.bindingProperty]=h),delete r[this.includeProperty],r},obj2str:function(t,e,r){if(void 0===this._useJsonize){var s=function(){};this._useJsonize=JSON.stringify({o:s},JUL.makeCaller(JUL.UI,"_jsonReplacer")).indexOf("function")<0}var i=this._useJsonize?JSON.stringify(this._jsonize(t)):JSON.stringify(t,JUL.getInstance(this).makeCaller(this,"_jsonReplacer"));if(!i)return"";for(var n="#",o="",a="",h="",l="",c=!1,p=[],u=[],f=0,y=0,g=0,d=0;d<i.length;d++)if(o=i.substr(d,1),'"'===o&&"\\"!==n&&(c=!c)&&(f=d),c)e&&(h+=o),n=o;else{if(!e&&"{[,]}".indexOf(o)>-1&&"]}".indexOf(n)<0&&(h+=r?r.call(t,l,u.map(function(t){return t.toString().replace(/\./g,"\\.")}).join("."),a):l,l=""),'"'!==o||e)"{"===o||"["===o?(!e&&r&&u.push("["===o?0:""),p.push(o),1===p.length&&"}"!==i.substr(d+1,1)&&"]"!==i.substr(d+1,1)||"{"===o&&":"===n&&"}"!==i.substr(d+1,1)||"["===o&&("{"===i.substr(d+1,1)||"["===i.substr(d+1,1))?(a+=this._tabString,h=h+o+this._newlineString+a,y=h.length):h+=o):","===o?(this._phraseLength&&g&&h.length>y+this._phraseLength&&(h=h.slice(0,g)+this._newlineString+a+h.substr(g),y=g+this._newlineString.length+a.length),g=h.length+1,!e&&r&&p.length&&"["===p[p.length-1]&&u[u.length-1]++,1===p.length||"~"===n||("}"===n||"]"===n)&&"{"!==i.substr(d-2,1)&&"["!==i.substr(d-2,1)?(h=h+o+this._newlineString+a,y=h.length,g=0):e?h+=o:h=h+o+this._spaceString):"}"===o||"]"===o?(this._phraseLength&&g&&h.length>y+this._phraseLength&&(h=h.slice(0,g)+this._newlineString+a+h.substr(g),y=g+this._newlineString.length+a.length),g=0,!e&&r&&u.pop(),p.pop(),!p.length&&"{"!==n&&"["!==n||"}"===o&&p.length&&"{"===p[p.length-1]&&"{"!==n||"]"===o&&("}"===n||"]"===n)?(a=a.substr(this._tabString.length),h=h+this._newlineString+a+o,y=h.length-1):h+=o):e?h+=o:l+=":"===o?o+this._spaceString:o;else{var P=JSON.parse(i.substr(f,d-f+1));if(":"===i.substr(d+1,1))r&&(u[u.length-1]=P),l+=this._regExps.keyword.test(P)||!this._regExps.variable.test(P)&&!this._regExps.uint.test(P)?this._useDoubleQuotes?i.substr(f,d-f+1):"'"+i.substr(f+1,d-f-1).replace(/\\"/g,'"').replace(/'/g,"\\'")+"'":P;else{var m=!1;if(this._usePrefixes&&(P.substr(0,this._jsonPrefixes.func.length)===this._jsonPrefixes.func&&JUL.trim(P.substr(this._jsonPrefixes.func.length))?(m=!0,P=P.substr(this._jsonPrefixes.func.length).replace(/^\s+/,"")):P.substr(0,this._jsonPrefixes.newop.length)===this._jsonPrefixes.newop&&JUL.trim(P.substr(this._jsonPrefixes.newop.length))&&(m=!0,P=P.substr(this._jsonPrefixes.newop.length).replace(/^\s+/,""))),m||!this._usePrefixes&&(this._regExps.functionStart.test(P)||this._regExps.newStart.test(P))){var v=P.match(/\n(\s|\t)+\}$/);v&&(v=v[0].substr(0,v[0].length-1),P=P.replace(new RegExp(v,"g"),"\n")),P=P.replace(/\t/g,this._tabString).replace(/\n\r?/g,this._newlineString+a),l+=P,n="~";continue}if(m=!1,this._usePrefixes&&P.substr(0,this._jsonPrefixes.regex.length)===this._jsonPrefixes.regex&&JUL.trim(P.substr(this._jsonPrefixes.regex.length))&&(m=!0,P=P.substr(this._jsonPrefixes.regex.length).replace(/^\s+/,"")),this._usePrefixes)for(var _ in this._jsonPrefixes)this._jsonPrefixes.hasOwnProperty(_)&&P.substr(0,this._jsonPrefixes[_].length+1)==="\\"+this._jsonPrefixes[_]&&(P=P.substr(1));this.referencePrefix&&P.substr(0,this.referencePrefix.length)===this.referencePrefix&&JUL.trim(P.substr(this.referencePrefix.length))&&(m=!0,P=P.substr(this.referencePrefix.length).replace(/^\s+/,"")),this.referencePrefix&&P.substr(0,this.referencePrefix.length+1)==="\\"+this.referencePrefix&&(P=P.substr(1)),l+=m||!this._usePrefixes&&this._regExps.regexp.test(P)?P:this._useDoubleQuotes?i.substr(f,d-f+1):"'"+i.substr(f+1,d-f-1).replace(/\\"/g,'"').replace(/'/g,"\\'")+"'"}}n=o}return!e&&l&&(h+=r?r.call(t,l,"",a):l),h},xml2jul:function(e,r,s){if("object"!=typeof e){try{var i=e.replace(/&(lt|gt|amp);/g,";;;;~;$1;").replace(/&(#?\w+;)/g,";;;;0;$1").replace(/[<>&]/g,function(t){switch(t){case"<":return";;;;1;";case">":return";;;;2;";case"&":return";;;;3;"}return t}).replace(/;{4}0;/g,"&");this._divEncode=this._divEncode||(t.document||(t.window?t.window.document:null)).createElement("div"),this._divEncode.innerHTML=i,e=(this._divEncode.textContent||this._divEncode.innerText||"").replace(/;{4}\d;/g,function(t){switch(parseInt(t.substr(4,1))){case 1:return"<";case 2:return">";case 3:return"&amp;"}return t}).replace(/;{4}~;/g,"&"),this._divEncode.innerHTML=""}catch(t){}e=this._createXml(e)}if(e.error)return r?this.obj2str(e):e;if(e.parseError&&0!==e.parseError.errorCode)return r?this.obj2str({error:e.parseError.reason}):{error:e.parseError.reason};var n={},o=function(t,e,r){if("parsererror"===e.nodeName)return void(t.error=e.textContent);var i=e.nodeName.indexOf(":");if(!r&&i>-1?(this.defaultClass!==e.nodeName.substr(0,i)&&(t[this.classProperty]=e.nodeName.substr(0,i)),t[this.tagProperty]=e.nodeName.substr(i+1)):r&&this.defaultClass===e.nodeName||(t[r?this.classProperty:this.tagProperty]=e.nodeName),3===e.nodeType)return void(t.value=e.nodeValue);for(var n=0;n<e.attributes.length;n++){var a=e.attributes[n];"xmlns"!==a.name.substr(0,5)&&(t["class"===a.name?this.cssProperty:a.name]=this._regExps.number.test(a.value)||this._regExps.special.test(a.value)?JSON.parse(a.value):a.value)}!s&&e.childNodes.length&&3===e.firstChild.nodeType&&JUL.trim(e.firstChild.nodeValue)&&(t[this.htmlProperty]=e.firstChild.nodeValue.replace(/[<>&]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;"}return t}));var h=[],l={};for(n=0;n<e.childNodes.length;n++){var c=e.childNodes[n];1===c.nodeType&&(h.indexOf(c.nodeName)>-1?l[c.nodeName]=!0:h.push(c.nodeName))}for(n=0;n<e.childNodes.length;n++)if(c=e.childNodes[n],1===c.nodeType||s&&3===c.nodeType){i=c.nodeName.indexOf(":");var p=!r&&i>-1&&this.defaultClass===c.nodeName.substr(0,i)?c.nodeName.substr(i+1):c.nodeName;if(1===c.nodeType&&!l[c.nodeName]&&[].concat(this.childrenProperty,this.membersProperties||[]).indexOf(p)>-1){var u=[];t[p]=u;for(var f=0;f<c.childNodes.length;f++){var y=c.childNodes[f];(1===y.nodeType||s&&3===y.nodeType)&&(u.push({}),o.call(this,u[u.length-1],y,r))}}else u=t[this.childrenProperty]||[],t[this.childrenProperty]=u,u.push({}),o.call(this,u[u.length-1],c,r)}};return e.documentElement&&(e=e.documentElement),o.call(this,n,e,!this.useTags),r?this.obj2str(n):n},_createElement:null,_domDocument:null,_domParser:null,_includeMerger:null,_instanceProperty:"_instance",_jsonPrefixes:{func:"=func:",regex:"=regex:",newop:"=newop:"},_keepInstance:!1,_newlineString:"\n",_phraseLength:120,_regExps:{variable:/^[a-z$_][\w$]*$/i,number:/^[\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?$/,uint:/^(\d|[1-9]\d+)$/,functionStart:/^function\s*\(/,newStart:/^new\s+[A-Z$_][\w$]*\s*\(/,isoDateStart:/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d/,regexp:/^\/(\s|\S)+\/[gim]{0,3}$/,special:/^(true|false|null)$/,autoUseStrict:/(\{)\r?\n?"use strict";\r?\n?/,keyword:/^(break|case|catch|continue|debugger|default|delete|do|else||finally|for|function|if|in|instanceof|new|return|switch|this|throw|try|typeof|var|void|while|with|class|enum|export|extends|import|super|implements|interface|let|package|private|protected|public|static|yield)$/},_spaceString:" ",_tabString:"\t",_useDoubleQuotes:!1,_usePrefixes:!1,_createXml:function(e){var r=this._domParser||t.DOMParser;if("function"!=typeof r)return this._xmlParser=this._xmlParser||new t.ActiveXObject("Msxml2.DOMDocument.3.0"),this._xmlParser.async=!1,this._xmlParser.loadXML(e),this._xmlParser;this._xmlParser=this._xmlParser||new r;try{return this._xmlParser.parseFromString(e,"application/xml")}catch(t){return{error:t.message}}},_jsonReplacer:function(t,e){switch("string"==typeof e&&JUL.UI._regExps.isoDateStart.test(e)&&(e=new Date(Date.UTC(parseInt(e.substr(0,4)),parseInt(e.substr(5,2))-1,parseInt(e.substr(8,2)),parseInt(e.substr(11,2)),parseInt(e.substr(14,2)),parseInt(e.substr(17,2)),"."===e.substr(19,1)?parseInt(e.substr(20,3)):0))),JUL.typeOf(e)){case"Function":return(this._usePrefixes?this._jsonPrefixes.func+" ":"")+e.toString().replace(JUL.UI._regExps.autoUseStrict,"$1");case"RegExp":return(this._usePrefixes?this._jsonPrefixes.regex+" ":"")+e.toString();case"Date":return(this._usePrefixes?this._jsonPrefixes.newop+" ":"")+"new Date(/*"+e.toUTCString().replace("UTC","GMT")+"*/"+e.getTime()+")";default:return e}},_jsonize:function(t,e){var r=t;if(void 0===e?e="":r=t[e],r&&"object"==typeof r&&"function"==typeof r.toJSON)return this._jsonReplacer(e,r.toJSON());switch(JUL.typeOf(r)){case"Array":for(var s=[],i=0;i<r.length;i++)try{s[i]=this._jsonize(r,i)}catch(t){s[i]=null}return s;case"Object":var n={};for(var o in r)try{r.hasOwnProperty(o)&&(n[o]=this._jsonize(r,o))}catch(t){}return n;default:return this._jsonReplacer(e,r)}}}),JUL.UI.Parser.prototype=JUL.UI}("undefined"!=typeof global?global:window);