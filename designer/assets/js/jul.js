/*
	JUL - The JavaScript UI Language version 1.6.7
	Copyright (c) 2012 - 2019 The Zonebuilder <zone.builder@gmx.com>
	http://sourceforge.net/projects/jul-javascript/
	Licenses: GNU GPLv2 or later; GNU LGPLv3 or later (http://sourceforge.net/p/jul-javascript/wiki/License/)
*/
(function(e){"use strict";e.JUL={},JUL={nsRoot:null,version:"1.6.7",Instance:function(e){if(!(this instanceof JUL.Instance))return new JUL.Instance(e);JUL.apply(this,e||{});var t=this,n=function(){return t},r=function(e,t){if(!(this instanceof r))return new r(e,t);JUL.Ref.call(this,e,t)};r.prototype=new JUL.Ref,r.prototype.constructor=r,r.prototype._getJulInstance=n,this.ref=r,this.ui=new JUL.UI.Parser,this.ui._getJulInstance=n,this.parser=this.ui.Parser},apply:function(e,t,n,r,i){if(!t||typeof t!="object")return e;r&&(r=[].concat(r)),i&&(i=[].concat(i));var s=n?{}:e,o=[].concat(t);for(var u=0;u<o.length;u++){t=o[u];for(var a in t)t.hasOwnProperty(a)&&(!r||r.indexOf(a)<0)&&(!i||i.indexOf(a)>-1)&&(s[a]=t[a])}if(!n)return e;for(a in s)s.hasOwnProperty(a)&&typeof e[a]=="undefined"&&(e[a]=s[a]);return e},get:function(t,n){var r=n||this.nsRoot||e;if(!t)return r;if(typeof t!="string")return t;var i=this._square2dots(t,":::::").split(".");!n&&i.length>1&&("window"===i[0]||"global"===i[0])&&(i.shift(),r=e);var s="";while(i.length){s=i.shift().replace(/:{5}/g,".");if(!s)continue;if(typeof r[s]=="undefined")return r[s];r=r[s]}return r},getInstance:function(e){return e instanceof JUL.Ref||e instanceof JUL.UI.Parser?e._getJulInstance?e._getJulInstance():JUL:e===JUL.UI?JUL:null},makeCaller:function(e,t,n){if(!e||!t&&t!==0)return null;if(typeof t!="function"){t=e[t];if(typeof t!="function")return null}n=(n||!1)&&!0,this._callers=this._callers||[];for(var r=0;r<this._callers.length;r++)if(e===this._callers[r][0]&&t===this._callers[r][1]&&n===this._callers[r][2])return this._callers[r][3];var i=n?function(){return t.apply(e,[].slice.call(arguments).concat([this]))}:function(){return t.apply(e,[].slice.call(arguments))};return this._callers.length>16383&&(this._callers=this._callers.slice(1024,16384)),this._callers.push([e,t,n,i]),i},ns:function(t,n,r){var i=t?this._square2dots(t,":::::").split("."):[],s="",o=/^(\d|[1-9]\d+)$/,u=r||this.nsRoot||e;!r&&i.length>1&&("window"===i[0]||"global"===i[0])&&(i.shift(),u=e);while(i.length){s=i.shift().replace(/:{5}/g,".");if(!s)continue;typeof u[s]=="undefined"&&(u[s]=i.length&&o.test(i[0])?[]:{}),!i.length&&typeof n!="undefined"&&(u[s]=n),u=u[s]}return u},trim:function(e,t,n){typeof e!="string"&&(e=e.toString());if(!e)return e;var r=typeof n=="undefined";if(!r&&n!==!0&&n!==!1||r&&!t&&t!==0)return typeof String.prototype.trim=="function"?e.trim():e.replace(/\s+$/,"").replace(/^\s+/,"");if(!t&&t!==0)return n?e.replace(/^\s+/,""):e.replace(/\s+$/,"");typeof t!="string"&&(t=t.toString());if(r||n===!1){var i=e.length;while(i>=t.length&&e.slice(i-t.length,i)===t)i-=t.length;i<e.length&&(e=e.slice(0,i))}if(e.length<t.length)return e;if(r||n===!0){var s=0;while(s<=e.length-t.length&&e.slice(s,s+t.length)===t)s+=t.length;s&&(e=e.substr(s))}return e},typeOf:function(e){return{}.toString.call(e).match(/\w+/g)[1]},_getAutoInstance:function(e){e=e||null;if(e===this.nsRoot)return this;this._autoInstances=this._autoInstances||[];for(var t=0;t<this._autoInstances.length;t++)if(e===this._autoInstances[t].nsRoot)return this._autoInstances[t].getInstance;var n=new JUL.Instance({nsRoot:e}),r=function(){return n};return this._autoInstances.length>1023&&(this._autoInstances=this._autoInstances.slice(64,1024)),this._autoInstances.push({nsRoot:e,getInstance:r}),r},_square2dots:function(e,t){return e=e.replace(/\\\./g,t||":::::").replace(/\\\[/g,";;;;;1").replace(/\\\]/g,";;;;;2"),e=e.replace(/(\[|\])+/g,".").replace(/\.+/g,"."),e=this.trim(e,".",!1).replace(/;{5}2/g,"]").replace(/;{5}1/g,"["),t?e:e.replace(/:{5}/g,"\\.")}},typeof Array.prototype.indexOf!="function"&&(Array.prototype.indexOf=function(e,t){for(var n=t||0;n<this.length;n++)if(this[n]===e)return n;return-1}),typeof Array.prototype.map!="function"&&(Array.prototype.map=function(e,t){if(typeof e!="function")return null;var n=[];for(var r=0;r<this.length;r++)n.push(t?e.call(t,this[r],r,this):e(this[r],r,this));return n}),JUL.apply(JUL.Instance.prototype,JUL,!1,["Instance","Ref","UI","version","_getAutoInstance"])})(typeof global!="undefined"?global:window),function(){"use strict";var e=JUL;e.ns("JUL.Ref"),e.ns("JUL.Ref",function(e,t){if(!(this instanceof JUL.Ref))return new JUL.Ref(e,t);if(typeof e=="undefined")return;if(typeof t=="undefined"){if(e&&typeof e=="string")e=e.replace(/\\\./g,":::::").split("."),t=e.pop().replace(/:{5}/g,"."),e=JUL.getInstance(this).get(e.join(".").replace(/:{5}/g,"\\.")),typeof e!="undefined"&&(this._ref=e,this._key=t);else if(e instanceof JUL.Ref)JUL.apply(this,e);else if(JUL.typeOf(e)==="Object"&&e.hasOwnProperty("ref")&&e.hasOwnProperty("key")){e.nsRoot&&(this._getJulInstance=JUL._getAutoInstance(e.nsRoot)),this._ref=e.ref,this._key=e.key;for(var n in e)e.hasOwnProperty(n)&&n!=="key"&&n!=="ref"&&n!=="nsRoot"&&(this[n]=e[n])}}else this._ref=e,this._key=t}),e.apply(e.get("JUL.Ref").prototype,{del:function(){return delete this._ref[this._key],this},key:function(e){return typeof e!="undefined"?(this._key=e,this):this._key},ref:function(e,t){if(typeof e=="undefined")return this._ref;if(e===!0)return this._key;if(typeof t!="undefined")this._key=t;else if(e&&typeof e=="string")return e=e.replace(/\\\./g,":::::").split("."),t=e.pop().replace(/:{5}/g,"."),e=JUL.getInstance(this).get(e.join(".").replace(/:{5}/g,"\\.")),typeof e!="undefined"&&(this._ref=e,this._key=t),this;return e!==!1&&(this._ref=e),this},val:function(e){return typeof e!="undefined"?(this._ref[this._key]=e,this):this._ref[this._key]}})}(),function(e){"use strict";var t=JUL;t.ns("JUL.UI"),t.apply(t.get("JUL.UI"),{bindingProperty:"cid",booleanAttrs:!1,childrenProperty:"children",classProperty:"xclass",cssProperty:"css",customFactory:null,defaultClass:"Object",htmlProperty:"html",idProperty:"id",includeProperty:"include",instantiateProperty:"instantiate",membersMappings:{},membersProperties:[],parentProperty:"parent",parserProperty:"parserConfig",referencePrefix:"=ref:",tagProperty:"tag",textProperty:"text",topDown:!1,useTags:!1,xmlNS:{aml:"http://www.amplesdk.com/ns/aml",aui:"http://www.amplesdk.com/ns/aui",chart:"http://www.amplesdk.com/ns/chart",html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",xform:"http://www.w3.org/2002/xforms",xul:"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"},Parser:function(e){if(!(this instanceof JUL.UI.Parser&&!this.hasOwnProperty("Parser")))return this&&typeof this.Parser=="function"&&this.Parser.prototype instanceof JUL.UI.Parser?new this.Parser(e):this&&this.ui&&this.ui instanceof JUL.UI.Parser?new this.ui.Parser(e):new JUL.UI.Parser(e);e=e||{},e.nsRoot&&(this._getJulInstance=JUL._getAutoInstance(e.nsRoot)),JUL.apply(this,e,!1,"nsRoot"),this.Parser=function(e){var t=JUL.UI.Parser.call(this,e);if(typeof t=="object")return t},this.Parser.prototype=this},compact:function(e,t,n){if(!e||typeof e!="object")return e;if(JUL.typeOf(e)==="Array"){var r=[];for(var i=0;i<e.length;i++)r.push(this.compact(e[i],t,n));return r}e=this.include(e);if(JUL.typeOf(e[this.childrenProperty])!=="Array")return e;var s=[],o={};for(var u=0;u<e[this.childrenProperty].length;u++){var a=e[this.childrenProperty][u],f=a[this.classProperty]||this.defaultClass,l=this.useTags?f+":"+a[this.tagProperty]:f;s.indexOf(l)<0?s.push(l):o[l]=!0}var c={};for(var h in e)e.hasOwnProperty(h)&&h!==this.childrenProperty&&(c[h]=e[h]);var p={};typeof n=="undefined"&&(n=(this.membersProperties||[]).length);for(u=0;u<e[this.childrenProperty].length;u++){a=e[this.childrenProperty][u],f=a[this.classProperty]||this.defaultClass,l=this.useTags?f+":"+a[this.tagProperty]:f;var d=this.useTags&&f===this.defaultClass?a[this.tagProperty]:l,v=typeof a[this.childrenProperty]=="object"&&a[this.childrenProperty].length,m=(this.membersProperties||[]).indexOf(d);if(v&&(m<0||m>=n))if(t){for(h in a)if(a.hasOwnProperty(h)&&h!==this.classProperty&&h!==this.childrenProperty&&(!this.useTags||h!==this.tagProperty)){v=!1;break}}else v=!1;v&&!o[l]?p[d]=a[this.childrenProperty]:(p[this.childrenProperty]=p[this.childrenProperty]||[],p[this.childrenProperty].push(a))}for(h in p)if(p.hasOwnProperty(h)){c[h]=p[h],h!==this.childrenProperty&&(this.membersProperties||[]).indexOf(h)<0&&(this.membersProperties=this.membersProperties||[],this.membersProperties.push(h));for(u=0;u<p[h].length;u++)p[h][u]=this.compact(p[h][u],t,n)}return c},create:function(e,t,n,r){var i=JUL.typeOf(e);if(["Array","Object"].indexOf(i)<0)return null;["Array","Object"].indexOf(JUL.typeOf(t))<0&&(t=null);if(t){var s=[].concat(t);t={};for(var o=0;o<s.length;o++){var u=s[o];if(u[this.includeProperty]){t[this.includeProperty]||(t[this.includeProperty]=[]);var a=[].concat(u[this.includeProperty]);for(var f=0;f<a.length;f++)t[this.includeProperty].indexOf(a[f])<0&&t[this.includeProperty].push(a[f])}JUL.apply(t,u,!1,this.includeProperty)}t[this.includeProperty]&&(t=this.include(t))}if(i==="Array")return e.map(function(e){return this.create(e,t,n)},this);var l=JUL.getInstance(this),c={root:e},h={root:n},p=[new JUL.Ref({ref:c,key:"root",parent:n?new JUL.Ref(h,"root"):null})],d=p;while(p.length){var v=[];for(var m=0;m<p.length;m++){var g=p[m];g.config=g.val(),i=JUL.typeOf(g.config);if(i!=="Object"&&(!r||i!=="Array"))continue;if(i==="Array"){var y=[].concat(g.config);for(var b=0;b<y.length;b++)["Array","Object"].indexOf(JUL.typeOf(y[b]))>-1&&v.push(new JUL.Ref(y,b));g.val(y),g.sparse=!0,delete g.config;continue}if(g.config[this.parserProperty])continue;var w=!r||g.config[this.classProperty]||this.useTags&&g.config[this.tagProperty];delete g.config[this._instanceProperty];var E=w?this.include(g.config):JUL.apply({},g.config);if(w){if(E[this.bindingProperty]){if(t){var S=[].concat(E[this.bindingProperty]);for(var x=0;x<S.length;x++)t[S[x]]&&JUL.apply(E,t[S[x]])}delete E[this.bindingProperty]}E[this.idProperty]&&t&&t[E[this.idProperty]]&&JUL.apply(E,t[E[this.idProperty]])}g.val(E),g.sparse=!w;var T=w?this.getMembers(E):[];w&&delete E[this.instantiateProperty];for(var N in E){if(E.hasOwnProperty(N)){var C=w&&T.indexOf(N)>-1;i=JUL.typeOf(E[N]);if(["Array","Object"].indexOf(i)>-1&&(C||r)){var k=[].concat(E[N]);if(i==="Array"||C&&this.topDown)for(var L=0;L<k.length;L++)["Array","Object"].indexOf(JUL.typeOf(k[L]))>-1&&v.push(new JUL.Ref({ref:k,key:L,parent:g}));else v.push(new JUL.Ref({ref:E,key:N,parent:g}));C&&this.topDown?delete E[N]:i==="Array"&&(E[N]=k)}}if(i==="String"&&this.referencePrefix&&!C&&N!==this.idProperty){var A=E[N].substr(0,this.referencePrefix.length+1);A==="\\"+this.referencePrefix?E[N]=E[N].substr(1):A.substr(0,this.referencePrefix.length)===this.referencePrefix&&JUL.trim(E[N].substr(this.referencePrefix.length))&&(E[N]=l.get(JUL.trim(E[N].substr(this.referencePrefix.length))))}}}d=this.topDown?d.concat(v):v.concat(d),p=v}for(m=0;m<d.length;m++){g=d[m];if(!g.val())continue;if(g.val()[this.parserProperty]){var O=JUL.apply({},g.val()),M=new this.Parser(O[this.parserProperty]);delete O[this.parserProperty],g.val(M.create(O,t,this.topDown&&g.parent?g.parent.val():null));continue}g.sparse||(this.topDown&&(g.val()[this.parentProperty]=g.parent?g.parent.val():null),g.val(this.createComponent(g.val()))),this._keepInstance&&g.config&&(g.config[this._instanceProperty]=g.val())}return c.root},createComponent:function(e){e[this.classProperty]||(e[this.classProperty]=this.defaultClass);var t="";e[this.idProperty]&&(t=e[this.idProperty].replace(/\\\./g,":::::"),e[this.idProperty]=e[this.idProperty].replace(/\\\./g,"--").replace(/\./g,"-"),["window.","global."].indexOf(t.substr(0,7))>-1&&(e[this.idProperty]=e[this.idProperty].substr(7)),t.substr(0,1)==="."&&(e[this.idProperty]=e[this.idProperty].substr(1)));var n=JUL.getInstance(this),r=e[this.classProperty];this.customFactory||delete e[this.classProperty];var i=this.customFactory?n.get(this.customFactory).call(this,e):this.factory(r,e);return t.indexOf(".")>-1?n.ns(t.replace(/:{5}/g,"\\.").replace(/-/g,"_"),i):i},createDom:function(t,n){if(!t)return null;var r=JUL.getInstance(this),i=this.useTags?-1:t[this.classProperty].indexOf(":"),s=i>-1?t[this.classProperty].substr(0,i):this.useTags?t[this.classProperty]:"html",o=this._domDocument?r.get(this._domDocument):e.document||(e.window?e.window.document:null),u=typeof e.ample=="object";u&&(o=e.ample);if((this.useTags?t[this.tagProperty]:t[this.classProperty].substr(i+1))==="#text")return n?n.nodeValue=t.value:n=o.createTextNode(t.value),n;n=n||(s==="html"||typeof o.createElementNS!="function"&&this.xmlNS[s]?o.createElement.apply(o,[i>-1?t[this.classProperty].substr(i+1):this.useTags?t[this.tagProperty]:t[this.classProperty]].concat(t.is||[])):o.createElementNS.apply(o,[this.xmlNS[s]||null,i>-1?t[this.classProperty]:s+":"+(this.useTags?t[this.tagProperty]:t[this.classProperty])].concat(t.is||[])));if(!n)return null;if(t.listeners&&typeof t.listeners=="object"){var a=t.listeners,f=a.scope?r.get(a.scope):null;for(var l in a)if(a.hasOwnProperty(l)&&l!=="scope"){var c=[].concat(a[l]);for(var h=0;h<c.length;h++){var p=r.get(c[h]);if(p){var d={fn:p,scope:f,useCapture:!1};typeof p=="object"&&(JUL.apply(d,p),p.scope&&(d.scope=r.get(p.scope))),u||n.addEventListener?n.addEventListener(l,d.scope?r.makeCaller(d.scope,d.fn,!0):d.fn,d.useCapture):n.attachEvent("on"+l,r.makeCaller(d.scope||n,d.fn,!0))}}}}var v=this.getMembers(t);for(l in t)if(t.hasOwnProperty(l)&&v.indexOf(l)<0&&["listeners",this.cssProperty,"style",this.textProperty,this.htmlProperty,this.tagProperty,this.classProperty,this.parentProperty].indexOf(l)<0){i=l.indexOf(":");var m=["Array","Date","Function","Object","Null","RegExp"].indexOf(JUL.typeOf(t[l]))>-1?this.obj2str(t[l]):t[l];if(this.booleanAttrs&&typeof t[l]=="boolean"){if(!t[l])continue;m=""}i>-1&&typeof n.setAttributeNS=="function"&&this.xmlNS[l.substr(0,i)]?n.setAttributeNS(this.xmlNS[l.substr(0,i)]||null,l,m):n.setAttribute(l,m)}t[this.cssProperty]&&n.setAttribute("class",t[this.cssProperty]),t.style&&(u?n.setAttribute("style",t.style):n.style.cssText=n.style.cssText+";"+t.style),t[this.textProperty]&&(u?e.ample.query(n).text(t[this.textProperty]):n["textContent"in n?"textContent":"innerText"]=t[this.textProperty]),t[this.htmlProperty]&&(u?e.ample.query(n).html(t[this.htmlProperty].substr(0,1)==="<"&&t[this.htmlProperty].substr(-1)===">"?t[this.htmlProperty]:"<span>"+t[this.htmlProperty]+"</span>"):n.innerHTML=t[this.htmlProperty].replace(this._regExps.xss,""));for(l in t)if(t.hasOwnProperty(l)&&t[l]&&typeof t[l]=="object"&&v.indexOf(l)>-1){var g=[].concat(t[l]),y=n;l!==this.childrenProperty&&(i=l.indexOf(":"),s=i>-1?l.substr(0,i):this.useTags?this.defaultClass:"html",y=s==="html"||typeof o.createElementNS!="function"?o.createElement.apply(o,[i>-1?l.substr(i+1):l].concat(t.is||[])):o.createElementNS.apply(o,[this.xmlNS[s]||null,i>-1?l:s+":"+l].concat(t.is||[])));for(var b=0;b<g.length;b++)y.appendChild(g[b]);l!==this.childrenProperty&&n.appendChild(y)}return this.topDown&&t[this.parentProperty]&&typeof t[this.parentProperty]=="object"&&t[this.parentProperty].appendChild(n),n},createVDom:function(t){if(!t)return null;var n=JUL.getInstance(this),r=this._createElement?n.get(this._createElement):null,i=typeof r=="function",s=this._domDocument?n.get(this._domDocument):null;r=r||(s?s.createElement:null);if(!r)return null;t=JUL.apply({},t);var o=this.useTags?t[this.tagProperty]:t[this.classProperty];if(typeof o=="string"){if(o.split(":").pop()==="#text")return t.value;this.useTags&&t[this.classProperty]!==this.defaultClass&&(o=t[this.classProperty]+":"+o)}delete t[this.classProperty],delete t[this.tagProperty];var u=[];t[this.textProperty]&&u.push(t[this.textProperty]),delete t[this.textProperty];if(t[this.htmlProperty]){if(typeof t[this.htmlProperty]=="string")try{this._createDiv=this._createDiv||(e.document||(e.window?e.window.document:null)).createElement("div"),this._createDiv.innerHTML=t[this.htmlProperty].replace(this._regExps.xss,""),t[this.htmlProperty]=this.html2jul(this._createDiv,!1,!0)[this.childrenProperty]||[],this._createDiv.innerHTML=""}catch(a){u=[t[this.htmlProperty]]}typeof t[this.htmlProperty]=="object"&&(u=[].concat(this.create(t[this.htmlProperty])))}delete t[this.htmlProperty],t[this.cssProperty]&&(typeof t[this.cssProperty]=="string"?t.className=t[this.cssProperty]:t["class"]=t[this.cssProperty]),delete t[this.cssProperty];var f=JUL.typeOf(t[this.childrenProperty])==="Object";u=u.concat(t[this.childrenProperty]||[]),delete t[this.childrenProperty];for(var l in t)t.hasOwnProperty(l)&&typeof t[l]=="string"&&t[l].substr(0,2)==="{<"&&t[l].substr(-2)===">}"&&(t[l]=this.xml2jul("<div>"+t[l].slice(1,-1)+"<"+"/div>",!1,!0)[this.childrenProperty],t[l].length<2&&(t[l]=t[l][0]),t[l]=this.create(t[l]));return u.length?u.length<2&&(f||typeof u[0]=="string")&&(u=u[0]):u=null,i?r(o,t,u):r.call(s,o,t,u)},expand:function(e){if(!e||typeof e!="object")return e;if(JUL.typeOf(e)==="Array")return e.map(this.expand,this);e=this.include(e);var t=[],n=this.getMembers(e);delete e[this.instantiateProperty];for(var r in e)if(e.hasOwnProperty(r)&&e[r]&&typeof e[r]=="object"&&n.indexOf(r)>-1)if(r===this.childrenProperty)t=t.concat(e[r]);else{var i={};!this.useTags&&r!==this.defaultClass&&(i[this.classProperty]=r);if(this.useTags){var s=r.indexOf(":");s>-1&&r.substr(0,s)!==this.defaultClass&&(i[this.classProperty]=r.substr(0,s)),i[this.tagProperty]=s>-1?r.substr(s+1):r}i[this.childrenProperty]=[].concat(e[r]),delete e[r],t.push(i)}if(t.length){e[this.childrenProperty]=t;for(var o=0;o<t.length;o++)t[o]=this.expand(t[o])}return e},factory:function(e,t){var n=JUL.getInstance(this).get(e);return typeof n!="function"?null:t?new n(t):new n},getMembers:function(e){var t=[].concat(this.childrenProperty,this.membersProperties||[]);if(!e)return t;var n=[];(!this.useTags||e[this.classProperty]&&e[this.classProperty]!==this.defaultClass)&&n.push(e[this.classProperty]||this.defaultClass),this.useTags&&n.push(e[this.tagProperty]);var r=this.membersMappings||{};return t.concat(r[n.join(":")]||[],e[this.instantiateProperty]||[])},html2jul:function(t,n,r){this._divEncode=this._divEncode||(e.document||(e.window?e.window.document:null)).createElement("div"),typeof t!="object"&&(t=JUL.trim(t),this._divEncode.innerHTML=t.replace(this._regExps.xss,""),t=[].slice.call(this._divEncode.childNodes||[])),t=[].concat(t);var i=[];for(var s=0;s<t.length;s++)(t[s].nodeType===1||r&&t[s].nodeType===3)&&i.push(this.xml2jul(t[s],!1,r,!0));return this._divEncode.innerHTML="",i.length?(i.length<2&&(i=i[0]),n?this.obj2str(i):i):this.xml2jul(null,n)},include:function(e,t){var n={};if(!e[this.includeProperty])return JUL.apply(n,e);var r=t&&typeof t=="function";!r&&this._includeMerger&&(t=this._includeMerger,r=typeof t=="function");var i=JUL.getInstance(this),s=[].concat(e[this.includeProperty]);for(var o=0;o<s.length;o++){var u=i.get(s[o]);u&&(r?t.call(this,n,this.include(u,t)):JUL.apply(n,this.include(u)))}var a=n[this.bindingProperty]?[].concat(n[this.bindingProperty]):[];return e[this.bindingProperty]&&a.indexOf(e[this.bindingProperty])<0&&a.push(e[this.bindingProperty]),r?t.call(this,n,e):JUL.apply(n,e),a.length&&(n[this.bindingProperty]=a),delete n[this.includeProperty],n},obj2str:function(e,t,n){if(typeof this._useJsonize=="undefined"){var r=function(){};this._useJsonize=JSON.stringify({o:r},JUL.makeCaller(JUL.UI,"_jsonReplacer")).indexOf("function")<0}var i=this._useJsonize?JSON.stringify(this._jsonize(e)):JSON.stringify(e,JUL.getInstance(this).makeCaller(this,"_jsonReplacer"));if(!i)return"";var s="#",o="",u="",a="",f="",l=!1,c=[],h=[],p=0,d=0,v=0;for(var m=0;m<i.length;m++){o=i.substr(m,1),o==='"'&&s!=="\\"&&(l=!l,l&&(p=m));if(l){t&&(a+=o),s=o;continue}!t&&"{[,]}".indexOf(o)>-1&&"]}".indexOf(s)<0&&(a+=n?n.call(e,f,h.map(function(e){return e.toString().replace(/\./g,"\\.")}).join("."),u):f,f="");if(o==='"'&&!t){var g=JSON.parse(i.substr(p,m-p+1));if(i.substr(m+1,1)===":")n&&(h[h.length-1]=g),f+=!this._regExps.keyword.test(g)&&(this._regExps.variable.test(g)||this._regExps.uint.test(g))?g:this._useDoubleQuotes?i.substr(p,m-p+1):"'"+i.substr(p+1,m-p-1).replace(/\\"/g,'"').replace(/'/g,"\\'")+"'";else{var y=!1;this._usePrefixes&&(g.substr(0,this._jsonPrefixes.func.length)===this._jsonPrefixes.func&&JUL.trim(g.substr(this._jsonPrefixes.func.length))?(y=!0,g=g.substr(this._jsonPrefixes.func.length).replace(/^\s+/,"")):g.substr(0,this._jsonPrefixes.newop.length)===this._jsonPrefixes.newop&&JUL.trim(g.substr(this._jsonPrefixes.newop.length))&&(y=!0,g=g.substr(this._jsonPrefixes.newop.length).replace(/^\s+/,"")));if(y||!this._usePrefixes&&(this._regExps.functionStart.test(g)||this._regExps.newStart.test(g))){var b=g.match(/\n(\s|\t)+\}$/);b&&(b=b[0].substr(0,b[0].length-1),g=g.replace(new RegExp(b,"g"),"\n")),g=g.replace(/\t/g,this._tabString).replace(/\n\r?/g,this._newlineString+u),f+=g,s="~";continue}y=!1,this._usePrefixes&&g.substr(0,this._jsonPrefixes.regex.length)===this._jsonPrefixes.regex&&JUL.trim(g.substr(this._jsonPrefixes.regex.length))&&(y=!0,g=g.substr(this._jsonPrefixes.regex.length).replace(/^\s+/,""));if(this._usePrefixes)for(var w in this._jsonPrefixes)this._jsonPrefixes.hasOwnProperty(w)&&g.substr(0,this._jsonPrefixes[w].length+1)==="\\"+this._jsonPrefixes[w]&&(g=g.substr(1));this.referencePrefix&&g.substr(0,this.referencePrefix.length)===this.referencePrefix&&JUL.trim(g.substr(this.referencePrefix.length))&&(y=!0,g=g.substr(this.referencePrefix.length).replace(/^\s+/,"")),this.referencePrefix&&g.substr(0,this.referencePrefix.length+1)==="\\"+this.referencePrefix&&(g=g.substr(1)),f+=y||!this._usePrefixes&&this._regExps.regexp.test(g)?g:this._useDoubleQuotes?i.substr(p,m-p+1):"'"+i.substr(p+1,m-p-1).replace(/\\"/g,'"').replace(/'/g,"\\'")+"'"}}else o==="{"||o==="["?(!t&&n&&h.push(o==="["?0:""),c.push(o),c.length===1&&i.substr(m+1,1)!=="}"&&i.substr(m+1,1)!=="]"||o==="{"&&s===":"&&i.substr(m+1,1)!=="}"||o==="["&&(i.substr(m+1,1)==="{"||i.substr(m+1,1)==="[")?(u+=this._tabString,a=a+o+this._newlineString+u,d=a.length):a+=o):o===","?(this._phraseLength&&v&&a.length>d+this._phraseLength&&(a=a.slice(0,v)+this._newlineString+u+a.substr(v),d=v+this._newlineString.length+u.length),v=a.length+1,!t&&n&&c.length&&c[c.length-1]==="["&&h[h.length-1]++,c.length===1||s==="~"||(s==="}"||s==="]")&&i.substr(m-2,1)!=="{"&&i.substr(m-2,1)!=="["?(a=a+o+this._newlineString+u,d=a.length,v=0):t?a+=o:a=a+o+this._spaceString):o==="}"||o==="]"?(this._phraseLength&&v&&a.length>d+this._phraseLength&&(a=a.slice(0,v)+this._newlineString+u+a.substr(v),d=v+this._newlineString.length+u.length),v=0,!t&&n&&h.pop(),c.pop(),!c.length&&s!=="{"&&s!=="["||o==="}"&&c.length&&c[c.length-1]==="{"&&s!=="{"||o==="]"&&(s==="}"||s==="]")?(u=u.substr(this._tabString.length),a=a+this._newlineString+u+o,d=a.length-1):a+=o):t?a+=o:f+=o===":"?o+this._spaceString:o;s=o}return!t&&f&&(a+=n?n.call(e,f,"",u):f),a},xml2jul:function(t,n,r,i){if(typeof t!="object"){try{var s=t.replace(/&(lt|gt|amp);/g,";;;;~;$1;").replace(/&(#?\w+;)/g,";;;;0;$1").replace(/[<>&]/g,function(e){switch(e){case"<":return";;;;1;";case">":return";;;;2;";case"&":return";;;;3;"}return e}).replace(/;{4}0;/g,"&");this._divEncode=this._divEncode||(e.document||(e.window?e.window.document:null)).createElement("div"),this._divEncode.innerHTML=s.replace(this._regExps.xss,""),t=(this._divEncode.textContent||this._divEncode.innerText||"").replace(/;{4}\d;/g,function(e){switch(parseInt(e.substr(4,1))){case 1:return"<";case 2:return">";case 3:return"&amp;"}return e}).replace(/;{4}~;/g,"&"),this._divEncode.innerHTML=""}catch(o){}t=this._createXml(t)}if(t.error)return n?this.obj2str(t):t;if(t.parseError&&t.parseError.errorCode!==0)return n?this.obj2str({error:t.parseError.reason}):{error:t.parseError.reason};var u={},a=function(e){return i?e.toLowerCase():e},f=function(e,t,n){if(!t)return;if(t.nodeName==="parsererror"){e.error=t.textContent;return}var i=t.nodeName.indexOf(":");if(!n&&i>-1)this.defaultClass!==a(t.nodeName).substr(0,i)&&(e[this.classProperty]=a(t.nodeName).substr(0,i)),e[this.tagProperty]=a(t.nodeName).substr(i+1);else if(!n||this.defaultClass!==a(t.nodeName))e[n?this.classProperty:this.tagProperty]=a(t.nodeName);if(t.nodeType===3){e.value=t.nodeValue;return}for(var s=0;s<t.attributes.length;s++){var o=t.attributes[s];o.name.substr(0,5)!=="xmlns"&&(e[o.name==="class"?this.cssProperty:o.name]=this._regExps.number.test(o.value)||this._regExps.special.test(o.value)?JSON.parse(o.value):o.value)}!r&&t.childNodes.length&&t.firstChild.nodeType===3&&JUL.trim(t.firstChild.nodeValue)&&(e[this.htmlProperty]=t.firstChild.nodeValue.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;"}return e}));var u=[],l={};for(s=0;s<t.childNodes.length;s++){var c=t.childNodes[s];c.nodeType===1&&(u.indexOf(c.nodeName)>-1?l[c.nodeName]=!0:u.push(c.nodeName))}for(s=0;s<t.childNodes.length;s++){c=t.childNodes[s];if(c.nodeType===1||r&&c.nodeType===3){i=c.nodeName.indexOf(":");var h=!n&&i>-1&&this.defaultClass===a(c.nodeName).substr(0,i)?a(c.nodeName).substr(i+1):a(c.nodeName);if(c.nodeType===1&&!l[c.nodeName]&&[].concat(this.childrenProperty,this.membersProperties||[]).indexOf(h)>-1){var p=[];e[h]=p;for(var d=0;d<c.childNodes.length;d++){var v=c.childNodes[d];if(v.nodeType===1||r&&v.nodeType===3)p.push({}),f.call(this,p[p.length-1],v,n)}}else p=e[this.childrenProperty]||[],e[this.childrenProperty]=p,p.push({}),f.call(this,p[p.length-1],c,n)}}};return t.documentElement&&(t=t.documentElement),f.call(this,u,t,!this.useTags),n?this.obj2str(u):u},_createElement:null,_domDocument:null,_domParser:null,_includeMerger:null,_instanceProperty:"_instance",_jsonPrefixes:{func:"=func:",regex:"=regex:",newop:"=newop:"},_keepInstance:!1,_newlineString:"\n",_phraseLength:120,_regExps:{variable:/^[a-z$_][\w$]*$/i,number:/^[\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?$/,uint:/^(\d|[1-9]\d+)$/,functionStart:/^function\s*\(/,newStart:/^new\s+[A-Z$_][\w$]*\s*\(/,isoDateStart:/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d/,regexp:/^\/(\s|\S)+\/[gim]{0,3}$/,special:/^(true|false|null)$/,autoUseStrict:/(\{)\r?\n?"use strict";\r?\n?/,xss:/<script(\s|\S)+?\/script\s*>/g,keyword:/^(break|case|catch|continue|debugger|default|delete|do|else||finally|for|function|if|in|instanceof|new|return|switch|this|throw|try|typeof|var|void|while|with|class|enum|export|extends|import|super|implements|interface|let|package|private|protected|public|static|yield)$/},_spaceString:" ",_tabString:"	",_useDoubleQuotes:!1,_usePrefixes:!1,_createXml:function(t){var n=this._domParser||e.DOMParser;if(typeof n!="function")return this._xmlParser=this._xmlParser||new e.ActiveXObject("Msxml2.DOMDocument.3.0"),this._xmlParser.async=!1,this._xmlParser.loadXML(t),this._xmlParser;this._xmlParser=this._xmlParser||new n;try{return this._xmlParser.parseFromString(t,"application/xml")}catch(r){return{error:r.message}}},_jsonReplacer:function(e,t){typeof t=="string"&&JUL.UI._regExps.isoDateStart.test(t)&&(t=new Date(Date.UTC(parseInt(t.substr(0,4)),parseInt(t.substr(5,2))-1,parseInt(t.substr(8,2)),parseInt(t.substr(11,2)),parseInt(t.substr(14,2)),parseInt(t.substr(17,2)),t.substr(19,1)==="."?parseInt(t.substr(20,3)):0)));switch(JUL.typeOf(t)){case"Function":return(this._usePrefixes?this._jsonPrefixes.func+" ":"")+t.toString().replace(JUL.UI._regExps.autoUseStrict,"$1");case"RegExp":return(this._usePrefixes?this._jsonPrefixes.regex+" ":"")+t.toString();case"Date":return(this._usePrefixes?this._jsonPrefixes.newop+" ":"")+"new Date(/*"+t.toUTCString().replace("UTC","GMT")+"*/"+t.getTime()+")";default:return t}},_jsonize:function(e,t){var n=e;typeof t=="undefined"?t="":n=e[t];if(n&&typeof n=="object"&&typeof n.toJSON=="function")return this._jsonReplacer(t,n.toJSON());switch(JUL.typeOf(n)){case"Array":var r=[];for(var i=0;i<n.length;i++)try{r[i]=this._jsonize(n,i)}catch(s){r[i]=null}return r;case"Object":var o={};for(var u in n)try{n.hasOwnProperty(u)&&(o[u]=this._jsonize(n,u))}catch(a){}return o;default:return this._jsonReplacer(t,n)}}}),JUL.UI.Parser.prototype=JUL.UI}(typeof global!="undefined"?global:window);
