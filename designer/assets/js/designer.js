/*
	JUL Designer version 2.6.1 demo
	Copyright (c) 2014 - 2019 The Zonebuilder <zone.builder@gmx.com>
	http://sourceforge.net/projects/jul-designer/
	Licenses: GNU GPLv2 or later; GNU LGPLv3 or later (http://sourceforge.net/p/jul-designer/wiki/License/)
*/
(function(){"use strict";JUL.ns("JUL.Designer"),JUL.Designer.browseUi={"tag":"dialog","id":"dialog-browse","title":"Open","hidden":!0,"width":840,"height":420,"children":[{"tag":"listbox","id":"listbox-browse","seltype":"single","flex":1,"children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Namespace","width":410},{"tag":"listheader","label":"Title","width":510}]},{"tag":"listbody"}],"listeners":{"dblclick":function(e){if(e.target.nodeName!=="xul:listcell")return;var t=JUL.Designer.getWhere(e.target.parentNode);switch(JUL.Designer.state.browseType){case"app":JUL.Designer.app.open(t);break;case"project":JUL.Designer.designer.open(t);break;case"framework":JUL.Designer.framework.open(t)}}}}],"listeners":{"dialogaccept":function(){var e=ample.getElementById("listbox-browse").selectedItems;if(!e.length)return window.alert("Please select an item"),!1;var t=JUL.Designer.getWhere(e.item(e.length-1));switch(JUL.Designer.state.browseType){case"app":JUL.Designer.app.open(t);break;case"project":JUL.Designer.designer.open(t);break;case"framework":JUL.Designer.framework.open(t)}return!1}}},JUL.Designer.codeUi={"tag":"dialog","id":"dialog-code","title":"Code","hidden":!0,"width":960,"height":420,"children":[{"tag":"textbox","id":"textbox-code","width":"100%","css":"code","multiline":!0,"flex":1,"listeners":{"keydown":"JUL.Designer.filterTab"}}],"listeners":{"dialogaccept":function(){return JUL.Designer.saveCode(),!1},"dialogcancel":function(){return JUL.Designer.cancelCode(),!1}}},JUL.Designer.commentUi={"tag":"dialog","id":"dialog-comment","title":"Comment","hidden":!0,"width":860,"height":160,"children":[{"tag":"textbox","css":"desc","id":"textbox-comment","width":"100%","multiline":!0,"flex":1,"listeners":{"keydown":"JUL.Designer.filterTab"}}],"listeners":{"dialogaccept":function(){return JUL.Designer.saveComment(),!1},"dialogcancel":function(){return JUL.Designer.cancelComment(),!1}}},JUL.Designer.jsUi={"tag":"dialog","id":"dialog-js","title":"JavaScript","hidden":!0,"width":960,"height":420,"buttons":"accept","children":[{"tag":"textbox","id":"textbox-js","readonly":!0,"width":"100%","css":"code","multiline":!0,"flex":1}]},JUL.Designer.xmlUi={"tag":"dialog","id":"dialog-xml","title":"XML layout","hidden":!0,"width":960,"height":420,"buttons":"accept","children":[{"tag":"hbox","children":[{"tag":"spacer","width":5},{"tag":"vbox","width":"100%","children":[{"tag":"hbox","children":[{"tag":"label","control":"textbox-xml-css","value":"CSS class property"},{"tag":"spacer","width":5},{"tag":"textbox","id":"textbox-xml-css","style":"width:50px"},{"tag":"spacer","width":10},{"tag":"label","control":"textbox-xml-html","value":"Inner HTML property"},{"tag":"spacer","width":5},{"tag":"textbox","id":"textbox-xml-html","style":"width:50px"},{"tag":"spacer","width":10},{"tag":"label","control":"textbox-xml-wrapper","value":"multiple roots wrapper"},{"tag":"spacer","width":5},{"tag":"textbox","id":"textbox-xml-wrapper","style":"width:80px"}]},{"tag":"checkbox","id":"checkbox-xml-merge-logic","label":"Merge logic into layout"},{"tag":"hbox","children":[{"tag":"checkbox","id":"checkbox-xml-export-listeners","label":"Export listeners as attributes"},{"tag":"spacer","width":5},{"tag":"checkbox","id":"checkbox-xml-strip-function","label":"and make functions inline; attribute prefix"},{"tag":"spacer","width":5},{"tag":"textbox","id":"textbox-xml-listener-prefix","style":"width:50px"}]},{"tag":"checkbox","id":"checkbox-xml-expand-members","label":"Expand all 'members' properties"}]},{"tag":"hbox","height":80,"width":140,"align":"stretch","pack":"stretch","children":[{"tag":"button","id":"button-xml-refresh","flex":1,"label":"Refresh","tooltiptext":"Re-compute the XML","listeners":{"command":function(){JUL.Designer.designer.refreshXml()}}}]}]},{"tag":"textbox","id":"textbox-xml","readonly":!0,"width":"100%","css":"code","multiline":!0,"flex":1}]},JUL.Designer.clipboardUi={"tag":"dialog","id":"dialog-clipboard","title":"Clipboard","hidden":!0,"width":960,"height":460,"children":[{"tag":"textbox","id":"textbox-clipboard-components","readonly":!0,"width":"100%","css":"code","multiline":!0,"flex":1},{"tag":"hbox","children":[{"tag":"checkbox","id":"checkbox-paste-range","label":"for the next paste, use only the component indexes "},{"tag":"textbox","id":"textbox-range-start","type":"number","disabled":!0,"min":-1,"style":"width:50px"},{"tag":"label","value":" to "},{"tag":"textbox","id":"textbox-range-end","type":"number","disabled":!0,"min":-1,"style":"width:50px"}]},{"tag":"hbox","children":[{"tag":"checkbox","id":"checkbox-map-class","label":"for the next paste, change components class(es) "},{"tag":"textbox","id":"textbox-map-class-from","disabled":!0,"style":"width:200px","tooltiptext":"comma separated list of class names"},{"tag":"label","value":" to "},{"tag":"textbox","id":"textbox-map-class-to","disabled":!0,"style":"width:200px","tooltiptext":"comma separated list of class names"}]},{"tag":"textbox","id":"textbox-clipboard-members","readonly":!0,"width":"100%","css":"code","multiline":!0,"flex":1},{"tag":"hbox","children":[{"tag":"checkbox","id":"checkbox-paste-filter","label":"for the next paste, use only the specified members "},{"tag":"textbox","id":"textbox-filter-members","disabled":!0,"style":"width:450px"}]},{"tag":"description","id":"description-exclude-paste","style":"text-indent:17px;font-size:small;font-style:italic","value":"* special members won't be pasted over"}]},JUL.Designer.clipboardLogic={"checkbox-map-class":{"listeners":{"change":function(){var e=this.getAttribute("checked")==="true",t=JUL.Designer.designer.currentParser,n=JUL.Designer.designer.state.clipboard,r=t&&n.contentNodes?n.contentNodes[0].ui[t.classProperty]||t.defaultClass:"";ample.getElementById("textbox-map-class-from").setAttribute("disabled",!e),ample.getElementById("textbox-map-class-to").setAttribute("disabled",!e),ample.getElementById("textbox-map-class-from").setAttribute("value",e?r:""),ample.getElementById("textbox-map-class-to").setAttribute("value",e?t?t.defaultClass:"":"")}}},"checkbox-paste-filter":{"listeners":{"change":function(){var e=this.getAttribute("checked")==="true";ample.getElementById("textbox-filter-members").setAttribute("disabled",!e),e?(ample.getElementById("textbox-filter-members").focus(),ample.getElementById("textbox-filter-members").blur()):ample.getElementById("textbox-filter-members").setAttribute("value","")}}},"checkbox-paste-range":{"listeners":{"change":function(){var e=this.getAttribute("checked")==="true";ample.getElementById("textbox-range-start").setAttribute("disabled",!e),ample.getElementById("textbox-range-end").setAttribute("disabled",!e),e?(ample.getElementById("textbox-range-start").focus(),ample.getElementById("textbox-range-start").blur(),ample.getElementById("textbox-range-end").focus(),ample.getElementById("textbox-range-end").blur()):(ample.getElementById("textbox-range-start").setAttribute("value",""),ample.getElementById("textbox-range-end").setAttribute("value",""))}}},"dialog-clipboard":{"listeners":{"dialogaccept":function(){if(ample.getElementById("checkbox-paste-range").getAttribute("checked")==="true"){var e=parseInt(ample.getElementById("textbox-range-start").getAttribute("value")),t=parseInt(ample.getElementById("textbox-range-end").getAttribute("value"));!isNaN(e)&&!isNaN(t)&&e>-1&&e<=t?JUL.apply(JUL.Designer.designer.state.clipboard,{"pasteStart":e,"pasteEnd":t}):(delete JUL.Designer.designer.state.clipboard.pasteStart,delete JUL.Designer.designer.state.clipboard.pasteEnd)}if(ample.getElementById("checkbox-map-class").getAttribute("checked")==="true"){var n=JUL.trim(ample.getElementById("textbox-map-class-from").getAttribute("value")),r=JUL.trim(ample.getElementById("textbox-map-class-to").getAttribute("value"));if(n&&r){n=n.split(",").map(JUL.trim),r=r.split(",").map(JUL.trim),JUL.Designer.designer.state.clipboard.mapClass={};for(var i=0;i<(n.length<r.length?n.length:r.length);i++)JUL.Designer.designer.state.clipboard.mapClass[n[i]]=r[i]}else delete JUL.Designer.designer.state.clipboard.mapClass}if(ample.getElementById("checkbox-paste-filter").getAttribute("checked")==="true"){var s=JUL.trim(ample.getElementById("textbox-filter-members").getAttribute("value"));s&&(JUL.Designer.designer.state.clipboard.pasteFilter=s.split(",").map(JUL.trim))}else delete JUL.Designer.designer.state.clipboard.pasteFilter}}},"textbox-filter-members":{"listeners":{"blur":function(){var e=JUL.Designer.designer.state.clipboard.contentMembers||{},t=JUL.trim(this.getAttribute("value"));if(t){t=t.split(",").map(JUL.trim);for(var n=0;n<t.length;n++)if(!t[n]||!e.hasOwnProperty(t[n]))t.splice(n,1),n--}else{t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r)}this.setAttribute("value",t.join(", "))}}},"textbox-range-end":{"listeners":{"blur":function(){var e=JUL.Designer.designer.state.clipboard.contentNodes||[],t=parseInt(this.getAttribute("value"));!e.length||isNaN(t)||t>e.length-1?t=e.length-1:t<0&&(t=0),this.setAttribute("value",t);if(!e.length)return;var n=parseInt(ample.getElementById("textbox-range-start").getAttribute("value"));!isNaN(t)&&n>t&&ample.getElementById("textbox-range-start").setAttribute("value",t)}}},"textbox-range-start":{"listeners":{"blur":function(){var e=JUL.Designer.designer.state.clipboard.contentNodes||[],t=parseInt(this.getAttribute("value"));!e.length||isNaN(t)||t<0?t=0:t>e.length-1&&(t=e.length-1),this.setAttribute("value",t);if(!e.length)return;var n=parseInt(ample.getElementById("textbox-range-end").getAttribute("value"));!isNaN(n)&&n<t&&ample.getElementById("textbox-range-end").setAttribute("value",t)}}}},JUL.apply(JUL.Designer,{"columnBuilders":{"code":function(e,t,n){e.id="button-code-"+e.id,this.state.map[e.id]=new JUL.Ref({"ref":t,"key":n,"field":e});var r={"tag":"listcell","children":[{"tag":"button","id":e.id,"css":"field","label":"...","width":"100%","tooltiptext":e.label,"listeners":{"command":function(){var e=JUL.Designer.getWhere(this);JUL.Designer.showCode(e)}}}]};return e.template&&(r.children[0].tooltiptext=r.children[0].tooltiptext+": "+e.template),r},"description":function(e,t,n){return e.id="button-desc-"+e.id,this.state.map[e.id]=new JUL.Ref({"ref":t,"key":n,"field":e}),{"tag":"listcell","children":[{"tag":"button","css":"field","id":e.id,"label":"...","width":"100%","tooltiptext":t[n]||"","listeners":{"command":function(){var e=JUL.Designer.getWhere(this);JUL.Designer.showComment(e)}}}]}},"value":function(e,t,n){return this.state.map[e.id]=new JUL.Ref({"ref":t,"key":n,"field":e}),{"tag":"listcell","children":[this.buildField(e,t[n])]}},"other":function(e,t,n){var r={"tag":"listcell","css":"label-field","label":e.label};if(e.tooltip||e.description)r.tooltiptext=e.tooltip||e.description;return r}},"panels":{},"parser":null,"parserConfig":{"defaultClass":"xul","useTags":!0,"customFactory":"JUL.UI.createDom","topDown":!0,"includeProperty":"_inc_","_usePrefixes":!0,"referencePrefix":"=_ref_:"},"state":{"map":{},"lastId":1,"lastDialog":null,"browseType":"","currentObject":null,"valueListeners":[]},"addListener":function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},"addValueListener":function(e,t,n,r){var i=new JUL.Ref({"ref":e,"key":t,"listener":n});typeof r=="object"&&(i.scope=r),this.state.valueListeners.push(i)},"applyRequired":function(e,t){for(var n in e)e.hasOwnProperty(n)&&e[n].required&&typeof t[n]=="undefined"&&(t[n]=e[n].defaultValue)},"buildField":function(e,t){var n=!e.required&&typeof t=="undefined";typeof t=="undefined"&&typeof e.defaultValue!="undefined"&&(t=e.defaultValue);var r="",i={"id":e.id,"css":"field","tag":"textbox","width":"100%"};if(JUL.typeOf(t)==="Date")i={"tag":"hbox","id":e.id,"css":"field","children":[{"tag":"datepicker","id":"datepicker-"+e.id},{"tag":"timepicker","id":"timepicker-"+e.id}]},this.state.map[i.children[0].id]=this.state.map[e.id],this.state.map[i.children[1].id]=this.state.map[e.id],JUL.apply(i.children[0],{"value":n?"":t.getFullYear()+"-"+(101+t.getMonth()).toString().substr(1)+"-"+(100+t.getDate()).toString().substr(1),"listeners":{"blur":this.onDateBlur,"focus":function(){JUL.Designer.state._lastFocus=this.getAttribute("id")},"keypress":function(e){e.keyIdentifier==="Enter"&&JUL.Designer.onDateBlur.call(this)}}}),JUL.apply(i.children[1],{"value":n?"":(100+t.getHours()).toString().substr(1)+":"+(100+t.getMinutes()).toString().substr(1)+":"+(100+t.getSeconds()).toString().substr(1),"listeners":{"blur":this.onTimeBlur,"focus":function(){JUL.Designer.state._lastFocus=this.getAttribute("id")},"keypress":function(e){e.keyIdentifier==="Enter"&&JUL.Designer.onTimeBlur.call(this)}}});else if(typeof t=="object"||typeof t=="function"){i.readonly=!0;if(t&&["Array","Object"].indexOf(JUL.typeOf(t))>-1){var s=this.parser.obj2str({"member":[t]});r=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/(\n|\t)/gm,"")}else r=(t?t.toString().replace(JUL.UI._regExps.autoUseStrict,"$1"):"[object Null]").replace(/\n/gm," ").replace(/\t/gm,"");r.length>100&&(r=r.substr(0,100)+" ..."),i.value=r}else typeof t=="boolean"?(i.tag="checkbox",i.checked=t,e.label="&nbsp;",delete i.width):typeof t=="number"?(i.type="number",i.min=-Number.MAX_VALUE,i.value=t):typeof t=="string"&&JUL.trim(t)===""?(i.value="String('"+t+"')",i.readonly=!0):t&&(i.value=t);return i.tag==="textbox"&&typeof t!="undefined"&&n&&(i.css="field undef"),i.tag==="checkbox"&&(i.listeners={"focus":function(){JUL.Designer.state._lastFocus=this.getAttribute("id")},"blur":function(){delete JUL.Designer.state._lastFocus},"change":function(){var e=JUL.Designer.getWhere(this),t=this.getAttribute("checked");e.oldValue=e.val(),e.val(t==="true"),!e.field.required&&e.val()===e.field.defaultValue&&e.del(),JUL.Designer.onValueUpdated(e)}}),i.tag==="textbox"&&!i.readonly&&(i.listeners={"blur":JUL.Designer.onBlur,"focus":function(){JUL.Designer.state._lastFocus=this.getAttribute("id"),this.getAttribute("readonly")!=="true"&&this.getAttribute("class")==="field undef"&&(this.setAttribute("value",""),JUL.Designer.replaceDom(this,function(){this.setAttribute("class","field")}))},"keypress":function(e){e.keyIdentifier==="Enter"&&JUL.Designer.onBlur.call(this)}}),i},"cancelCode":function(){this.panels.code.hide(),this.showLast()},"cancelComment":function(){this.panels.comment.hide(),this.showLast()},"cleanMap":function(){for(var e in this.state.map)this.state.map.hasOwnProperty(e)&&!ample.getElementById(e)&&delete this.state.map[e]},"doCmd":function(){if(!window.location.search)return;var e=window.location.search.split("?").pop().split("&");for(var t=0;t<e.length;t++){var n=e[t].split("=");n.length<2&&(n[1]=""),n=n.map(window.decodeURIComponent);switch(n[0]){case"oa":this.app.open(n[1]);break;case"op":this.designer.open(n[1]);break;case"of":this.framework.open(n[1])}}},"empty":function(e,t){if(!e)return;if(!isNaN(e.length)){ample.query(e).each(function(){JUL.Designer.empty(this,t)});return}while(e.lastChild)this.empty(e.lastChild),e.removeChild(e.lastChild);t&&e.parentNode.removeChild(e)},"fillBrowseList":function(){this.empty(ample.getElementById("listbox-browse").body),ample.get("assets/"+this.state.browseType+"s.txt",{"ts":(new Date).getTime()},function(e){e=JSON.parse(e);if(e.error){window.alert(e.error);return}var t=ample.query("#listbox-browse>xul|listbody").get(0);for(var n=0;n<e.result.length;n++){var r="item-"+JUL.Designer.state.lastId++;JUL.Designer.state.map[r]=e.result[n][0],t.appendChild(JUL.Designer.parser.createComponent({"tag":"listitem","id":r,"children":[JUL.Designer.parser.createComponent({"tag":"listcell","css":"label-field","label":e.result[n][0]}),JUL.Designer.parser.createComponent({"tag":"listcell","css":"label-field","label":e.result[n][1]})]}))}})},"fillListbox":function(e,t,n,r,i){var s=ample.query("#"+e+">xul|listbody");if(!s.length)return;r||(r=["label","value","code"]),s=s.get(0);var o=[];for(var u in t)if(t.hasOwnProperty(u)){var a=t[u];typeof n[u]=="undefined"&&a.required&&(n[u]=typeof a.defaultValue!="undefined"?a.defaultValue:null);var f=a.id;f||(f="field-"+this.state.lastId++);var l=[];for(var c=0;c<r.length;c++){var h=JUL.apply({"id":f,"label":u},a);h.required&&typeof h.defaultValue=="undefined"&&(h.defaultValue=null);var p=this.columnBuilders[r[c]],d=!1;if(i){var v=r[c].split("-");v.length>1&&this.columnBuilders[v[0]]&&(d=v[1],h={"id":f+"-"+d.toLowerCase(),"label":u+" - "+d},a[d]&&typeof a[d]=="object"&&JUL.apply(h,a[d]),p=this.columnBuilders[v[0]])}p||(p=this.columnBuilders.other),l.push(p.call(this,h,d?n[u]:n,d||u))}e="item-"+f,this.state.map[e]=u,o.push({"tag":"listitem","id":e,"children":l})}var m=this.parser.create(o);for(var g=0;g<o.length;g++)s.appendChild(m[g])},"filterTab":function(e){if(e.keyIdentifier==="U+0009"){e.preventDefault();var t=this.$getContainer("input");if(!t)return!1;try{var n=t.selectionStart||0,r=t.selectionEnd||0,i=this.getAttribute("value");this.setAttribute("value",i.slice(0,n)+"	"+i.substr(r)),t.selectionEnd=n+1,t.selectionStart=n+1}catch(s){}return!1}},"getWhere":function(e){return typeof e=="string"?this.state.map[e]:this.state.map[e.getAttribute("id")]},"init":function(){this.parser=new JUL.UI.Parser(this.parserConfig),this.panels={"designer":this.parser.create(this.designer.ui,this.designer.logic),"project":this.parser.create(this.designer.projectUi,this.designer.projectLogic),"app":this.parser.create(this.app.ui,this.app.logic),"framework":this.parser.create(this.framework.ui,this.framework.logic),"code":this.parser.create(this.codeUi),"comment":this.parser.create(this.commentUi),"browse":this.parser.create(this.browseUi),"js":this.parser.create(this.jsUi),"clipboard":this.parser.create(this.clipboardUi,this.clipboardLogic),"xml":this.parser.create(this.xmlUi),"help":this.parser.create(this.help.ui),"about":this.parser.create(this.about.ui)};for(var e in this.panels)if(this.panels.hasOwnProperty(e)){ample.documentElement.appendChild(this.panels[e]);if(e==="about"||e==="designer")continue;this.panels[e].addEventListener("windowhidden",function(){var e=JUL.Designer;e.designer.current.ns&&!e.state.lastDialog&&ample.getElementById("deck-test").setAttribute("selectedIndex",0)}),this.panels[e].addEventListener("windowshown",function(){ample.getElementById("deck-test").setAttribute("selectedIndex",1)})}this.restorePrefs(),ample.getElementById("statusbarpanel-main").setAttribute("label",this.title+" version "+this.version),ample.getElementById("deck-test").setAttribute("selectedIndex",1),setTimeout(function(){JUL.Designer.panels.about.showModal()},500),setTimeout(function(){JUL.Designer.panels.about.hide()},5e3),ample.getElementById("table-add-component").lastChild.selectItem=function(){},ample.documentElement.addEventListener("keydown",function(e){if(e.keyIdentifier==="U+001B"&&e.target.nodeName==="xul:dialog"){var t=e.target.getAttribute("id");["dialog-app","dialog-code","dialog-comment","dialog-project","dialog-framework"].indexOf(t)>-1&&e.stopPropagation()}},!0),ample.getElementById("table-add-component").lastChild.selectItem=function(){},ample.getElementById("listbox-app-modules").addEventListener("click",function(e){e.target.nodeName==="xul:listheader"&&e.stopPropagation()},!0),this.addListener(document.getElementById("iframe-test"),"load",JUL.Designer.designer.onTestLoad),this.addListener(document.getElementById("iframe-help"),"load",JUL.Designer.help.onLoad);try{ample.getElementById("textbox-code").$getContainer("input").wrap="off",ample.getElementById("textbox-js").$getContainer("input").wrap="off",ample.getElementById("textbox-xml").$getContainer("input").wrap="off",ample.getElementById("textbox-clipboard-components").$getContainer("input").wrap="off",ample.getElementById("textbox-clipboard-members").$getContainer("input").wrap="off",ample.getElementById("textbox-project-template").$getContainer("input").wrap="off",ample.getElementById("textbox-app-js").$getContainer("input").wrap="off",ample.getElementById("textbox-app-template").$getContainer("input").wrap="off"}catch(t){}this.doCmd()},"isEmpty":function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return!t},"jsonReviver":function(sKey,oValue){if(sKey&&typeof oValue=="string"){var bPrefix=!1;if(this._usePrefixes)for(var sItem in this._jsonPrefixes)if(this._jsonPrefixes.hasOwnProperty(sItem)&&oValue.substr(0,this._jsonPrefixes[sItem].length)===this._jsonPrefixes[sItem]&&JUL.trim(oValue.substr(this._jsonPrefixes[sItem].length))){bPrefix=!0,oValue=oValue.substr(this._jsonPrefixes[sItem].length).replace(/^\s+/,"");break}if(bPrefix||!this._usePrefixes&&(this._regExps.regexp.test(oValue)||this._regExps.functionStart.test(oValue)||this._regExps.newStart.test(oValue)))try{return eval("(function(){return "+oValue+"})()")}catch(e){return oValue}}return oValue},"keySort":function(e,t,n,r){var i=[],s=[],o=[],u=[];t=t||[],n=n||[];var a=r?{}:e;for(var f in e)if(e.hasOwnProperty(f)){if(t.indexOf(f)<0&&n.indexOf(f)<0){var l=JUL.typeOf(e[f]);switch(l){case"Array":s.push(f);break;case"Object":o.push(f);break;case"Function":u.push(f);break;default:i.push(f)}}r&&(a[f]=e[f],delete e[f])}var c=[].concat(n,i.sort(),s.sort(),o.sort(),u.sort(),t),h=r?e:{};for(var p=0;p<c.length;p++){var d=c[p];typeof a[d]!="undefined"&&(h[d]=a[d])}return h},"makeCompat":function(e,t){if(!e.result.version||e.result.version.substr(0,2)==="0.")this.parser._usePrefixes=!1,JUL.apply(e,JSON.parse(t,JUL.makeCaller(this.parser,this.jsonReviver))),this.parser._usePrefixes=!0},"onBlur":function(e){e&&delete JUL.Designer.state._lastFocus;if(this.getAttribute("readonly")==="true"||this.getAttribute("class")==="field undef")return;var t=JUL.Designer.getWhere(this),n=this.getAttribute("value");this.getAttribute("type")==="number"&&n&&(n=parseFloat(n),isNaN(n)&&(n=t.val(),typeof n=="undefined"&&(n="")),this.setAttribute("value",n));if(n===""&&!t.field.required){typeof t.val()!="undefined"&&(t.oldValue=t.val(),t.del(),JUL.Designer.onValueUpdated(t)),e&&typeof t.field.defaultValue!="undefined"&&(typeof t.oldValue==typeof t.field.defaultValue?(this.setAttribute("value",t.field.defaultValue),JUL.Designer.replaceDom(this,function(){this.setAttribute("class","field undef")})):JUL.Designer.replaceDom(this,JUL.Designer.parser.createComponent(JUL.Designer.buildField(t.field))));return}t.field.required&&n===""&&(n=t.field.defaultValue),t.val()!==n&&(t.oldValue=t.val(),t.val(n),JUL.Designer.onValueUpdated(t)),e&&(typeof t.oldValue==typeof n?this.setAttribute("value",n):JUL.Designer.replaceDom(this,JUL.Designer.parser.createComponent(JUL.Designer.buildField(t.field,n))))},"onDateBlur":function(e){e&&delete JUL.Designer.state._lastFocus;var t=this.getAttribute("id"),n=JUL.Designer.getWhere(t),r=n.val(),i=this.$getContainer("input").value;if(i&&!/^\d{4}\W\d{2}\W\d{2}$/.test(i)){this.setAttribute("value",r?r.getFullYear()+"-"+(101+r.getMonth()).toString().substr(1)+"-"+(100+r.getDate()).toString().substr(1):"");return}this.setAttribute("value",i?i.substr(0,4)+"-"+i.substr(5,2)+"-"+i.substr(8,2):""),n.field.oldValue=r;if(i){var s=r?new Date(r.getTime()):new Date(1980,0);r||ample.getElementById("timepicker"+t.substr(10)).setAttribute("value","00:00:00"),s.setFullYear(parseInt(i.substr(0,4))),s.setMonth(parseInt(i.substr(5,2))-1),s.setDate(parseInt(i.substr(8,2))),n.val(s)}else ample.getElementById("timepicker"+t.substr(10)).setAttribute("value",""),n.field.required?n.val(n.field.defaultValue):n.del();JUL.Designer.onValueUpdated(n)},"onTimeBlur":function(e){e&&delete JUL.Designer.state._lastFocus;var t=this.getAttribute("id"),n=JUL.Designer.getWhere(t),r=n.val(),i=this.$getContainer("input").value;if(i&&!/^\d{2}\W\d{2}\W\d{2}$/.test(i)){this.setAttribute("value",r?(100+r.getHours()).toString().substr(1)+":"+(100+r.getMinutes()).toString().substr(1)+":"+(100+r.getSeconds()).toString().substr(1):"");return}i||(i="00:00:00"),this.setAttribute("value",i.substr(0,2)+":"+i.substr(3,2)+":"+i.substr(6,2)),n.field.oldValue=r;var s=r?new Date(r.getTime()):new Date(1980,0);r||ample.getElementById("datepicker"+t.substr(10)).setAttribute("value","1980-01-01"),s.setHours(parseInt(i.substr(0,2))),s.setMinutes(parseInt(i.substr(3,2))),s.setSeconds(parseInt(i.substr(6,2))),n.val(s),JUL.Designer.onValueUpdated(n)},"onValueUpdated":function(e){for(var t=0;t<this.state.valueListeners.length;t++){var n=this.state.valueListeners[t];n.ref()===e.ref()&&(!n.key()||n.key()===e.key())&&n.listener.call(n.scope||e.ref(),e)}},"removeValueListener":function(e,t,n){for(var r=0;r<this.state.valueListeners.length;r++){var i=this.state.valueListeners[r];i.ref()===e&&(!t||i.key()===t)&&(!n||i.listener===n)&&(this.state.valueListeners.splice(r,1),r--)}},"replaceDom":function(e,t){var n=!1;typeof t=="function"&&(n=t,t=e);var r=e.parentNode,i=e.nextSibling;t!==e&&this.empty(e),r.removeChild(e),n&&n.call(t,r,i),i?r.insertBefore(t,i):r.appendChild(t)},"restorePrefs":function(){try{var e=JSON.parse(ample.cookie("jul-designer-prefs"))}catch(t){return}if(!e||typeof e!="object")return;for(var n in this._prefs)if(this._prefs.hasOwnProperty(n)&&e[n]){var r=ample.query(n),i=e[n];for(var s=0;s<r.length&&s<i.length;s++){var o=r.get(s),u=[].concat(this._prefs[n]);for(var a=0;a<u.length;a++){var f=u[a];typeof i[s][f]!="undefined"&&o.setAttribute(f,i[s][f])}}}},"wrapExport":function(e,t){return"(function(global, module) {\n'use strict';\nif (module && module.exports && typeof require === 'function') { require('jul'); }\n"+(t?"\n/* if in Node, export the instance factory, else apply it to the global namespace  */":"")+"\nvar fInstance = function(oNSRoot) {"+(t?"\n/* create a JUL instance bound to oNSRoot and make it available to the inner code */":"")+"\nvar jul = new JUL.Instance({nsRoot: oNSRoot || global});"+"\n\n"+e+"\n};"+"\n\nif (module && module.exports) {"+"\n	module.exports = fInstance;\n}\nelse if (global) {\n	fInstance(global);\n}\nreturn fInstance;"+"\n\n})(typeof global !== 'undefined' ? global : window, (typeof window === 'undefined' || !window.module) && typeof module !== 'undefined' ? module : null);\n"},"exec":function(e,t){e='(function() { "use strict"; var fCall = JUL.get('+JUL.UI.obj2str(t).replace(/\r?\n\s*/g," ")+"); fCall(\n"+e+"\n); window.onerror = null; })();";var n=document.createElement("script");n.setAttribute("type","text/javascript"),n["textContent"in n?"textContent":"text"]=e;var r=document.getElementsByTagName("head")[0];window.onerror=function(e,n,r){return setTimeout(function(){window.onerror=null,JUL.get(t)(e.toString(),r)},0),!0},r.insertBefore(n,r.firstChild),r.removeChild(n)},"saveCode":function(){this.state._afterSave=this.state._afterSave||JUL.makeCaller(this,function(){var e=this.state.currentObject;this.onValueUpdated(e);var t=this.state.map[e.field.id.substr(12)];if(t){var n=ample.getElementById(t.field.id);n&&this.replaceDom(n,this.parser.create(this.buildField(t.field,t.val())))}this.panels.code.hide(),this.showLast()});var e=JUL.trim(ample.getElementById("textbox-code").getAttribute("value")),t=this.state.currentObject;t.oldValue=t.val(),e?this.exec(e,function(e,t){typeof t=="undefined"?(JUL.Designer.state.currentObject.val(e),JUL.Designer.state._afterSave()):window.alert(e+"\nLine: "+((t||1)-1))}):(t.del(),this.state._afterSave())},"saveComment":function(){var e=JUL.trim(ample.getElementById("textbox-comment").getAttribute("value")),t=this.state.currentObject;e?t.val(e):t.del(),ample.getElementById(t.field.id).setAttribute("tooltiptext",e),this.panels.comment.hide(),this.showLast()},"savePrefs":function(){var e={};for(var t in this._prefs)if(this._prefs.hasOwnProperty(t)){var n=ample.query(t),r=[];n.length&&(e[t]=r);for(var i=0;i<n.length;i++){var s=n.get(i);s.getBoundingClientRect();var o=[].concat(this._prefs[t]);r[i]={};for(var u=0;u<o.length;u++){var a=o[u],f=s.getAttribute(a);f&&f!=="0"&&(r[i][a]=f)}}}return ample.cookie("jul-designer-prefs",JSON.stringify(e),{"expires":7,"path":"/"}),e},"showCode":function(e){var t=e.field.label+(e.field.required?"*":"");e.field.template&&(t=t+": "+e.field.template.substr(0,100),e.field.template.length>100&&(t+=" ...")),this.panels.code.setAttribute("title",t),this.state.currentObject=e;var n=e.val(),r="";typeof n=="undefined"&&typeof e.field.defaultValue!="undefined"&&(n=e.field.defaultValue,r="/* value is undefined - default pasted */\n");var i=this.parser.obj2str({"o":n}),s=i.slice(i.indexOf(":")+1,i.lastIndexOf("}")).replace(/\n\t/gm,"\n");ample.getElementById("textbox-code").setAttribute("value",typeof n=="undefined"?"":r+JUL.trim(s)),this.state.lastDialog&&this.state.lastDialog.hide(),this.panels.code.showModal(),setTimeout(function(){ample.getElementById("textbox-code").focus()},500)},"showComment":function(e){this.panels.comment.setAttribute("title",e.field.label),this.state.currentObject=e;var t=e.val();ample.getElementById("textbox-comment").setAttribute("value",t||""),this.state.lastDialog&&this.state.lastDialog.hide(),this.panels.comment.showModal(),setTimeout(function(){ample.getElementById("textbox-comment").focus()},500)},"showLast":function(){this.state.lastDialog&&this.state.lastDialog.showModal(),this.state.lastDialog===this.panels.framework&&setTimeout(function(){JUL.Designer.framework.scrollLists()},500)},"validNS":function(e){var t=e.split(".");for(var n=0;n<t.length;n++)if(!JUL.UI._regExps.variable.test(t[n]))return!1;return!0},"_prefs":{"#command-show-add":"checked","#command-show-menu":"checked","#command-show-status":"checked","#dialog-app":["width","height"],"#dialog-browse":["width","height"],"#dialog-clipboard":["width","height"],"#dialog-code":["width","height"],"#dialog-comment":["width","height"],"#dialog-framework":["width","height"],"#dialog-help":["width","height"],"#dialog-js":["width","height"],"#dialog-project":["width","height"],"#dialog-xml":["width","height"],"#listbox-app-modules xul|listheader":"width","#listbox-app-parser xul|listheader":"width","#listbox-app-settings xul|listheader":"width","#listbox-designer-listeners xul|listheader":"width","#listbox-designer-logic xul|listheader":"width","#listbox-designer-ui xul|listheader":"width","#listbox-framework-component-events xul|listheader":"width","#listbox-framework-component-members xul|listheader":"width","#listbox-framework-component-settings":"height","#listbox-framework-component-settings xul|listheader":"width","#listbox-framework-components xul|listheader":"width","#listbox-framework-settings xul|listheader":"width","#listbox-project-parser xul|listheader":"width","#listbox-project-settings xul|listheader":"width","#menubar-app":"hidden","#statusbar-app":"hidden","#tree-interface":"height","#tree-interface xul|treecol":"width","#vbox-add-component":"hidden","#vbox-framework-components":"width","#vbox-project":"width"}}),window.onbeforeunload=function(e){JUL.Designer.savePrefs(),JUL.Designer.state.oTestWnd&&!JUL.Designer.state.oTestWnd.closed&&JUL.Designer.state.oTestWnd.close(),JUL.Designer.state.oTestAppWnd&&!JUL.Designer.state.oTestAppWnd.closed&&JUL.Designer.state.oTestAppWnd.close();if(JUL.Designer.designer.state.notSaved)return setTimeout(function(){JUL.Designer.designer.checkSave("exit"),delete JUL.Designer.designer.state.notSaved},0),"Unsaved changes to the project will be discarded when you leave the page"},JUL.apply(ample.classes[JUL.UI.xmlNS.xul+"#listcell"].prototype,{"$getTagOpen":function(){var e=this
.parentNode.parentNode.parentNode.firstChild.childNodes[this.parentNode.childNodes.$indexOf(this)],t='<td class="xul-listcell'+(this.hasAttribute("class")?" "+this.getAttribute("class"):"")+'"'+(e&&e.getAttribute("hidden")==="true"?' style="display:none;"':"")+'><div class="xul-listcell--box" style=""><div class="xul-listcell--label xul-listcell--gateway" style="">';return this.hasAttribute("image")&&(t+='<img src="'+ample.$encodeXMLCharacters(this.getAttribute("image"))+'" align="absmiddle"/> '),this.hasAttribute("label")&&(t+=ample.$encodeXMLCharacters(this.getAttribute("label"))),t},"$getTagClose":function(){return"</div></div></td>"}})})(),function(){"use strict";JUL.ns("JUL.Designer.app"),JUL.Designer.app.ui={"tag":"dialog","id":"dialog-app","title":"Application","width":980,"height":470,"hidden":!0,"children":[{"tag":"tabbox","children":[{"tag":"tabs","id":"tabs-app","children":[{"tag":"tab","label":"Settings","width":80,"pack":"center"},{"tag":"tab","label":"Default parser","width":80,"pack":"center"},{"tag":"tab","label":"Modules","id":"tab-app-modules","width":80,"pack":"center"},{"tag":"tab","label":"JavaScript","id":"tab-app-js","width":80,"pack":"center"},{"tag":"tab","label":"Template","width":80,"pack":"center"}]}]},{"tag":"deck","id":"deck-app","flex":1,"children":[{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-app-settings","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Setting","width":250},{"tag":"listheader","label":"Value","width":380},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-app-parser","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Member","width":250},{"tag":"listheader","label":"Value","width":380},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","label":"Add","id":"button-add-module","type":"menu-button","children":[{"tag":"menupopup","children":[{"tag":"menuitem","id":"menuitem-add-current-project","label":"Add current project"}]}]},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Up","id":"button-up-module"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Down","id":"button-down-module"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Remove","id":"button-remove-modules"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Change","id":"button-change-module"},{"tag":"toolbarseparator"},{"tag":"hbox","width":"95%","children":[{"tag":"textbox","id":"textbox-module-name","style":"width:300px;margin-top:6px","tooltiptext":"Module name"}]}]},{"tag":"listbox","flex":1,"id":"listbox-app-modules","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Module","width":220},{"tag":"listheader","label":"Namespace","width":330},{"tag":"listheader","label":"Description","width":140}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"textbox","id":"textbox-app-js","readonly":!0,"width":"100%","css":"code","multiline":!0,"flex":1}]},{"tag":"vbox","flex":1,"children":[{"tag":"description","value":"Testing HTML page. Besides {jul_script}, {app_script} and {modules_scripts}, all {app_<property>} properties are available; page timestamp {ts}."},{"tag":"textbox","id":"textbox-app-template","width":"100%","css":"code","multiline":!0,"flex":1}]}]}]},JUL.Designer.app.logic={"button-add-module":{"listeners":{"command":function(){if(this.getAttribute("open")==="true")return;JUL.Designer.app.addModule()}}},"button-change-module":{"listeners":{"command":function(){JUL.Designer.app.changeModule()}}},"button-down-module":{"listeners":{"command":function(){JUL.Designer.app.shiftModule()}}},"button-remove-modules":{"listeners":{"command":function(){JUL.Designer.app.removeModules()}}},"button-up-module":{"listeners":{"command":function(){JUL.Designer.app.shiftModule(!0)}}},"dialog-app":{"listeners":{"dialogaccept":function(){return JUL.Designer.app.save(),JUL.Designer.cleanMap(),!1},"dialogcancel":function(){return JUL.Designer.app.cancel(),JUL.Designer.cleanMap(),!1}}},"listbox-app-modules":{"listeners":{"select":function(){var e=this.selectedItems,t=e.length?e.item(e.length-1):null;ample.getElementById("textbox-module-name").setAttribute("value",t?JUL.Designer.getWhere(t):"")}}},"menuitem-add-current-project":{"listeners":{"command":function(){JUL.Designer.app.addProject()}}},"tabs-app":{"listeners":{"select":function(){this.parentNode.selectedTab.getAttribute("id")==="tab-app-js"&&setTimeout(function(){JUL.Designer.app.fillJs()},100),ample.getElementById("deck-app").setAttribute("selectedIndex",this.parentNode.selectedIndex)}}},"textbox-app-template":{"listeners":{"keydown":"JUL.Designer.filterTab","blur":function(){JUL.Designer.app.state.newApp.template=JUL.trim(this.getAttribute("value"))}}},"textbox-module-name":{"listeners":{"keypress":function(e){if(e.keyIdentifier==="Enter"){var t=ample.getElementById("listbox-app-modules").selectedItems;t.length&&!e.shiftKey?JUL.Designer.app.changeModule():JUL.Designer.app.addModule()}}}}},JUL.apply(JUL.Designer.app,{"current":{},"fields":{"title":{"tooltip":"Application's title","id":"setting-app-title","defaultValue":"Application 1","required":!0,"template":"<string>"},"ns":{"tooltip":"Namespace path","id":"setting-app-ns","defaultValue":"app1","required":!0,"template":"<string>"},"init":{"tooltip":"Application instantiation method","id":"setting-app-init","template":"\u00a0function() { ... }","required":!0,"defaultValue":function(){for(var e in this.modules)if(this.modules.hasOwnProperty(e)){var t=this.modules[e].ns;t.substr(0,1)==="."&&(t=this.ns+t);var n=JUL.get(t);if(!n)continue;var r=new JUL.UI.Parser(n.parserConfig);r.create(n.ui,n.logic)}}},"preferredFramework":{"tooltip":"If supplied, will act as the suggested framework for new projects","id":"setting-app-framework","template":"<string>"}},"parserFields":null,"state":{"currentOperation":"","newApp":null},"addModule":function(e){var t=this.state.newApp.modules,n=1,r=JUL.trim(ample.getElementById("textbox-module-name").getAttribute("value"));if(!r||t[r])while((r="module"+n++)&&t[r]);ample.getElementById("textbox-module-name").setAttribute("value",""),t[r]=JUL.apply({"ns":"."+r},e||{});var i={};i[r]={"ns":{"required":!0,"defaultValue":t[r].ns}},JUL.Designer.fillListbox("listbox-app-modules",i,t,["label","value-ns","description-description"],!0),ample.getElementById("listbox-app-modules").querySelector("xul|listbody").lastChild.scrollIntoView(),ample.getElementById("listbox-app-modules").clearSelection()},"addProject":function(){var e=JUL.Designer.designer.current;if(!e.ns)return;var t={"ns":e.ns,"description":e.title},n=this.state.newApp;t.ns.substr(0,n.ns.length+1)===n.ns+"."&&(t.ns=t.ns.substr(n.ns.length));var r=JUL.trim(ample.getElementById("textbox-module-name").getAttribute("value"));r||ample.getElementById("textbox-module-name").setAttribute("value",e.ns.split(".").pop()),this.addModule(t)},"cancel":function(){this.state.newApp=null,JUL.Designer.panels.app.hide(),JUL.Designer.state.lastDialog=null},"changeModule":function(){var e=ample.getElementById("listbox-app-modules").selectedItems;if(!e.length){window.alert("Please select an item");return}var t=e.item(e.length-1),n=JUL.Designer.getWhere(t),r=this.state.newApp.modules,i=JUL.trim(ample.getElementById("textbox-module-name").getAttribute("value"));if(!i||i===n||r[i]){ample.getElementById("textbox-module-name").setAttribute("value",n);return}r[i]=r[n],delete r[n],JUL.Designer.state.map[t.getAttribute("id")]=i,t.firstChild.setAttribute("label",i);var s=t.childNodes[1];while(s){var o=JUL.Designer.getWhere(s.firstChild);o.field.label=i+" - "+o.key(),o.key()==="ns"&&(o.field.defaultValue="."+i),s=s.nextSibling}ample.getElementById("listbox-app-modules").clearSelection()},"cleanApp":function(e){e=JUL.apply({},e),JUL.Designer.applyRequired(this.fields,e),JUL.Designer.applyRequired(this.parserFields,e.defaultParser),e=JUL.Designer.keySort(e,["modules","defaultParser","template"]);var t=[],n=ample.getElementById("listbox-app-modules").querySelector("xul|listbody").firstChild;while(n)t.push(JUL.Designer.getWhere(n)),n=n.nextSibling;return e.modules=JUL.Designer.keySort(e.modules,t),e},"close":function(){this.current={},this.onSwitchCurrent()},"del":function(){if(!this.current.ns){window.alert("There is no current application");return}if(!window.confirm("Are you sure to permanently delete '"+this.current.title+"' app?"))return;ample.get("assets/alter.txt",{"ts":(new Date).getTime()},function(e){e=JSON.parse(e),e.error?window.alert(e.error):JUL.Designer.app.close()})},"downloadUrl":function(){return"#"},"fillJs":function(){var e=this.cleanApp(this.state.newApp);delete e.template,ample.getElementById("textbox-app-js").setAttribute("value",this.testJs(e,!0))},"fillMenupopup":function(e){var t=ample.getElementById("menupopup-switch-module"),n=ample.getElementById("menupopup-switch-module-button"),r=this.current.modules;if(!e){JUL.Designer.empty(t),JUL.Designer.empty(n);if(!this.current.ns)return;var i=1;for(var s in r)if(r.hasOwnProperty(s)){var o={"tag":"menuitem","id":"menuitem-switch-module-"+i,"type":"radio","label":s,"listeners":{"command":function(){JUL.Designer.app.fillMenupopup(!0),JUL.Designer.app.switchModule(JUL.Designer.getWhere(this))}},"parent":t};JUL.Designer.state.map[o.id]=s,r[s].description&&(o.tooltiptext=r[s].description),JUL.Designer.parser.createComponent(o),o.id="menubutton-switch-module-"+i,o.parent=n,JUL.Designer.state.map[o.id]=s,JUL.Designer.parser.createComponent(o),i++}}this.state.radioTimer&&clearTimeout(this.state.radioTimer),this.state.radioTimer=setTimeout(function(){delete JUL.Designer.app.state.radioTimer;var e=1;for(var t in r)if(r.hasOwnProperty(t)){var n=r[t].ns;n.substr(0,1)==="."&&(n=JUL.Designer.app.current.ns+n),ample.getElementById("menuitem-switch-module-"+e).setAttribute("checked",n===JUL.Designer.designer.current.ns),ample.getElementById("menubutton-switch-module-"+e).setAttribute("checked",n===JUL.Designer.designer.current.ns),e++}},100)},"onSwitchCurrent":function(){JUL.Designer.designer.setTitle(),ample.getElementById("anchor-test-app").setAttribute("href",this.current.ns?this.testUrl():"#"),ample.getElementById("anchor-download-app").setAttribute("href",this.current.ns?this.downloadUrl():"#"),JUL.Designer.state.oTestAppWnd&&!JUL.Designer.state.oTestAppWnd.closed&&JUL.Designer.state.oTestAppWnd.close(),this.fillMenupopup()},"open":function(e){ample.get("assets/apps/"+e.split(".").join("/")+".txt",{"ts":(new Date).getTime()},function(e){var t=JSON.parse(e,JUL.makeCaller(JUL.Designer.parser,JUL.Designer.jsonReviver));if(t.error){window.alert(t.error);return}JUL.Designer.makeCompat(t,e);var n=JUL.Designer.app;JUL.Designer.panels.browse.hide(),n.current=t.result,n.onSwitchCurrent(),setTimeout(function(){for(var e in n.current.modules)if(n.current.modules.hasOwnProperty(e)){n.switchModule(e);break}},100)})},"removeModules":function(){var e=ample.getElementById("listbox-app-modules").selectedItems;if(!e.length){window.alert("Please select some items");return}var t=this.state.newApp.modules;for(var n=e.length-1;n>=0;n--){var r=JUL.Designer.getWhere(e.item(n));delete t[r]}JUL.Designer.empty(e,!0)},"save":function(){var e=this.state.currentOperation==="save"?this.current:this.state.newApp;if(!JUL.Designer.validNS(e.ns)){window.alert("Invalid namespace");return}e.version="1."+(new Date).getTime(),this.state.currentOperation!=="save"&&(e=this.cleanApp(e));var t=JUL.apply({},e);delete t.template,ample.get("assets/alter.txt",{"ts":(new Date).getTime()},function(e){e=JSON.parse(e);if(e.error)window.alert(e.error);else{var t=JUL.Designer.app;t.state.currentOperation==="save"?(ample.getElementById("anchor-test-app").setAttribute("href",t.testUrl()),ample.getElementById("anchor-download-app").setAttribute("href",t.downloadUrl())):(JUL.Designer.panels.app.hide(),JUL.Designer.state.lastDialog=null,t.current=t.cleanApp(t.state.newApp),t.state.newApp=null,t.onSwitchCurrent())}})},"shiftModule":function(e){var t=ample.getElementById("listbox-app-modules").selectedItems;if(!t.length)return;var n=t.item(t.length-1);if(e&&!n.previousSibling)return;if(!e&&!n.nextSibling)return;var r=e?n.previousSibling:n,i=e?n:n.nextSibling,s=n.parentNode;s.removeChild(i),s.insertBefore(i,r),ample.getElementById("listbox-app-modules").reflow(),ample.getElementById("listbox-app-modules").selectItem(n)},"show":function(e){if(e==="edit"&&!this.current.ns){window.alert("There is no current application");return}this.state.newApp={"defaultParser":{},"modules":{},"version":"0."+(new Date).getTime()};var t=this.state.newApp,n=JUL.Designer.designer;if(e==="edit")for(var r in this.current)this.current.hasOwnProperty(r)&&(t[r]=n.copy(this.current[r]));var i;if(!this.parserFields){this.parserFields={};for(i in n.parserFields)n.parserFields.hasOwnProperty(i)&&(this.parserFields[i]=JUL.apply({},n.parserFields[i]),this.parserFields[i].id&&(this.parserFields[i].id=this.parserFields[i].id+"-app"))}JUL.Designer.empty(ample.getElementById("listbox-app-settings").body),JUL.Designer.empty(ample.getElementById("listbox-app-parser").body),JUL.Designer.empty(ample.getElementById("listbox-app-modules").body),t.template||(t.template=JUL.Designer.config.defaultAppTemplate),ample.getElementById("textbox-app-template").setAttribute("value",t.template),JUL.Designer.fillListbox("listbox-app-settings",this.fields,t),JUL.Designer.fillListbox("listbox-app-parser",this.parserFields,t.defaultParser);var s={};for(i in t.modules)t.modules.hasOwnProperty(i)&&(s[i]={"ns":{"required":!0,"defaultValue":"."+i}});JUL.Designer.fillListbox("listbox-app-modules",s,t.modules,["label","value-ns","description-description"],!0),this.state.currentOperation=e,JUL.Designer.panels.app.setAttribute("title",e==="new"?"New application":"Edit application - "+t.title),JUL.Designer.state.lastDialog=JUL.Designer.panels.app,ample.getElementById("menuitem-add-current-project").setAttribute("disabled",!JUL.Designer.designer.current.ns),JUL.Designer.panels.app.showModal();var o=JUL.Designer.panels.app.querySelector("xul|tabs");o.firstChild.$activate()},"switchModule":function(e){var t=this.current.modules[e],n=t.ns;n.substr(0,1)==="."&&(n=this.current.ns+n);var r=JUL.Designer.designer;if(r.current.ns===n)return;r.state.initProject={"ns":n,"title":this.current.title+" - "+(t.description||e.substr(0,1).toUpperCase()+e.substr(1)),"parserConfig":r.copy(this.current.defaultParser)},this.current.preferredFramework&&(r.state.initProject.suggestedFramework=this.current.preferredFramework);if(r.current.ns&&r.checkSave("open_new",n))return;r.open(n,!0)},"testJs":function(e,t){var n="/* generated by "+JUL.Designer.title+" version "+JUL.Designer.version+" */\n";if(t){var r=JUL.Designer.keySort(e,["modules"]);delete r.defaultParser;var i=JUL.Designer.keySort(e.defaultParser);for(var s in i)i.hasOwnProperty(s)&&typeof JUL.UI[s]!="undefined"&&JSON.stringify(i[s])===JSON.stringify(JUL.UI[s])&&delete i[s];var o=[{"suf":"","ref":r,"desc":""},{"suf":".defaultParser","ref":i,"desc":" default parser"}];n=n+"/* '"+r.title+"' namespace */\n",n=n+"var oApp = jul.ns('"+r.ns+"');\n\n";for(var u=0;u<o.length;u++){var a=o[u];n+=a.suf?"oApp"+a.suf+" =\n":"jul.apply(oApp,\n",n=n+"/* begin '"+r.title+"'"+a.desc+" */\n",n=n+JUL.Designer.parser.obj2str(a.ref)+"\n",n=n+"/* end '"+r.title+"'"+a.desc+" */\n",n=n+(a.suf?"":")")+";\n\n"}}else n=n+"var oApp = jul.ns('"+e.ns+"');\n",n=n+"jul.apply(oApp, "+JUL.Designer.parser.obj2str(e)+");\n";return JUL.Designer.wrapExport(n,t)},"testUrl":function(){return"assets/apps/"+encodeURIComponent(this.current.ns)+".html?"+"version="+encodeURIComponent(this.current.version)+"&current="+encodeURIComponent(JUL.Designer.designer.current.ns||"")}})}(),function(){"use strict";JUL.ns("JUL.Designer.designer"),JUL.Designer.designer.ui={"tag":"page","children":[{"tag":"commandset","hidden":!0,"children":[{"tag":"command","id":"command-new-app"},{"tag":"command","id":"command-open-app"},{"tag":"command","id":"command-edit-app"},{"tag":"command","id":"command-close-app"},{"tag":"command","id":"command-delete-app"},{"tag":"command","id":"command-new-project"},{"tag":"command","id":"command-open-project"},{"tag":"command","id":"command-edit-project"},{"tag":"command","id":"command-save-project"},{"tag":"command","id":"command-close-project"},{"tag":"command","id":"command-delete-project"},{"tag":"command","id":"command-no-logic"},{"tag":"command","id":"command-view-js"},{"tag":"command","id":"command-xml-layout"},{"tag":"command","id":"command-copy-node"},{"tag":"command","id":"command-cut-node"},{"tag":"command","id":"command-paste-node"},{"tag":"command","id":"command-up-node"},{"tag":"command","id":"command-down-node"},{"tag":"command","id":"command-remove-node"},{"tag":"command","id":"command-copy-members"},{"tag":"command","id":"command-cut-members"},{"tag":"command","id":"command-paste-members"},{"tag":"command","id":"command-remove-members"},{"tag":"command","id":"command-undo"},{"tag":"command","id":"command-new-framework"},{"tag":"command","id":"command-open-framework"},{"tag":"command","id":"command-edit-framework"},{"tag":"command","id":"command-close-framework"},{"tag":"command","id":"command-delete-framework"},{"tag":"command","id":"command-prepend-namespace"},{"tag":"command","id":"command-help-contents"},{"tag":"command","id":"command-help-about"},{"tag":"command","id":"command-show-clipboard"},{"tag":"command","id":"command-show-menu","checked":!0},{"tag":"command","id":"command-show-status","checked":!0},{"tag":"command","id":"command-show-add","checked":!0}]},{"xclass":"html","tag":"div","children":[{"tag":"menupopup","id":"menupopup-show-bars","children":[{"tag":"menuitem","command":"command-show-menu","type":"checkbox","label":"Show menu bar"},{"tag":"menuitem","command":"command-show-add","type":"checkbox","label":"Show add component"},{"tag":"menuitem","command":"command-show-status","type":"checkbox","label":"Show status bar"}]},{"tag":"menupopup","id":"menupopup-edit","_inc_":"JUL.Designer.designer.editUi"}]},{"tag":"menubar","id":"menubar-app","context":"menupopup-show-bars","children":[{"tag":"toolbargrippy"},{"tag":"menu","label":"Application\u00a0\u00a0","children":[{"tag":"menupopup","children":[{"tag":"menuitem","command":"command-new-app","label":"New application ..."},{"tag":"menuitem","command":"command-open-app","label":"Open application ..."},{"tag":"menuitem","command":"command-edit-app","label":"Edit application ..."},{"tag":"menu","label":"Switch module","children":[{"tag":"menupopup","id":"menupopup-switch-module"}]},{"tag":"menuitem","command":"command-close-app","label":"Close application"},{"tag":"menuitem","command":"command-delete-app","label":"Delete application"}]}]},{"tag":"menu","label":"Project\u00a0\u00a0","children":[{"tag":"menupopup","children":[{"tag":"menuitem","command":"command-new-project","label":"New project ..."},{"tag":"menuitem","command":"command-open-project","label":"Open project ..."},{"tag":"menuitem","command":"command-edit-project","label":"Edit project ..."},{"tag":"menuitem","command":"command-save-project","label":"Save project"},{"tag":"menuitem","command":"command-close-project","label":"Close project"},{"tag":"menuitem","command":"command-delete-project","label":"Delete project"},{"tag":"menuseparator"},{"tag":"menuitem","type":"checkbox","command":"command-no-logic","label":"Don't separate logic"},{"tag":"menuseparator"},{"tag":"menuitem","command":"command-view-js","label":"View JavaScript"},{"tag":"menuitem","command":"command-xml-layout","label":"XML layout"}]}]},{"tag":"menu","label":"Edit\u00a0\u00a0","children":[{"tag":"menupopup","id":"menu-edit","_inc_":"JUL.Designer.designer.editUi"}]},{"tag":"menu","label":"Framework\u00a0\u00a0","children":[{"tag":"menupopup","children":[{"tag":"menuitem","command":"command-new-framework","label":"New framework ..."},{"tag":"menuitem","command":"command-open-framework","label":"Open framework ..."},{"tag":"menuitem","command":"command-edit-framework","label":"Edit framework ..."},{"tag":"menuitem","command":"command-close-framework","label":"Close framework"},{"tag":"menuitem","command":"command-delete-framework","label":"Delete framework"},{"tag":"menuseparator"},{"tag":"menuitem","type":"checkbox","command":"command-prepend-namespace","label":"Prepend namespace"}]}]},{"tag":"menu","label":"Help\u00a0\u00a0","children":[{"tag":"menupopup","children":[{"tag":"menuitem","command":"command-help-contents","label":"Contents"},{"tag":"menuitem","command":"command-help-about","label":"About"},{"tag":"menuseparator"},{"tag":"menuitem","command":"command-show-clipboard","label":"Show clipboard"}]}]}]},{"tag":"toolbar","context":"menupopup-show-bars","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","label":"NA","css":"tbutton darkm","command":"command-new-app","tooltiptext":"New application"},{"tag":"toolbarbutton","label":"OA","css":"tbutton darkm","command":"command-open-app","tooltiptext":"Open application"},{"tag":"toolbarbutton","label":"EA","css":"tbutton darkm","command":"command-edit-app","tooltiptext":"Edit application"},{"tag":"toolbarbutton","label":"SM","type":"menu","css":"tbutton darkm","tooltiptext":"Switch module","children":[{"tag":"menupopup","id":"menupopup-switch-module-button"}]},{"tag":"toolbarbutton","label":"CA","css":"tbutton darkm","command":"command-close-app","tooltiptext":"Close application"},{"tag":"toolbarbutton","label":"XA","css":"tbutton darkm","command":"command-delete-app","tooltiptext":"Delete application"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"NP","css":"tbutton darkr","tooltiptext":"New project","command":"command-new-project"},{"tag":"toolbarbutton","label":"OP","css":"tbutton darkr","tooltiptext":"Open project","command":"command-open-project"},{"tag":"toolbarbutton","label":"EP","css":"tbutton darkr","tooltiptext":"Edit project","command":"command-edit-project"},{"tag":"toolbarbutton","label":"SP","css":"tbutton darkr","tooltiptext":"Save project","command":"command-save-project"},{"tag":"toolbarbutton","label":"CP","css":"tbutton darkr","tooltiptext":"Close project","command":"command-close-project"},{"tag":"toolbarbutton","label":"XP","css":"tbutton darkr","tooltiptext":"Delete project","command":"command-delete-project"},{"tag":"toolbarbutton","label":"NL","type":"checkbox","css":"tbutton darkr","tooltiptext":"Don't separate logic","command":"command-no-logic"},{"tag":"toolbarbutton","label":"JS","css":"tbutton darkr","tooltiptext":"View JavaScript","command":"command-view-js"},{"tag":"toolbarbutton","label":"XL","css":"tbutton darkr","tooltiptext":"XML layout","command":"command-xml-layout"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"AC","id":"tbutton-add-component","type":"menu","css":"tbutton darky","tooltiptext":"Add component","children":[{"tag":"menupopup","children":[{"xclass":"html","tag":"td","colspan":4,"height":1,"width":148,"children":[{"tag":"scrollbox","flex":1,"orient":"vertical","children":[{"xclass":"html","tag":"table","id":"table-add-component","cols":4,"width":"100%","border":0,"cellspacing":0,"cellpadding":0,"children":[{"xclass":"html","tag":"tbody"}]}]}]}]}]},{"tag":"toolbarbutton","label":"CC","css":"tbutton darky","tooltiptext":"Copy components","command":"command-copy-node"},{"tag":"toolbarbutton","label":"TC","css":"tbutton darky","tooltiptext":"Cut components","command":"command-cut-node"},{"tag":"toolbarbutton","label":"PC","css":"tbutton darky","tooltiptext":"Paste components","command":"command-paste-node"},{"tag":"toolbarbutton","label":"UP","css":"tbutton darky","tooltiptext":"Move component up","command":"command-up-node"},{"tag":"toolbarbutton","label":"DN","css":"tbutton darky","tooltiptext":"Move component down","command":"command-down-node"},{"tag":"toolbarbutton","label":"XC","css":"tbutton darky","tooltiptext":"Remove components","command":"command-remove-node"},{"tag":"toolbarbutton","label":"CM","css":"tbutton darky","tooltiptext":"Copy members","command":"command-copy-members"},{"tag":"toolbarbutton","label":"TM","css":"tbutton darky","tooltiptext":"Cut members","command":"command-cut-members"},{"tag":"toolbarbutton","label":"PM","css":"tbutton darky","tooltiptext":"Paste members","command":"command-paste-members"},{"tag":"toolbarbutton","label":"XM","css":"tbutton darky","tooltiptext":"Remove members","command":"command-remove-members"},{"tag":"toolbarbutton","label":"UN","css":"tbutton darky","tooltiptext":"Undo","command":"command-undo"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"NF","css":"tbutton darkg","tooltiptext":"New framework","command":"command-new-framework"},{"tag":"toolbarbutton","label":"OF","css":"tbutton darkg","tooltiptext":"Open framework","command":"command-open-framework"},{"tag":"toolbarbutton","label":"EF","css":"tbutton darkg","tooltiptext":"Edit framework","command":"command-edit-framework"},{"tag":"toolbarbutton","label":"CF","css":"tbutton darkg","tooltiptext":"Close framework","command":"command-close-framework"},{"tag":"toolbarbutton","label":"XF","css":"tbutton darkg","tooltiptext":"Delete framework","command":"command-delete-framework"},{"tag":"toolbarbutton","label":"PN","type":"checkbox","css":"tbutton darkg","tooltiptext":"Prepend namespace","command":"command-prepend-namespace"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"HC","css":"tbutton darkb","tooltiptext":"Contents","command":"command-help-contents"},{"tag":"toolbarbutton","label":"HA","css":"tbutton darkb","tooltiptext":"About","command":"command-help-about"},{"tag":"toolbarbutton","label":"SC","css":"tbutton darkb","tooltiptext":"Show clipboard","command":"command-show-clipboard"},{"tag":"toolbarbutton","label":"SB","css":"tbutton darkb","type":"menu","tooltiptext":"Show bars","children":[{"tag":"menupopup","children":[{"tag":"menuitem","command":"command-show-menu","type":"checkbox","label":"Show menu bar"},{"tag":"menuitem","command":"command-show-add","type":"checkbox","label":"Show add component"},{"tag":"menuitem","command":"command-show-status","type":"checkbox","label":"Show status bar"}]}]},{"tag":"vbox","flex":1},{"xclass":"html","tag":"div","width":205,"style":"padding:5px 17px 0 0;text-align:right","children":[{"xclass":"html","tag":"a","id":"anchor-test","css":"tbutton","target":"_test","href":"#","html":"TP","title":"Open the project in a separate window"},{"xclass":"html","tag":"a","id":"anchor-download","css":"tbutton","style":"margin-left:10px","href":"#","html":"DP","title":"Download saved project"},{"xclass":"html","tag":"a","id":"anchor-test-app","css":"tbutton","style":"margin-left:10px","target":"_test_app","href":"#","html":"TA","title":"Open the application in a separate window"},{"xclass":"html","tag":"a","id":"anchor-download-app","css":"tbutton","style":"margin-left:10px","href":"#","html":"DA","title":"Download saved application"}]}]},{"tag":"hbox","flex":1,"children":[{"tag":"vbox","id":"vbox-project","width":495,"context":"menupopup-edit","children":[{"tag":"hbox","flex":1,"children":[{"tag":"vbox","width":"100%","children":[{"tag":"description","value":"Component tree","css":"caption"},{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","label":"Up","command":"command-up-node"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Down","command":"command-down-node"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Remove","command":"command-remove-node"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Find","id":"button-tree-search"},{"tag":"toolbarseparator"},{"tag":"hbox","width":"95%","children":[{"tag":"textbox","id":"textbox-tree-search","style":"margin-top:6px","tooltiptext":"Component ID or binding ID","maxwidth":200,"width":"100%"}]}]},{"tag":"hbox","children":[{"tag":"label","value":"Show"},{"tag":"menulist","id":"menulist-designer-members","children":[{"tag":"menupopup"}]},{"tag":"label","value":"in"},{"tag":"menulist","id":"menulist-designer-members-where","children":[{"tag":"menupopup","children":[{"tag":"menuitem","label":"ui","value":"ui"},{"tag":"menuitem","label":"logic","value":"logic"}]}]}]},{"tag":"hbox","children":[{"tag":"spacer","width":80},{"tag":"label","value":"as"},{"tag":"menulist","id":"menulist-designer-members-type","children":[{"tag":"menupopup","children":[{"tag":"menuitem","label":"Array","value":"Array"},{"tag":"menuitem","label":"Object","value":"Object"}]}]}]},{"tag":"tree","id":"tree-interface","minheight":120,"height":180,"children":[{"tag":"treecols","children":[{"tag":"treecol","width":220,"label":"Component","primary":!0},{"tag":"treecol","width":160,"label":"ID"},{"tag":"treecol","width":145,"label":"Members"}]},{"tag":"treebody"}]},{"tag":"splitter"},{"tag":"description","value":"Component members","css":"caption","id":"label-component"},{"tag":"tabbox","id":"tabbox-designer-members","children":[{"tag":"tabs","id":"tabs-designer-members","children":[{"tag":"tab","label":"UI","width":60,"pack":"center"},{"tag":"tab","label":"Logic","width":60,"pack":"center"},{"tag":"tab","label":"Listeners","width":60,"pack":"center"}]}]},{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","label":"Add","id":"button-designer-add"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Remove","command":"command-remove-members"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Change","id":"button-designer-change"},{"tag":"toolbarseparator"},{"tag":"hbox","width":"95%","children":[{"tag":"textbox","id":"textbox-designer-name","style":"margin-top:6px","tooltiptext":"Member or event name","maxwidth":200,"width":"100%"}]}]},{"tag":"deck","id":"deck-designer-members","flex":1,"children":[{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-designer-ui","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Member","width":115},{"tag":"listheader","label":"Value","width":170},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-designer-logic","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Member","width":115},{"tag":"listheader","label":"Value","width":170},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-designer-listeners","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Listener","width":115},{"tag":"listheader","label":"Value","width":170},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]}]}]},{"tag":"spacer","width":3},{"tag":"vbox","id":"vbox-add-component","width":145,"children":[{"tag":"description","value":"Add component","css":"caption"},{"tag":"scrollbox","id":"scrollbox-components","flex":1,"orient":"vertical"}]}]}]},{"tag":"splitter","id":"splitter-test"},{"tag":"vbox","flex":1,"children":[{"tag":"description","value":"Project","css":"caption","id":"label-project"},{"tag":"deck","id":"deck-test","flex":1,"children":[{"tag":"vbox","flex":1,"children":[{"xclass":"html","tag":"div","flex":1,"children":[{"xclass":"html","tag":"iframe","id":"iframe-test","name":"iframe-test","width":"100%","height":"100%","seamless":"yes","style":"border:0"}]}]},{"tag":"vbox","flex":1,"children":[{"xclass":"html","tag":"div","flex":1,"id":"test-bck"}]}]}]}]},{"tag":"statusbar","id":"statusbar-app","context":"menupopup-show-bars","children":[{"tag":"spacer","width":4},{"tag":"statusbarpanel","id":"statusbarpanel-main","label":"JUL Designer","flex":1},{"tag":"spacer","width":4},{"tag":"statusbarpanel","id":"statusbarpanel-app","label":"","flex":1},{"tag":"spacer","width":4},{"tag":"statusbarpanel","id":"statusbarpanel-project","label":"","flex":1},{"tag":"spacer","width":4},{"tag":"statusbarpanel","id":"statusbarpanel-framework","label":"","flex":1},{"tag":"spacer","width":4},{"tag":"statusbarpanel","id":"statusbarpanel-selection","label":"","flex":1},{"tag":"spacer","width":4}]}]},JUL.Designer.designer.logic={"anchor-download":{"listeners":{"click":function(){var e=this.getAttribute("href");if(e.substr(0,1)==="#")return!1}}},"anchor-download-app":{"listeners":{"click":function(){var e=this.getAttribute("href");if(e.substr(0,1)==="#")return!1}}},"anchor-test":{"listeners":{"click":function(){var e=this.getAttribute("href");return e.substr(0,1)==="#"?!1:(JUL.Designer.state.oTestWnd&&!JUL.Designer.state.oTestWnd.closed&&JUL.Designer.state.oTestWnd.close(),JUL.Designer.state.oTestWnd=window.open(e,"_test"
),!1)}}},"anchor-test-app":{"listeners":{"click":function(){var e=this.getAttribute("href");return e.substr(0,1)==="#"?!1:(JUL.Designer.state.oTestAppWnd&&!JUL.Designer.state.oTestAppWnd.closed&&JUL.Designer.state.oTestAppWnd.close(),JUL.Designer.state.oTestAppWnd=window.open(e,"_test_app"),!1)}}},"button-designer-add":{"listeners":{"command":function(){var e=ample.getElementById("tabbox-designer-members").selectedIndex;JUL.Designer.designer.addMember(e?e<2?"logic":"listeners":"ui")}}},"button-designer-change":{"listeners":{"command":function(){var e=ample.getElementById("tabbox-designer-members").selectedIndex,t=e?e<2?"logic":"listeners":"ui",n=ample.getElementById("listbox-designer-"+t).selectedItems;if(!n.length){window.alert("Please select an item");return}var r=n.item(n.length-1);JUL.Designer.designer.changeMember(JUL.Designer.getWhere(r),t,r)}}},"button-tree-search":{"listeners":{"command":function(){if(!JUL.Designer.designer.current.ui)return;JUL.Designer.designer.searchId(ample.getElementById("textbox-tree-search").getAttribute("value"))}}},"command-close-app":{"listeners":{"command":function(){JUL.Designer.app.close()}}},"command-close-framework":{"listeners":{"command":function(){JUL.Designer.framework.close()}}},"command-close-project":{"listeners":{"command":function(){JUL.Designer.designer.close(),JUL.Designer.cleanMap()}}},"command-copy-members":{"listeners":{"command":function(){JUL.Designer.designer.onCopyMembers()}}},"command-copy-node":{"listeners":{"command":function(){JUL.Designer.designer.onCopyNode()}}},"command-cut-members":{"listeners":{"command":function(){JUL.Designer.designer.onCopyMembers(!0)}}},"command-cut-node":{"listeners":{"command":function(){JUL.Designer.designer.onCopyNode(!0)}}},"command-delete-app":{"listeners":{"command":function(){JUL.Designer.app.del()}}},"command-delete-framework":{"listeners":{"command":function(){JUL.Designer.framework.del()}}},"command-delete-project":{"listeners":{"command":function(){JUL.Designer.designer.del()}}},"command-down-node":{"listeners":{"command":function(){var e=ample.getElementById("tree-interface").selectedItems;if(!e.length){window.alert("Please select a component");return}var t=e.item(e.length-1);t.nextSibling&&JUL.Designer.designer.shiftNode(t)}}},"command-edit-app":{"listeners":{"command":function(){JUL.Designer.app.show("edit")}}},"command-edit-framework":{"listeners":{"command":function(){JUL.Designer.framework.show("edit")}}},"command-edit-project":{"listeners":{"command":function(){JUL.Designer.designer.show("edit")}}},"command-help-about":{"listeners":{"command":function(){JUL.Designer.panels.about.showModal()}}},"command-help-contents":{"listeners":{"command":function(){JUL.Designer.panels.help.showModal()}}},"command-new-app":{"listeners":{"command":function(){JUL.Designer.app.show("new")}}},"command-new-framework":{"listeners":{"command":function(){JUL.Designer.framework.show("new")}}},"command-new-project":{"listeners":{"command":function(){JUL.Designer.designer.show("new")}}},"command-no-logic":{"listeners":{"command":function(){var e=this.getAttribute("checked")!=="true";this.setAttribute("checked",e),JUL.Designer.designer.current.ns&&(JUL.Designer.designer.current.noLogic=e,delete JUL.Designer.designer.state.clipboard.undo,JUL.Designer.designer.onSelectNode(JUL.Designer.designer.currentNode))}}},"command-open-app":{"listeners":{"command":function(){JUL.Designer.designer.showBrowse("app")}}},"command-open-framework":{"listeners":{"command":function(){JUL.Designer.designer.showBrowse("framework")}}},"command-open-project":{"listeners":{"command":function(){JUL.Designer.designer.showBrowse("project")}}},"command-paste-members":{"listeners":{"command":function(){JUL.Designer.designer.onPasteMembers()}}},"command-paste-node":{"listeners":{"command":function(){JUL.Designer.designer.onPasteNode()}}},"command-prepend-namespace":{"listeners":{"command":function(){var e=this.getAttribute("checked")!=="true";this.setAttribute("checked",e),JUL.Designer.framework.current.ns&&(JUL.Designer.framework.current.prependNS=e)}}},"command-remove-members":{"listeners":{"command":function(){JUL.Designer.designer.onCopyMembers(!0,!0)}}},"command-remove-node":{"listeners":{"command":function(){JUL.Designer.designer.onCopyNode(!0,!0)}}},"command-save-project":{"listeners":{"command":function(){JUL.Designer.designer.saveCurrent(),JUL.Designer.cleanMap()}}},"command-show-add":{"listeners":{"command":function(){var e=this.getAttribute("checked")!=="true";this.setAttribute("checked",e),ample.getElementById("vbox-add-component").setAttribute("hidden",!e)}}},"command-show-clipboard":{"listeners":{"command":function(){JUL.Designer.designer.showClipboard()}}},"command-show-menu":{"listeners":{"command":function(){var e=this.getAttribute("checked")!=="true";this.setAttribute("checked",e),ample.getElementById("menubar-app").setAttribute("hidden",!e)}}},"command-show-status":{"listeners":{"command":function(){var e=this.getAttribute("checked")!=="true";this.setAttribute("checked",e),ample.getElementById("statusbar-app").setAttribute("hidden",!e)}}},"command-undo":{"listeners":{"command":function(){JUL.Designer.designer.undo()}}},"command-up-node":{"listeners":{"command":function(){var e=ample.getElementById("tree-interface").selectedItems;if(!e.length){window.alert("Please select a component");return}var t=e.item(e.length-1);t.previousSibling&&JUL.Designer.designer.shiftNode(t,!0)}}},"command-view-js":{"listeners":{"command":function(){JUL.Designer.designer.showJs()}}},"command-xml-layout":{"listeners":{"command":function(){JUL.Designer.designer.showXml()}}},"listbox-designer-listeners":{"listeners":{"select":function(e){var t=this.selectedItems;ample.getElementById("textbox-designer-name").setAttribute("value",t.length?JUL.Designer.getWhere(t.item(t.length-1)):"")}}},"listbox-designer-logic":{"listeners":{"select":function(e){var t=this.selectedItems;ample.getElementById("textbox-designer-name").setAttribute("value",t.length?JUL.Designer.getWhere(t.item(t.length-1)):"")}}},"listbox-designer-ui":{"listeners":{"select":function(e){var t=this.selectedItems;ample.getElementById("textbox-designer-name").setAttribute("value",t.length?JUL.Designer.getWhere(t.item(t.length-1)):"")}}},"menuliist-designer-members":{"listeners":{"command":function(){JUL.Designer.designer.currentNode||this.setAttribute("value","");var e=this.getAttribute("value");JUL.Designer.designer.onMembersSelect(e)}}},"menuliist-designer-members-type":{"listeners":{"command":function(){JUL.Designer.designer.currentNode||this.setAttribute("value","");var e=this.getAttribute("value");JUL.Designer.designer.onMembersTypeSelect(e)}}},"menulist-designer-members":{"listeners":{"command":function(){var e=this;setTimeout(function(){if(!JUL.Designer.designer.currentNode){e.setAttribute("value","");return}JUL.Designer.designer.showMembers(e.getAttribute("value"))},50)}}},"menulist-designer-members-type":{"listeners":{"command":function(){var e=this;setTimeout(function(){if(!JUL.Designer.designer.currentNode){e.setAttribute("value","");return}JUL.Designer.designer.changeType(e.getAttribute("value"))},50)}}},"menulist-designer-members-where":{"listeners":{"command":function(){var e=this,t=this.getAttribute("value");setTimeout(function(){if(!JUL.Designer.designer.currentNode){e.setAttribute("value","");return}if(JUL.Designer.designer.current.noLogic){e.setAttribute("value",t);return}JUL.Designer.designer.changeWhere(e.getAttribute("value"))},50)}}},"splitter-test":{"listeners":{"mousedown":function(){ample.getElementById("deck-test").setAttribute("selectedIndex",1)},"mouseup":function(){JUL.Designer.designer.current.ns&&ample.getElementById("deck-test").setAttribute("selectedIndex",0)}}},"tabs-designer-members":{"listeners":{"select":function(){var e=ample.getElementById("tabbox-designer-members").selectedIndex;ample.getElementById("deck-designer-members").setAttribute("selectedIndex",e);var t=e?e<2?"logic":"listeners":"ui";if(JUL.Designer.designer.currentNode){var n=JUL.Designer.getWhere(JUL.Designer.designer.currentNode).val(),r=JUL.Designer.designer.getTarget(n);switch(t){case"ui":JUL.Designer.designer.currentConfig=n;break;case"logic":JUL.Designer.designer.currentConfig=r;break;case"listeners":JUL.Designer.designer.currentConfig=r[JUL.Designer.designer.current.listenersProperty]}}else JUL.Designer.designer.currentConfig=null;var i=ample.getElementById("listbox-designer-"+t).selectedItems;ample.getElementById("textbox-designer-name").setAttribute("value",i.length?JUL.Designer.getWhere(i.item(i.length-1)):"")}}},"tbutton-add-component":{"listeners":{"click":function(){this.firstChild.firstChild.setAttribute("height",1);if(this.firstChild.getAttribute("hidden")==="true")return;var e=ample.getElementById("table-add-component").lastChild;if(!e.childNodes.length)return;var t=ample.documentElement.getBoundingClientRect().bottom-this.getBoundingClientRect().bottom;t=t<21?0:t-21;var n=e.lastChild.getBoundingClientRect().bottom-this.getBoundingClientRect().bottom+6;this.firstChild.firstChild.setAttribute("height",n<t?n:t)}}},"textbox-designer-name":{"listeners":{"keypress":function(e){if(e.keyIdentifier==="Enter"){var t=ample.getElementById("tabbox-designer-members").selectedIndex,n=t?t<2?"logic":"listeners":"ui",r=ample.getElementById("listbox-designer-"+n).selectedItems;if(r.length&&!e.shiftKey){var i=r.item(r.length-1);JUL.Designer.designer.changeMember(JUL.Designer.getWhere(i),n,i)}else JUL.Designer.designer.addMember(n)}}}},"textbox-tree-search":{"listeners":{"keypress":function(e){if(e.keyIdentifier==="Enter"){if(!JUL.Designer.designer.current.ui)return;JUL.Designer.designer.searchId(this.getAttribute("value"))}}}},"tree-interface":{"listeners":{"select":function(e){var t=JUL.Designer.designer;t.state.selectTimer&&clearTimeout(t.state.selectTimer),t.state.selectTimer=setTimeout(function(){delete t.state.selectTimer;var e=ample.getElementById("tree-interface").selectedItems;t.onSelectNode(e.length?e.item(e.length-1):null)},100)},"click":function(e){e.target.nodeName==="xul:treecell"&&setTimeout(function(){JUL.Designer.designer.onCellClick()},150)}}}},JUL.Designer.designer.projectUi={"tag":"dialog","id":"dialog-project","title":"Project","width":980,"height":470,"hidden":!0,"children":[{"tag":"tabbox","children":[{"tag":"tabs","id":"tabs-project","children":[{"tag":"tab","label":"Settings","width":80,"pack":"center"},{"tag":"tab","label":"Parser","width":80,"pack":"center"},{"tag":"tab","label":"Template","width":80,"pack":"center"}]}]},{"tag":"deck","id":"deck-project","flex":1,"children":[{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-project-settings","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Setting","width":250},{"tag":"listheader","label":"Value","width":380},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-project-parser","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Member","width":250},{"tag":"listheader","label":"Value","width":380},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"description","value":"Testing HTML page. Besides {jul_script} and {project_script}, all {project_<property>} properties are available; page timestamp {ts}."},{"tag":"textbox","id":"textbox-project-template","width":"100%","css":"code","multiline":!0,"flex":1}]}]}]},JUL.Designer.designer.projectLogic={"dialog-project":{"listeners":{"dialogaccept":function(){return JUL.Designer.designer.save(),JUL.Designer.cleanMap(),!1},"dialogcancel":function(){return JUL.Designer.designer.cancel(),JUL.Designer.cleanMap(),!1}}},"tabs-project":{"listeners":{"select":function(){ample.getElementById("deck-project").setAttribute("selectedIndex",this.parentNode.selectedIndex)}}},"textbox-project-template":{"listeners":{"keydown":"JUL.Designer.filterTab","blur":function(){JUL.Designer.designer.state.newProject.template=JUL.trim(this.getAttribute("value"))}}}},JUL.Designer.designer.editUi={"children":[{"tag":"menuitem","label":"Copy components","command":"command-copy-node"},{"tag":"menuitem","label":"Cut components","command":"command-cut-node"},{"tag":"menuitem","label":"Paste components","command":"command-paste-node"},{"tag":"menuitem","label":"Move component up","command":"command-up-node"},{"tag":"menuitem","label":"Move component down","command":"command-down-node"},{"tag":"menuitem","label":"Remove components","command":"command-remove-node"},{"tag":"menuseparator"},{"tag":"menuitem","label":"Copy members","command":"command-copy-members"},{"tag":"menuitem","label":"Cut members","command":"command-cut-members"},{"tag":"menuitem","label":"Paste members","command":"command-paste-members"},{"tag":"menuitem","label":"Remove members","command":"command-remove-members"},{"tag":"menuseparator"},{"tag":"menuitem","label":"Undo","command":"command-undo"}]},JUL.apply(JUL.Designer.designer,{"current":{},"currentConfig":null,"currentNode":null,"fields":{"title":{"tooltip":"Project's title","id":"setting-project-title","defaultValue":"Project 1","required":!0,"template":"<string>"},"ns":{"tooltip":"Namespace path","id":"setting-project-ns","defaultValue":"project1","required":!0,"template":"<string>"},"init":{"tooltip":"Project instantiation method","id":"setting-project-init","template":"\u00a0function() { ... }","required":!0,"defaultValue":function(){var e=new JUL.UI.Parser(this.parserConfig);e.create(this.ui,this.logic)}},"suggestedFramework":{"tooltip":"If not empty, will try to open this framework when opening the project","id":"setting-project-framework","template":"<string>"},"listenersProperty":{"tooltip":"Name of the event listeners property","id":"setting-project-listeners-property","defaultValue":"listeners","required":!0,"template":"<string>"},"noLogic":{"tooltip":"Don't separate logic from UI","required":!0,"defaultValue":!1,"template":"<boolean>"},"keepBindings":{"tooltip":"Keep all binding IDs in the generated code","required":!0,"defaultValue":!1,"template":"<boolean>"}},"parserFields":{"classProperty":{"tooltip":"Name of the class property","id":"setting-parser-class-property","defaultValue":"xclass","required":!0,"template":"<string>"},"defaultClass":{"tooltip":"Name of the default class","id":"setting-parser-default-class","required":!0,"defaultValue":"Object","template":"<string>"},"childrenProperty":{"tooltip":"Name of the children property","id":"setting-parser-children-property","defaultValue":"children","required":!0,"template":"<string>"},"membersProperties":{"tooltip":"Array of other members properties","id":"setting-parser-members-properties","defaultValue":[],"required":!0,"template":'["category1", "category2" ... ]'},"membersMappings":{"tooltip":"Per-class mappings between a class name and a members array","id":"setting-parser-members-mappingss","defaultValue":{},"required":!0,"template":'{"class1":<array1>, "class2":<array2> ... }'},"idProperty":{"tooltip":"Name of the ID property","id":"settingparser-id-property","defaultValue":"id","required":!0,"template":"<string>"},"bindingProperty":{"tooltip":"Name of the binding ui with logic property","id":"setting-parser-binding-property","defaultValue":"cid","required":!0,"template":"<string>"},"useTags":{"tooltip":"Whether to use tags in configs","id":"setting-parser-use-tags","required":!0,"defaultValue":!1,"template":"<boolean>"},"tagProperty":{"tooltip":"Name of the tag property","id":"setting-parser-tag-property","defaultValue":"tag","required":!0,"template":"<string>"},"customFactory":{"tooltip":"If supplied, it will be passed the component config","id":"setting-parser-custom-factory","template":"\u00a0function(oConfig) { ... return oInstance; }"},"topDown":{"tooltip":"Check this for a top-down instantiation","id":"setting-parser-top-down","required":!0,"defaultValue":!1,"template":"<boolean>"},"_otherProperties":{"tooltip":"Object with other parser properties to be applied over","id":"setting-parser-other-properies","defaultValue":{},"template":"<object>"}},"state":{"clipboard":{},"currentOperation":"","newProject":null,"notSaved":!1},"addComponent":function(e){if(!this.current.ns){this.show("new");return}var t=this.currentParser,n=JUL.Designer.framework.current,r=n.components[e],i=null,s=!1;if(this.currentNode){var o=JUL.Designer.getWhere(this.currentNode),u=o.val(),a=this.getId(u);a&&this.current.logic[a]&&ample.getElementById("menulist-designer-members-where").getAttribute("value")==="logic"&&(u=this.current.logic[a]),ample.getElementById("menulist-designer-members-type").getAttribute("value")==="Object"&&(u[o.showWhat]||(i=new JUL.Ref({"ref":u,"key":o.showWhat})));if(!i){u[o.showWhat]||(u[o.showWhat]=[]);if(JUL.typeOf(u[o.showWhat])!=="Array"){u[o.showWhat]=[u[o.showWhat]];var f=JUL.Designer.getWhere(this.currentNode.querySelector("xul|treechildren").firstChild);f.ref(u[o.showWhat],0),f.parent=new JUL.Ref({"ref":u,"key":o.showWhat}),ample.getElementById("menulist-designer-members-type").setAttribute("value","Array"),s=!0}i=new JUL.Ref({"ref":u[o.showWhat],"key":u[o.showWhat].length,"parent":new JUL.Ref({"ref":u,"key":o.showWhat})})}}else if(this.current.ui){if(JUL.typeOf(this.current.ui)!=="Array"){this.current.ui=[this.current.ui];var l=JUL.Designer.getWhere(ample.getElementById("tree-interface").querySelector("xul|treechildren").firstChild);l.ref(this.current.ui,0),l.parent=new JUL.Ref({"ref":this.current,"key":"ui"}),s=!0}i=new JUL.Ref({"ref":this.current.ui,"key":this.current.ui.length,"parent":new JUL.Ref({"ref":this.current,"key":"ui"})})}else i=new JUL.Ref({"ref":this.current,"key":"ui"});var c={},h=n.nsAlias||n.ns;i.val(c);var p=t.useTags?h:n.prependNS?h+"."+e:e;c[t.classProperty]=p,t.useTags&&(c[t.tagProperty]=e);var d=!1;this.current.noLogic||(d=(t.useTags?c[t.tagProperty]:p)+"-"+this.current.lastComponentId++,c[t.bindingProperty]=d);if(r){var v=JUL.Designer.framework.getInherited(r,"members")||{};for(var m in JUL.Designer.keySort(v))if(v.hasOwnProperty(m)&&(v[m].required||typeof v[m].defaultValue)==="string"){var g=v[m],y=c;!this.current.noLogic&&g.logic&&(this.current.logic[d]||(this.current.logic[d]={}),y=this.current.logic[d]),y[m]=g.defaultValue}}this.state.clipboard.undo={"operation":"addNodes","where":[i],"logic":[],"toArray":s,"show":!1},this.currentNode&&(this.state.clipboard.undo.show=this.findPath(o.val())),d&&this.current.logic[d]&&this.state.clipboard.undo.logic.push(d),this.save(!0,!0);var b=this.buildTree(this.currentNode,i);ample.getElementById("tree-interface").reflow(),b.scrollIntoView()},"addConfigListeners":function(e){var t=this.getTarget(e);JUL.Designer.addValueListener(e,this.currentParser.classProperty,this.onClassUpdated,this),this.currentParser.useTags&&JUL.Designer.addValueListener(e,this.currentParser.tagProperty,this.onClassUpdated,this),JUL.Designer.addValueListener(e,this.currentParser.idProperty,this.onIdUpdated,this),this.current.noLogic||JUL.Designer.addValueListener(e,this.currentParser.bindingProperty,this.onBindingUpdated,this),JUL.Designer.addValueListener(e,this.currentParser.instantiateProperty,this.onInstantiateUpdated,this),JUL.Designer.addValueListener(e,null,this.onConfigUpdated,this),t!==e&&JUL.Designer.addValueListener(t,null,this.onConfigUpdated,this),JUL.Designer.addValueListener(t[this.current.listenersProperty],null,this.onConfigUpdated,this)},"addMember":function(e){if(!this.currentNode){window.alert("Please select a component from the top");return}var t=1,n=JUL.trim(ample.getElementById("textbox-designer-name").getAttribute("value")),r=this.getExclude();if(!n||typeof this.currentConfig[n]!="undefined"||n!==this.currentParser.instantiateProperty&&r.indexOf(n)>-1||ample.query("#listbox-designer-"+e+">xul|listbody xul|listcell[label="+n+"]").length)while((n=(e==="listeners"?"event":"member")+t++)&&(typeof this.currentConfig[n]!="undefined"||r.indexOf(n)>-1||ample.query("#listbox-designer-"+e+">xul|listbody xul|listcell[label="+n+"]").length));ample.getElementById("textbox-designer-name").setAttribute("value","");var i={};i[n]={"tooltip":e==="listeners"?"Custom event":"Custom "+e+" member"},JUL.Designer.fillListbox("listbox-designer-"+e,i,this.currentConfig),ample.getElementById("listbox-designer-"+e).querySelector("xul|listbody").lastChild.scrollIntoView(),ample.getElementById("listbox-designer-"+e).clearSelection()},"buildTree":function(e,t,n,r){var i=this.currentParser,s=null;t||(t=new JUL.Ref({"ref":this.current,"key":"ui"}));if(!t.val())return;if(JUL.typeOf(t.val())==="Array"){var o=t.val();for(var u=0;u<o.length;u++)this.buildTree(e,new JUL.Ref({"ref":o,"key":u,"parent":t}),n);return}e||(e=ample.getElementById("tree-interface").querySelector("xul|treebody")),!r&&e.nodeName==="xul:treeitem"&&(e.setAttribute("container",!0),e.setAttribute("open",!0)),e.querySelector("xul|treechildren")||(!r&&e.nodeName==="xul:treeitem"&&e.parentNode.reflow(),JUL.Designer.parser.createComponent({"tag":"treechildren","parent":e}));var a=t.val();t.showWhat=t.showWhat||this.getFirstChildren(a);var f=this.getId(a);if(n)s=e;else{var l=a[i.classProperty]||i.defaultClass,c=[],h=i.getMembers(a);for(var p=0;p<h.length;p++)f&&this.current.logic[f]&&this.current.logic[f][h[p]]&&typeof this.current.logic[f][h[p]]=="object"?c.push(h[p]):a[h[p]]&&typeof a[h[p]]=="object"&&c.push(h[p]);var d={"tag":"treeitem","id":"node-"+JUL.Designer.state.lastId++,"container":!0,"open":!0,"children":[{"tag":"treerow","children":[{"tag":"treecell","label":i.useTags?(l===i.defaultClass?"":l+":")+a[i.tagProperty]:l},{"tag":"treecell","label":a[i.idProperty]||" "},{"tag":"treecell","label":c.join(", ")}]}]};JUL.Designer.state.map[d.id]=t,s=JUL.Designer.parser.create(d,null,e.querySelector("xul|treechildren"))}f&&this.current.logic[f]&&this.current.logic[f][t.showWhat]&&typeof this.current.logic[f][t.showWhat]=="object"&&(a=this.current.logic[f]);if(a[t.showWhat]&&typeof a[t.showWhat]=="object"){var v=JUL.typeOf(a[t.showWhat]),m=[].concat(a[t.showWhat]);for(var g=0;g<m.length;g++){var y=null;v==="Array"?y=new JUL.Ref({"ref":a[t.showWhat],"key":g,"parent":new JUL.Ref({"ref":a,"key":t.showWhat})}):y=new JUL.Ref({"ref":a,"key":t.showWhat}),this.buildTree(s,y,!1,!0)}}else s.setAttribute("container",!1);!r&&e.nodeName==="xul:treeitem"&&this.setCellLabel(e,"members");if(!r)return s},"cancel":function(){this.state.newProject=null,JUL.Designer.panels.project.hide(),JUL.Designer.state.lastDialog=null},"changeMember":function(e,t,n){var r=JUL.trim(ample.getElementById("textbox-designer-name").getAttribute("value")),i=this.getExclude();if(!r||r===e||typeof this.currentConfig[r]!="undefined"||i.indexOf(r)>-1||i.indexOf(e)>-1||ample.query("#listbox-designer-"+t+">xul|listbody xul|listcell[label="+r+"]").length)return ample.getElementById("textbox-designer-name").setAttribute("value",e),!1;var s=!1;if(typeof this.currentConfig[e]!="undefined"){this.state.clipboard.undo={"operation":"changeMembers","owner":this.currentConfig,"items":{},"del":[],"show":JUL.Designer.getWhere(this.currentNode),"tabIndex":ample.getElementById("tabbox-designer-members").selectedIndex},this.state.clipboard.undo.del.push(r),this.state.clipboard.undo.items[e]=this.currentConfig[e],this.currentConfig[r]=this.currentConfig[e];var o=JUL.Designer.getWhere(n.childNodes[1].firstChild);o.field.required?this.currentConfig[e]=o.field.defaultValue:delete this.currentConfig[e],s=!0}s&&this.save(!0,!0),JUL.Designer.state.map[n.getAttribute("id")]=r,n.firstChild.setAttribute("label",r);var u=n.childNodes[1].firstChild.getAttribute("id");return JUL.Designer.state.map[u].key(r),JUL.Designer.state.map[u].field.label=r,JUL.Designer.state.map["button-code-"+u].key(r),JUL.Designer.state.map["button-code-"+u].field.label=r,ample.getElementById("button-code-"+u).setAttribute("tooltiptext",JUL.Designer.state.map[u].field.template?r+": "+JUL.Designer.state.map[u].field.template:r),ample.getElementById("listbox-designer-"+t).clearSelection(),r},"changeType":function(e){var t=JUL.Designer.getWhere(this.currentNode),n=t.val(),r=this.getId(n);r&&this.current.logic[r]&&this.current.logic[r][t.showWhat]&&typeof this.current.logic[r][t.showWhat]=="object"&&(n=this.current.logic[r]);if(!n[t.showWhat]||JUL.typeOf(n[t.showWhat])===e)return;if(e==="Object"&&JUL.typeOf(n[t.showWhat])==="Array"){if(n[t.showWhat].length>1){ample.getElementById("menulist-designer-members-type").setAttribute("value","Array"),window.alert("Please reduce the array to at most one element");return}var i=null;n[t.showWhat].length&&(this.state.clipboard.undo={"operation":"changeType","target":n,"what":t.showWhat,"toArray":!1,"show":this.findPath(t.val())},n[t.showWhat]=n[t.showWhat][0],i=JUL.Designer.getWhere(this.currentNode.querySelector("xul|treechildren").firstChild),i.ref(n,t.showWhat),delete i.parent,this.save(!0,!0))}e==="Array"&&JUL.typeOf(n[t.showWhat])==="Object"&&(this.state.clipboard.undo={"operation":"changeType","target":n,"what":t.showWhat,"toArray":!0,"show":this.findPath(t.val())},n[t.showWhat]=[n[t.showWhat]],i=JUL.Designer.getWhere(this.currentNode.querySelector("xul|treechildren").firstChild),i.ref(n[t.showWhat],0),i.parent=new JUL.Ref({"ref":n,"key":t.showWhat}),this.save(!0,!0))},"changeWhere":function(e){var t=JUL.Designer.getWhere(this.currentNode),n="ui",r=t.val(),i=this.getId(r);i&&this.current.logic[i]&&this.current.logic[i].hasOwnProperty(t.showWhat)&&(n="logic");if(e===n)return;var s=JUL.typeOf(r[t.showWhat])==="Array",o=null,u=null;if(e==="logic"&&n==="ui"){if(!i){ample.getElementById("menulist-designer-members-where").setAttribute("value","ui"),window.alert("The component must have an ID or a binding ID");return}if(!r[t.showWhat])return;this.state.clipboard.undo={"operation":"changeWhere","where":t,"what":t.showWhat,"toLogic":!0,"show":this.findPath(t.val())},this.current.logic[i][t.showWhat]=r[t.showWhat],delete r[t.showWhat],o=this.currentNode.querySelector("xul|treechildren").firstChild;while(o)u=JUL.Designer.getWhere(o),s?u.parent.ref(this.current.logic[i]):u.ref(this.current.logic[i]),o=o.nextSibling;this.save(!0,!0)}if(e==="ui"&&n==="logic"){this.state.clipboard.undo={"operation":"changeWhere","where":t,"what":t.showWhat,"toLogic":!1,"show":this.findPath(t.val())},r[t.showWhat]=this.current.logic[i][t.showWhat],delete this.current.logic[i][t.showWhat],o=this.currentNode.querySelector("xul|treechildren").firstChild;while(o)u=JUL.Designer.getWhere(o),s?u.parent.ref(r):u.ref(r),o=o.nextSibling;this.save(!0,!0)}},"checkSave":function(e,t){return this.state.notSaved&&window.confirm("Project not saved. Do you want to save it now?")?(e&&(this.state.pending=e),t&&(this.state.pendingArg=t),this.state.currentOperation="save",this.save(),!0):!1},"cleanConfig":function(e){var t=this.currentParser;if(!t)return;var n=t.getMembers(e);JUL.Designer.keySort(e,[].concat(this.current.listenersProperty,n),[t.classProperty,t.tagProperty,t.idProperty,t.bindingProperty,t.instantiateProperty],!0);var r=this.getId(e),i=this.getTarget(e,r);i[this.current.listenersProperty]&&(JUL.Designer.isEmpty(i[this.current.listenersProperty])?delete i[this.current.listenersProperty]:JUL.Designer.keySort(i[this.current.listenersProperty],null,null,!0)),i!==e&&(JUL.Designer.isEmpty(i)?delete this.current.logic[r]:JUL.Designer.keySort(i,[].concat(this.current.listenersProperty,n),[t.classProperty,t.tagProperty,t.idProperty,t.bindingProperty,t.instantiateProperty],!0))},"cleanTree":function(e,t){e=e||this.current.ui,t=t||this.current.logic;var n={"ui":null,"logic":null};if(!e)return n;n.logic=JUL.Designer.keySort(t);var r=this.currentParser,i=this.current.listenersProperty,s=function(e){var t=r.getMembers(e);e=JUL.Designer.keySort(e,[].concat(i,t),[r.classProperty,r.tagProperty,r.idProperty,r.bindingProperty,r.instantiateProperty]),e[r.classProperty]===r.defaultClass&&delete e[r.classProperty];var o=this.getId(e,r),u=this.getTarget(e,o,n.logic,r);u[i]&&(JUL.Designer.isEmpty(u[i])?delete u[i]:u[i]=JUL.Designer.keySort(u[i])),u!==e&&(JUL.Designer.isEmpty(u)?delete n.logic[o]:n.logic[o]=JUL.Designer.keySort(u,[].concat(i,t),[r.classProperty,r.tagProperty,r.idProperty,r.bindingProperty,r.instantiateProperty])),!this.current.keepBindings&&(e[r.idProperty]||o&&!n.logic[o])&&delete e[r.bindingProperty];for(var a=0;a<t.length;a++){var f=t[a];u=null,o&&n.logic[o]&&n.logic[o][f]&&typeof n.logic[o][f]=="object"?u=n.logic[o]:e[f]&&typeof e[f]=="object"&&(u=e);if(!u)continue;var l=JUL.typeOf(u[f]);if(l==="Array"){var c=[];for(var h=0;h<u[f].length;h++)c[h]=s.call(this,u[f][h]);u[f]=c}else l==="Object"&&(u[f]=s.call(this,u[f]))}return e};return n.ui=JUL.typeOf(e)==="Array"?e.map(s,this):s.call(this,e),JUL.Designer.isEmpty(n.logic)&&(n.logic=null),n},"close":function(){if(!this.state.pending&&this.checkSave("close"))return;this.onSelectNode(null),this.removeTree(),this.current={},this.onSwitchCurrent(!0)},"copy":function(e,t,n,r,i){var s={},o=null;if(t){r=r||this.current.logic;var u=this.current.logic;o=this.currentParser}var a=function(e,t){if(!e||typeof e!="object")return e;var f=JUL.typeOf(e),l;if(f==="Array"){l=[];for(var c=0;c<e.length;c++)l.push(a(e[c],t));return l}if(f==="Object"){l={};var h=!1,p=t?JUL.Designer.designer.getId(e,o):!1,d=t?o.getMembers(e):null;t&&n&&p&&(!e[o.idProperty]&&!JUL.Designer.designer.current.noLogic||u[p])&&(h=(o.useTags?e[o.tagProperty]:e[o.classProperty]||o.defaultClass)+"-"+JUL.Designer.designer.current.lastComponentId++);for(var v in e)e.hasOwnProperty(v)&&(l[v]=a(e[v],t&&d.indexOf(v)>-1));if(t){p&&r[p]&&(s[p]=a(r[p],!0)),h&&(delete l[o.idProperty],l[o.bindingProperty]=h,s[p]&&(s[h]=s[p],delete s[p]));if(i){var m=l[o.classProperty]||o.defaultClass;i[m]&&i[m]!==m&&(l[o.classProperty]=i[m])}}return l}return e};if(t){var f={"ui":a(e,!0)};return f.logic=s,f}return a(e)},"createXml":function(e){if(!e)return null;var t=(e[this.classProperty]+(this.useTags?":"+e[this.tagProperty]:"")).split(":");t.length>2&&(t=[t.shift()].concat(t.join(":")));var n=(JUL.Designer.designer.current.parserConfig._otherProperties||{}).referencePrefix;typeof n=="undefined"&&(n=JUL.UI.referencePrefix);if(n){var r=t[t.length-1];r.substr(0,n.length)===n&&(t[t.length-1]=JUL.trim(r.substr(n.length)))}var i=t.length>1&&this.xmlDoc.createElementNS?this.xmlDoc.createElementNS(this.xmlNS[t[0]]||null,t[0]===this.defaultClass?t[1]:t.join(":")):this.xmlDoc.createElement(t.length>1&&t[0]===this.defaultClass?t[1]:t.join(":"));if(!i)return null;var s=this.getMembers(e);for(var o in JUL.Designer.keySort(e,null,["type",this.idProperty,this.cssProperty,"style"]))if(e.hasOwnProperty(o)&&s.indexOf(o)<0&&[this.listenersProperty,this.htmlProperty,this.textProperty,this.tagProperty,this.classProperty,this.parentProperty].indexOf(o)<0){var u=o.split(":");u.length>2&&(u=[u.shift()].concat(u.join(":"))),u[u.length-1]===this.cssProperty&&(u[u.length-1]="class");var a=["Array","Date","Function","Object","Null","RegExp"].indexOf(JUL.typeOf(e[o]))>-1?this.obj2str(e[o]):e[o].toString();u.length>1&&i.setAttributeNS?i.setAttributeNS(this.xmlNS[u[0]]||null,u[0]===this.defaultClass?u[1]:u.join(":"),a):i.setAttribute(u.length>1&&u[0]===this.defaultClass?u[1]:u.join(":"),a)}if(this.exportListeners&&e[this.listenersProperty]&&typeof e[this.listenersProperty]=="object"){var f=e[this.listenersProperty];for(o in JUL.Designer.keySort(f))if(f.hasOwnProperty(o)){var l=[].concat(f[o]);for(var c=0;c<l.length;c++){var h=["Array","Date","Function","Object","Null","RegExp"].indexOf(JUL.typeOf(l[c]))>-1?JUL.Designer.parser.obj2str(l[c]):l[c].toString();this.stripFunction&&typeof l[c]=="function"&&(h=h.slice(h.indexOf("{")+1,h.lastIndexOf("}")),JUL.trim(h).split("\n").length<2&&(h=JUL.trim(h))),i.setAttribute(this.listenerPrefix+o,h)}}}typeof e[this.textProperty]!="undefined"&&i.appendChild(this.xmlDoc.createTextNode(e[this.textProperty]));if(typeof e[this.htmlProperty]!="undefined"){var p=JUL.Designer.state._xmlDiv=JUL.Designer.state._xmlDiv||window.document.createElement("div");p.innerHTML=e[this.htmlProperty].toString().replace(/<(\s|\S)+?>/g," ").replace(/\x20+/g," ");var d=this.xmlDoc.createTextNode(p.textContent||p.innerText||"");p.innerHTML="",i.appendChild(d)}return e[this.parentProperty]&&typeof e[this.parentProperty]=="object"&&e[this.parentProperty].appendChild(i),i},"del":function(){if(!this.current.ns){window.alert("There is no current project");return}if(!window.confirm("Are you sure to permanently delete '"+this.current.title+"' project?"))return;ample.get("assets/alter.txt",{"ts":(new Date).getTime()},function(e){e=JSON.parse(e),e.error?window.alert(e.error):(JUL.Designer.designer.state.notSaved=!1,JUL.Designer.designer.close())})},"downloadUrl":function(){return"#"},"fillComponentLists":
function(e,t){var n=this.currentParser;this.initConfig(e);var r=this.getId(e),i={},s={},o={};i[n.classProperty]={"tooltip":"Component class","required":!0,"defaultValue":n.defaultClass},n.useTags&&(i[n.tagProperty]={"tooltip":"Component tag","required":!0,"defaultValue":""}),i[n.idProperty]={"tooltip":"Component ID"},this.current.noLogic||(i[n.bindingProperty]={"tooltip":"Component binding ID"}),typeof e[n.instantiateProperty]!="undefined"&&(i[n.instantiateProperty]={"tooltip":"Config node instantiation members"});var u,a=null,f=null,l=this.getExclude(n,e);if(JUL.Designer.framework.current.components){var c=this.findComponent(e);if(c){a=JUL.Designer.framework.getInherited(c,"members")||{};for(u in JUL.Designer.keySort(a))a.hasOwnProperty(u)&&l.indexOf(u)<0&&!a[u].hidden&&(r&&this.current.logic[r]&&a[u].logic?s[u]=a[u]:i[u]=a[u],a[u].required&&(!a[u].logic||!r||!this.current.logic[r])&&typeof e[u]=="undefined"&&(e[u]=a[u].defaultValue),a[u].required&&a[u].logic&&r&&this.current.logic[r]&&typeof this.current.logic[r][u]=="undefined"&&(this.current.logic[r][u]=a[u].defaultValue));f=JUL.Designer.framework.getInherited(c,"events")||{};for(u in JUL.Designer.keySort(f))f.hasOwnProperty(u)&&!f[u].hidden&&(o[u]=f[u])}}for(u in JUL.Designer.keySort(e))e.hasOwnProperty(u)&&l.indexOf(u)<0&&(!a||!a[u]||a[u].hidden||r&&this.current.logic[r]&&a[u].logic)&&(i[u]={"tooltip":"Custom ui member"});var h=this.getTarget(e,r);if(h!==e)for(u in JUL.Designer.keySort(h))h.hasOwnProperty(u)&&l.indexOf(u)<0&&(!a||!a[u]||a[u].hidden||!a[u].logic)&&(s[u]={"tooltip":"Custom logic member"});for(u in JUL.Designer.keySort(h[this.current.listenersProperty]))if(h[this.current.listenersProperty].hasOwnProperty(u)&&l.indexOf(u)<0&&(!f||!f[u])||f[u].hidden)o[u]={"tooltip":"Custom event"};t||(JUL.Designer.empty(ample.getElementById("listbox-designer-ui").body),JUL.Designer.empty(ample.getElementById("listbox-designer-logic").body),JUL.Designer.empty(ample.getElementById("listbox-designer-listeners").body)),JUL.Designer.fillListbox("listbox-designer-ui",i,e),JUL.Designer.fillListbox("listbox-designer-logic",s,h),JUL.Designer.fillListbox("listbox-designer-listeners",o,h[this.current.listenersProperty]);var p=ample.getElementById("tabbox-designer-members").selectedIndex,d=p?p<2?"logic":"listeners":"ui";switch(d){case"ui":this.currentConfig=e;break;case"logic":this.currentConfig=h;break;case"listeners":this.currentConfig=h[this.current.listenersProperty]}},"fillInterface":function(){this.removeTree(),ample.getElementById("menulist-designer-members").setAttribute("value",""),ample.getElementById("menulist-designer-members-type").setAttribute("value",""),ample.getElementById("menulist-designer-members-where").setAttribute("value",""),this.setMembersMenu(),this.current.ns&&this.buildTree(),ample.getElementById("tree-interface").reflow()},"filterMembers":function(e){if(!this.current.ns)return;var t=e?e.val():null,n=t?this.findComponent(t):null,r=n?JUL.Designer.framework.getInherited(n,"members")||{}:{},i=n&&n.members?n.members:{},s=this.currentParser.getMembers(t),o=[];for(var u=n?0:2;u<3;u++){for(var a=0;a<s.length;a++){var f=s[a];if(!u&&i.hasOwnProperty(f)||u===1&&r.hasOwnProperty(f)&&!i.hasOwnProperty(f)){var l={"tag":"menuitem","label":f,"value":f};!u&&i[f].description&&(l.tooltiptext=i[f].description),u===1&&r[f].description&&(l.tooltiptext=r[f].description),o.push(l)}u===2&&!r.hasOwnProperty(f)&&o.push({"tag":"menuitem","label":f,"value":f,"style":"font-style:italic"})}u===1&&o.length&&o.length<s.length&&o.push({"tag":"menuseparator"})}var c=ample.getElementById("menulist-designer-members").querySelector("xul|menupopup");JUL.Designer.empty(c);for(a=0;a<o.length;a++)c.appendChild(JUL.Designer.parser.create(o[a]))},"findComponent":function(e){var t=JUL.Designer.framework.current.components;if(!t)return null;var n=this.currentParser,r=JUL.Designer.framework.current.nsAlias||JUL.Designer.framework.current.ns,i=e[n.classProperty]||n.defaultClass;if(n.useTags&&i===r)return t[e[n.tagProperty]];if(!n.useTags){if(!JUL.Designer.framework.current.prependNS)return t[i];var s=r+".";if(i.substr(0,s.length)===s)return t[i.substr(s.length)]}return null},"findPath":function(e,t,n,r){n||(n=this.current.ui),r||(r=this.current.logic);if(!n)return!1;var i=[],s=typeof e=="function",o=JUL.typeOf(n)==="Array";if(s){if(!o&&e(n,i))return""}else{if(!t&&n===e)return"";if(t&&n[t]===e)return""}var u=this.currentParser,a=function(n,o){if(!n)return!1;if(s){if(e(n,i))return!0}else{if(!t&&n===e)return!0;if(t&&n[t]===e)return!0}var f=u.getMembers(n),l=JUL.Designer.designer.getId(n);for(var c=0;c<f.length;c++){i[o]=f[c];var h=n[f[c]];l&&r[l]&&r[l][f[c]]&&(h=r[l][f[c]]);if(h){i.length=o+1;if(JUL.typeOf(h)==="Array")for(var p=0;p<h.length;p++){i[o+1]=p;if(h[p]&&a(h[p],o+2))return!0}else if(a(h,o+1))return!0}}return i.length=o,!1};if(o){for(var f=0;f<n.length;f++){i=[f];if(a(n[f],1))return i.join(".")}return!1}return a(n,0)?i.join("."):!1},"formatXml":function(e){var t=/(>)(<)(\/*)/g,n=/ *(.*) +\n/g,r=/(<.+>)(.+\n)/g;e=e.replace(t,"$1\n$2$3").replace(n,"$1\n").replace(r,"$1\n$2");var i="",s=e.split("\n"),o=0,u="other",a={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0};for(var f=0;f<s.length;f++){var l=s[f],c=Boolean(l.match(/<.+\/>/)),h=Boolean(l.match(/<\/.+>/)),p=Boolean(l.match(/<[^!].*>/)),d=c?"single":h?"closing":p?"opening":"other",v=u+"->"+d;u=d;var m="";o+=a[v];for(var g=0;g<o;g++)m+="	";v==="opening->closing"?i=i.substr(0,i.length-1)+l+"\n":i+=m+l+"\n"}return i},"getExclude":function(e,t){e=e||this.currentParser,!t&&this.currentNode&&(t=JUL.Designer.getWhere(this.currentNode).val());var n=e.getMembers(t).concat(this.current.listenersProperty,e.classProperty,e.idProperty,e.bindingProperty,e.instantiateProperty);return e.useTags&&n.push(e.tagProperty),e.topDown&&n.push(e.parentProperty),n},"getFirstChildren":function(e){var t=this.getId(e),n=t?this.current.logic[t]:!1,r=this.currentParser.getMembers(e),i=this.findComponent(e),s=[];for(var o=i&&i.members?0:1;o<2;o++)for(var u=0;u<r.length;u++){var a=r[u];if(e[a]||n&&n[a])if(o||i.members.hasOwnProperty(a))return a;!o&&i.hasOwnProperty(a)&&s.push(a)}return s.concat(r)[0]},"getFrom":function(e,t,n){t||(t=this.current.ui),n||(n=this.current.logic);if(!t)return this._undef;if(e==="")return t;var r=e.split("."),i=t,s="";while(r.length){s=r.shift();if(JUL.typeOf(i==="Object")){var o=this.getId(i);o&&n[o]&&n[o][s]&&(i=n[o])}if(typeof i[s]=="undefined")return i[s];i=i[s]}return i},"getId":function(e,t){return t=t||this.currentParser,e[t.idProperty]||e[t.bindingProperty]},"getSelection":function(e){var t=[];for(var n=0;n<e.length;n++){var r=e.item(n).parentNode,i=!0;while(r&&r.nodeName!=="xul:treebody"){if(e.$indexOf(r)>-1){i=!1;break}r=r.parentNode}i&&t.push(e.item(n))}return t},"getTarget":function(e,t,n,r){return r=r||this.currentParser,t=t||this.getId(e,r),n=n||this.current.logic,t&&n[t]?n[t]:e},"initConfig":function(e){var t=this.getId(e);t&&!this.current.noLogic&&!this.current.logic[t]&&!e[this.current.listenersProperty]&&(this.current.logic[t]={});var n=this.getTarget(e,t);n[this.current.listenersProperty]||(n[this.current.listenersProperty]={})},"onBindingUpdated":function(e){var t=e.val();if(t===e.oldValue)return;if(t&&typeof this.current.logic[t]!="undefined"){typeof e.oldValue=="undefined"?e.del():e.val(e.oldValue),ample.getElementById(e.field.id).setAttribute("value",e.oldValue||"");return}var n=e.ref()[this.currentParser.idProperty];this.swapLogic(null,n||t,n||e.oldValue)},"onCellClick":function(){if(!JUL.Designer.framework.current.components)return;if(!this.currentNode)return;var e=JUL.Designer.getWhere(this.currentNode),t=e.val(),n=this.findComponent(t);if(!n)return;var r=this.findPath(t),i=this.getFrom(this.current.ns,document.getElementById("iframe-test").contentWindow);if(!i)return;var s=this.getFrom(r,i.ui,i.logic);if(!s)return;var o=JUL.Designer.framework.getInheritedProperty(n,"getBoundingRect");try{typeof o=="string"&&typeof s._instance[o]=="function"?this.showSelect(s._instance[o]()):typeof (o=JUL.get(o))=="function"?this.showSelect(o.call(s._instance)):typeof (o=JUL.get(JUL.Designer.framework.current.getBoundingRect))=="function"&&JUL.Designer.designer.showSelect(o.call(s._instance))}catch(u){}},"onClassUpdated":function(e){if(e.val()===e.oldValue)return;this.setCellLabel(this.currentNode,"name"),this.state.selectTimer&&clearTimeout(this.state.selectTimer),this.state.selectTimer=setTimeout(function(){var e=JUL.Designer.designer;delete e.state.selectTimer,e.onSelectNode(JUL.Designer.designer.currentNode)},100)},"onConfigUpdated":function(e){if(e.val()===e.oldValue)return;this.state.clipboard.undo={"operation":"changeMembers","owner":e.ref(),"items":{},"del":[],"show":JUL.Designer.getWhere(this.currentNode),"tabIndex":ample.getElementById("tabbox-designer-members").selectedIndex},typeof e.oldValue=="undefined"?this.state.clipboard.undo.del.push(e.key()):this.state.clipboard.undo.items[e.key()]=e.oldValue,this.save(!0,!0);var t=this.currentParser;([t.classProperty,t.idProperty,t.bindingProperty,t.classProperty,t.instantiateProperty].indexOf(e.key())>-1||t.useTags&&e.key()===t.tagProperty)&&ample.getElementById(e.field.id).blur()},"onCopyMembers":function(e,t){var n=ample.getElementById("tabbox-designer-members").selectedIndex,r=n?n<2?"logic":"listeners":"ui",i=ample.getElementById("listbox-designer-"+r).selectedItems;if(!i.length){window.alert("Please select some items");return}t||(this.state.clipboard.contentMembers={}),e&&(this.state.clipboard.undo={"operation":"changeMembers","owner":this.currentConfig,"items":{},"del":[],"show":JUL.Designer.getWhere(this.currentNode),"tabIndex":n});var s,o=this.getExclude();for(var u=0;u<i.length;u++)s=JUL.Designer.getWhere(i.item(u).childNodes[1].firstChild),s&&typeof s.val()!="undefined"&&(t||(this.state.clipboard.contentMembers[s.key()]=this.copy(s.val())),e&&o.indexOf(s.key())<0&&(this.state.clipboard.undo.items[s.key()]=s.val(),s.field.required?s.val(s.field.defaultValue):s.del())),e&&o.indexOf(s.key())<0&&JUL.Designer.empty(i.item(u),!0);t||delete this.state.clipboard.pasteFilter;if(!e)return;JUL.Designer.isEmpty(this.state.clipboard.undo.items)?delete this.state.clipboard.undo:this.save(!0,!0)},"onCopyNode":function(e,t){var n=this.getSelection(ample.getElementById("tree-interface").selectedItems);if(!n.length){window.alert("Please select some components");return}var r=JUL.Designer.getWhere(this.currentNode);this.removeConfigListeners(r.val()),this.cleanConfig(r.val());var i=[];t||(this.state.clipboard.contentNodes=[]);for(var s=0;s<n.length;s++)r=JUL.Designer.getWhere(n[s]),i[s]=this.copy(r.val(),!0),t||this.state.clipboard.contentNodes.push(i[s]);t||(delete this.state.clipboard.pasteStart,delete this.state.clipboard.pasteEnd,delete this.state.clipboard.mapClass);if(!e){r=JUL.Designer.getWhere(this.currentNode),this.fillComponentLists(r.val()),this.addConfigListeners(r.val());return}this.state.clipboard.undo={"operation":"removeNodes","ui":[],"logic":[],"where":[],"wasArray":[],"show":this.findPath(JUL.Designer.getWhere(this.currentNode).val())};for(s=0;s<n.length;s++)this.state.clipboard.undo.ui.push(i[s].ui),this.state.clipboard.undo.logic.push(i[s].logic),r=JUL.Designer.getWhere(n[s]),this.state.clipboard.undo.where.push(r),this.state.clipboard.undo.wasArray.push(JUL.typeOf(r.ref())==="Array");for(s=n.length-1;s>=0;s--)this.removeTree(n[s],!0);if(this.current.ui&&JUL.typeOf(this.current.ui)==="Array"&&this.current.ui.length===1){this.current.ui=this.current.ui[0];var o=JUL.Designer.getWhere(ample.getElementById("tree-interface").querySelector("xul|treechildren").firstChild);o.ref(this.current,"ui"),delete o.parent}this.save(!0,!0),ample.getElementById("tree-interface").reflow()},"onIdUpdated":function(e){var t=e.val();if(t===e.oldValue)return;if(t&&typeof this.current.logic[t]!="undefined"){typeof e.oldValue=="undefined"?e.del():e.val(e.oldValue),ample.getElementById(e.field.id).setAttribute("value",e.oldValue||"");return}this.setCellLabel(this.currentNode,"id");var n=e.ref()[this.currentParser.bindingProperty];this.swapLogic(null,t||n,e.oldValue||n)},"onInstantiateUpdated":function(e){if(e.val()===e.oldValue)return;this.setCellLabel(this.currentNode,"members"),this.showMembers(e.showWhat||this.currentParser.childrenProperty,!0),this.state.selectTimer&&clearTimeout(this.state.selectTimer),this.state.selectTimer=setTimeout(function(){var e=JUL.Designer.designer;delete e.state.selectTimer,e.onSelectNode(JUL.Designer.designer.currentNode)},100)},"onPasteMembers":function(){if(!this.state.clipboard.contentMembers)return;if(!this.currentNode){window.alert("Please elect a component");return}var e=ample.getElementById("tabbox-designer-members").selectedIndex;this.state.clipboard.undo={"operation":"changeMembers","owner":this.currentConfig,"items":{},"del":[],"show":JUL.Designer.getWhere(this.currentNode),"tabIndex":e};var t=this.getExclude();for(var n in this.state.clipboard.contentMembers)this.state.clipboard.contentMembers.hasOwnProperty(n)&&t.indexOf(n)<0&&(!this.state.clipboard.pasteFilter||this.state.clipboard.pasteFilter.indexOf(n)>-1)&&(typeof this.currentConfig[n]=="undefined"?this.state.clipboard.undo.del.push(n):this.state.clipboard.undo.items[n]=this.currentConfig[n],this.currentConfig[n]=this.copy(this.state.clipboard.contentMembers[n]));delete this.state.clipboard.pasteFilter;if(JUL.Designer.isEmpty(this.state.clipboard.undo.items)&&!this.state.clipboard.undo.del.length)delete this.state.clipboard.undo;else{this.save(!0,!0);var r=JUL.Designer.getWhere(this.currentNode);this.fillComponentLists(r.val())}},"onPasteNode":function(){if(!this.current.ns)return;if(!this.state.clipboard.contentNodes)return;var e=typeof this.state.clipboard.pasteStart=="undefined"?0:this.state.clipboard.pasteStart,t=typeof this.state.clipboard.pasteEnd=="undefined"?this.state.clipboard.contentNodes.length-1:this.state.clipboard.pasteEnd;if(t<e)return;this.state.clipboard.undo={"operation":"addNodes","where":[],"logic":[],"show":this.currentNode?this.findPath(JUL.Designer.getWhere(this.currentNode).val()):!1};var n=null,r="",i,s;if(this.currentNode){i=JUL.Designer.getWhere(this.currentNode),s=i.val();var o=this.getId(s);o&&this.current.logic[o]&&ample.getElementById("menulist-designer-members-where").getAttribute("value")==="logic"&&(s=this.current.logic[o])}else i={"showWhat":"ui"},s=this.current;for(var u=e;u<=t;u++){n=this.copy(this.state.clipboard.contentNodes[u].ui,!0,!0,this.state.clipboard.contentNodes[u].logic,this.state.clipboard.mapClass),!s[i.showWhat]&&(!this.current.ui||ample.getElementById("menulist-designer-members-type").getAttribute("Value")==="Object")?(this.state.clipboard.undo.where.push(new JUL.Ref({"ref":s,"key":i.showWhat})),s[i.showWhat]=n.ui):(s[i.showWhat]||(s[i.showWhat]=[]),JUL.typeOf(s[i.showWhat])!=="Array"&&(s[i.showWhat]=[s[i.showWhat]],this.state.clipboard.undo.toArray=!0,this.currentNode&&ample.getElementById("menulist-designer-members-type").setAttribute("value","Array")),this.state.clipboard.undo.where.push(new JUL.Ref({"ref":s[i.showWhat],"key":s[i.showWhat].length,"parent":new JUL.Ref({"ref":s,"key":i.showWhat})})),s[i.showWhat].push(n.ui));for(r in n.logic)n.logic.hasOwnProperty(r)&&(this.state.clipboard.undo.logic.push(r),this.current.logic[r]=n.logic[r])}delete this.state.clipboard.pasteStart,delete this.state.clipboard.pasteEnd,delete this.state.clipboard.mapClass,this.currentNode?(this.removeTree(this.currentNode,!1,!0),this.buildTree(this.currentNode,i,!0)):(this.removeTree(),this.buildTree()),this.save(!0,!0),ample.getElementById("tree-interface").reflow()},"onSelectNode":function(e){if(this.currentNode){var t=JUL.Designer.getWhere(this.currentNode),n=t.val();n&&(this.removeConfigListeners(n),this.cleanConfig(n))}ample.getElementById("menulist-designer-members").setAttribute("value",""),ample.getElementById("menulist-designer-members-type").setAttribute("value",""),ample.getElementById("menulist-designer-members-where").setAttribute("value",""),JUL.Designer.empty(ample.getElementById("listbox-designer-ui").body),JUL.Designer.empty(ample.getElementById("listbox-designer-logic").body),JUL.Designer.empty(ample.getElementById("listbox-designer-listeners").body),ample.query(ample.getElementById("tabbox-designer-members").querySelector("xul|tabs").childNodes[1]).show(),ample.getElementById("tabbox-designer-members").querySelector("xul|tabs").childNodes[e&&this.state.showTab?this.state.showTab:0].$activate(),e&&delete this.state.showTab,this.currentNode=e;if(e){var r=JUL.Designer.getWhere(e),i=r.val();this.setMembersMenu(i),JUL.Designer.framework.fillScrollbox(i);var s=this.getId(i),o=i[r.showWhat];s&&this.current.logic[s]&&this.current.logic[s][r.showWhat]&&typeof this.current.logic[s][r.showWhat]=="object"&&(o=this.current.logic[s][r.showWhat]),ample.getElementById("menulist-designer-members").setAttribute("value",r.showWhat),ample.getElementById("menulist-designer-members-type").setAttribute("value",o?JUL.typeOf(o):"Array"),ample.getElementById("menulist-designer-members-where").setAttribute("value",s&&this.current.logic[s]&&this.current.logic[s][r.showWhat]&&typeof this.current.logic[s][r.showWhat]=="object"?"logic":"ui"),JUL.Designer.state.lastDialog=null,this.fillComponentLists(i,!0),this.addConfigListeners(i),this.filterMembers(r)}else this.currentConfig=null,this.setMembersMenu(),JUL.Designer.framework.fillScrollbox(),this.filterMembers();ample.query(ample.getElementById("tabbox-designer-members").querySelector("xul|tabs").childNodes[1])[s&&this.current.logic[s]?"show":"hide"]()},"onSwitchCurrent":function(e){delete this.state._xmlOptions,delete this.state.clipboard.undo,this.state.notSaved=!1,this.currentParser=this.current.ns?new JUL.UI.Parser(JUL.apply(JUL.apply({},this.current.parserConfig),this.current.parserConfig._otherProperties||{},!0)):null,ample.getElementById("deck-test").setAttribute("selectedIndex",e?1:0),this.setTitle(),ample.getElementById("anchor-test").setAttribute("href",this.current.ns?this.testUrl():"#"),ample.getElementById("anchor-download").setAttribute("href",this.current.ns?this.downloadUrl():"#"),ample.getElementById("command-no-logic").setAttribute("checked",this.current.noLogic||!1),this.test(),this.fillInterface(),JUL.Designer.state.oTestWnd&&!JUL.Designer.state.oTestWnd.closed&&JUL.Designer.state.oTestWnd.close(),JUL.Designer.app.current.ns&&(ample.getElementById("anchor-test-app").setAttribute("href",JUL.Designer.app.testUrl()),JUL.Designer.state.oTestAppWnd&&!JUL.Designer.state.oTestAppWnd.closed&&JUL.Designer.state.oTestAppWnd.close(),JUL.Designer.app.fillMenupopup(!0));if(e)return;this.current.suggestedFramework&&this.current.suggestedFramework!==JUL.Designer.framework.current.ns&&JUL.Designer.framework.open(this.current.suggestedFramework)},"onTestClick":function(e){var t=JUL.get(JUL.Designer.framework.current.getBoundingRect),n={},r=[],i=function(i,s){var o=JUL.Designer.designer.findComponent(i);if(!o)return!1;var u=null,a=JUL.Designer.framework.getInheritedProperty(o,"getBoundingRect");try{typeof a=="string"&&typeof i._instance[a]=="function"?u=i._instance[a]():typeof (a=JUL.get(a))=="function"?u=a.call(i._instance):typeof t=="function"&&(u=t.call(i._instance))}catch(f){}if(u&&e.x>=u.left&&e.x<=u.left+u.width&&e.y>=u.top&&e.y<=u.top+u.height){var l=(1e10-1-(u.zIndex||0)).toFixed(0)+":"+(1e8+u.width*u.height).toFixed(0)+":"+(1e6-1-r.length).toFixed(0);n[l]={"rect":u,"path":s.join(".")},r.push(l)}return!1},s=this.getFrom(this.current.ns,document.getElementById("iframe-test").contentWindow);this.findPath(i,null,s.ui,s.logic);if(!r.length)return;r.sort(),this.showSelect(n[r[0]].rect,!0),this.showPath(n[r[0]].path)},"onTestLoad":function(){if(!JUL.Designer.designer.current.ns)return;var e=document.getElementById("iframe-test");JUL.Designer.addListener(e.contentDocument||e.contentWindow.document,"click",function(e){var t=JUL.Designer.state._lastFocus;if(t){var n=ample.getElementById(t);n&&n.blur()}if(!JUL.Designer.framework.current.components)return;e=e||event;var r={"x":e.clientX,"y":e.clientY};setTimeout(function(){JUL.Designer.designer.onTestClick(r)},100)},!0)},"open":function(e,t){delete this.state.clipboard.undo,ample.get("assets/projects/"+e.split(".").join("/")+".txt",{"ts":(new Date).getTime()},function(e){var n=JUL.Designer.designer,r=JSON.parse(e,JUL.makeCaller(JUL.Designer.parser,JUL.Designer.jsonReviver));if(r.error){r.error.indexOf("not found")>-1&&t?(n.show("new",n.state.initProject),delete n.state.initProject):window.alert(r.error);return}JUL.Designer.makeCompat(r,e),JUL.Designer.panels.browse.hide(),n.onSelectNode(),n.removeTree(),n.current=r.result,n.state.currentOperation="getJS",n.save(!0),n.onSwitchCurrent()})},"refreshXml":function(){JUL.apply(this.state._xmlOptions,{"cssProperty":JUL.trim(ample.getElementById("textbox-xml-css").getAttribute("value"))||JUL.UI.cssProperty,"htmlProperty":JUL.trim(ample.getElementById("textbox-xml-html").getAttribute("value"))||JUL.UI.htmlProperty,"rootWrapper":JUL.trim(ample.getElementById("textbox-xml-wrapper").getAttribute("value"))||"content","listenerPrefix":JUL.trim(ample.getElementById("textbox-xml-listener-prefix").getAttribute("value")),"exportListeners":ample.getElementById("checkbox-xml-export-listeners").getAttribute("checked")==="true","stripFunction":ample.getElementById("checkbox-xml-strip-function").getAttribute("checked")==="true","mergeLogic":ample.getElementById("checkbox-xml-merge-logic").getAttribute("checked")==="true","expandMembers":ample.getElementById("checkbox-xml-expand-members").getAttribute("checked")==="true"}),ample.getElementById("textbox-xml-css").setAttribute("value",this.state._xmlOptions.cssProperty),ample.getElementById("textbox-xml-html").setAttribute("value",this.state._xmlOptions.htmlProperty),ample.getElementById("textbox-xml-wrapper").setAttribute("value",this.state._xmlOptions.rootWrapper),ample.getElementById("textbox-xml").setAttribute("value",this.toXml(this.state._xmlOptions))},"removeConfigListeners":function(e){var t=this.getTarget(e);JUL.Designer.removeValueListener(t[this.current.listenersProperty]),t!==e&&JUL.Designer.removeValueListener(t),JUL.Designer.removeValueListener(e)},"removeMembers":function(e,t,n){var r,i=!1,s=this.getExclude();for(var o=0;o<e.length;o++){r=e[o];if(s.indexOf(r)<0){if(typeof this.currentConfig[r]!="undefined"){var u=JUL.Designer.getWhere(n.get(o).childNodes[1].firstChild);u.field.required?this.currentConfig[r]=u.field.defaultValue:delete this.currentConfig[r],i=!0}JUL.Designer.empty(n.get(o),!0)}}i&&this.save(!0)},"removeTree":function(e,t,n,r){if(!e){e=ample.getElementById("tree-interface").querySelector("xul|treechildren");if(e)while(e.lastChild)this.removeTree(e.lastChild,t,n);return}var i=e.getAttribute("id");if((!n||r)&&e===this.currentNode){var s=JUL.Designer.getWhere(i).val();s&&(this.removeConfigListeners(s),this.cleanConfig(s)),this.currentNode=null,this.currentConfig=null}var o=e.querySelector("xul|treechildren");if(o)while(o.lastChild)this.removeTree(o.lastChild,t,!1,!0);if(t){var u=JUL.Designer.getWhere(i),a=u.val();if(a)if(n)r||(delete a[u.showWhat],this.setCellLabel(e,"members",a));else{var f=this.getId(a);if(!r){if(JUL.typeOf(u.ref())==="Array"){u.ref().splice(u.key(),1);var l=e.nextSibling;while(l)JUL.Designer.getWhere(l).key(JUL.Designer.getWhere(l).key()-1),l=l.nextSibling;u.parent&&!u.ref().length&&u.parent.del()}else u.del();e.parentNode.parentNode.nodeName==="xul:treeitem"&&this.setCellLabel(e.parentNode.parentNode,"members"),this.current.ui||(this.current.lastComponentId=1)}delete this.current.logic[f]}}var c=e.parentNode;n||(JUL.Designer.empty(e,!0),delete JUL.Designer.state.map[i]),r||(n&&o&&e.nodeName==="xul:treeitem"&&(JUL.Designer.empty(o,!0),e.setAttribute("container",!1),e.parentNode.reflow()),!n&&c.nodeName==="xul:treechildren"&&!c.items.length&&(c=c.parentNode,JUL.Designer.empty(c.children,!0),c.nodeName==="xul:treeitem"&&(c.setAttribute("container",!1),c.parentNode.reflow())))},"save":function(e,t){var n=!e&&this.state.currentOperation!=="save"?this.state.newProject:this.current;if(!e&&!JUL.Designer.validNS(n.ns)){window.alert("Invalid namespace");return}if(!e){n.version="1."+(new Date).getTime();if(JUL.Designer.app.current.ns){var r=JUL.Designer.app.current.modules;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i].ns;s.substr(0,1)==="."&&(s=JUL.Designer.app.current.ns+s);if(s===n.ns)break}}}n.ui||(n.ui=null);var o=JUL.apply({},n);o.parserConfig=JUL.apply({"_keepInstance":!0},o.parserConfig),delete o.template,delete o.lastComponentId;if(!e||this.state.currentOperation==="getJS")JUL.Designer.state.code=this.testJs(o);if(e)t||delete this.state.clipboard.undo,this.state.currentOperation!=="getJS"&&(this.state.notSaved=!0,this.state.timerShow&&clearTimeout(this.state.timerShow),this.state.timerShow=setTimeout(function(){var e=JUL.Designer.designer;delete e.state.timerShow,JUL.Designer.state.code=e.testJs(o);var t=document.getElementById("iframe-test").contentWindow.location;t.href=e.testUrl()},200)),this.state.currentOperation="";else{var u=null;this.currentNode&&(u=JUL.Designer.getWhere(this.currentNode),this.removeConfigListeners(u.val()),this.cleanConfig(u.val())),JUL.Designer.applyRequired(this.fields,n),JUL.Designer.applyRequired(this.parserFields,n.parserConfig),n=JUL.Designer.keySort(n,["template","parserConfig","ui","logic"]),n.logic=JUL.Designer.keySort(n.logic);var a=JUL.apply({},n);delete a.ui,delete a.logic,delete a.parserConfig,delete a.init,delete a.noLogic,delete a.lastComponentId;var f={"ts":(new Date).getTime()};u&&(this.fillComponentLists(u.val()),this.addConfigListeners(u.val())),ample.ajax({"url":"assets/alter.txt","type":"GET","async":this.state.currentOperation!=="save","dataType":"text","data":f,"success":function(e){e=JSON.parse(e);if(e.error){window.alert(e.error);return}var t=JUL.Designer.designer;if(t.state.currentOperation==="save"){t.state.notSaved=!1;var n=t.testUrl();ample.getElementById("anchor-test").setAttribute("href",n),ample.getElementById("iframe-test").setAttribute("src",n),ample.getElementById("anchor-download").setAttribute("href",t.downloadUrl());if(t.state.pending){switch(t.state.pending){case"new":t.show("new");break;case"open":t.showBrowse("project");break;case"close":t.close();break;case"open_new":t.open(t.state.pendingArg,!0)}delete t.state.pending,delete t.state.pendingArg}else window.alert("Project saved")}else{JUL.Designer.panels.project.hide(),JUL.Designer.state.lastDialog=null,t.onSelectNode(),t.removeTree(),t.current=t.state.newProject,t.state.newProject=null;var r=JUL.trim(t.state.mapsToModule||"");if(r&&JUL.Designer.app.current.ns){var i=JUL.Designer.app.current.modules,s=t.current.ns,o=JUL.Designer.app.current.ns;s.substr(0,o.length+1)===o+"."&&(s=s.substr(o.length)),i[r]=JUL.apply(i[r]||{},{"ns":s}),JUL.Designer.app.fillMenupopup(),JUL.Designer.app.state.currentOperation="save",JUL.Designer.app.save()}t.onSwitchCurrent()}}})}},"saveCurrent":function(){if(!this.current.ns)return;this.state.currentOperation="save",this.save()},"searchId":function(e){e=JUL.trim(e);if(!e)return;var t=!1,n=[],r=[],i=!1;if(this.currentNode){var s=JUL.Designer.getWhere(this.currentNode);i=this.findPath(s.val())}var o=this.currentParser,u=function(s,u){var a=u.join(".");if(a===i)t=!0;else if(s[o.idProperty]===e||s[o.bindingProperty]===e)t?n.push(a):r.push(a);return!1};this.findPath(u),n=n.concat(r);if(!n.length)return;this.showPath(n[0])},"setCellLabel":function(e,t,n){var r=[].concat(t);if(!n){var i=JUL.Designer.getWhere(e);n=i.val()}var s=this.currentParser,o=this.getId(n);for(var u=0;u<r.length;u++)switch(r[u]){case"name":var a=n[s.classProperty]||s.defaultClass;e.querySelector("xul|treerow").childNodes[0].setAttribute("label",s.useTags?(a===s.defaultClass?"":a+":")+n[s.tagProperty]:a);break;case"id":e.querySelector("xul|treerow").childNodes[1].setAttribute("label",n[s.idProperty]||"");break;case"members":var f=[],l=s.getMembers(n);for(var c=0;c<l.length;c++)o&&this.current.logic[o]&&this.current.logic[o][l[c]]&&typeof this.current.logic[o][l[c]]=="object"?f.push(l[c]):n[l[c]]&&typeof n[l[c]]=="object"&&f.push(l[c]);e.querySelector("xul|treerow").childNodes[2].setAttribute("label",f.join(", "))}},"setMembersMenu":function(e,t){var n=ample.getElementById("menulist-designer-members").querySelector("xul|menupopup");JUL.Designer.empty(n),t=t||this.currentParser;if(t){var r=t.getMembers(e);for(var i=0;i<r.length;i++)n.appendChild(JUL.Designer.parser.createComponent({"tag":"menuitem","label":r[i],"value":r[i],"style":"font-style:italic"}))}},"setTitle":function(){var e,t=JUL.Designer.app.current.title||JUL.Designer.title;ample.getElementById("statusbarpanel-app").setAttribute("label",JUL.Designer.app.current.title||""),ample.getElementById("statusbarpanel-project").setAttribute("label",this.current.title||""),ample.getElementById("statusbarpanel-framework").setAttribute("label",JUL.Designer.framework.current.title||""),this.current.ns?(JUL.Designer.framework.current.ns?e=this.current.title+" - "+JUL.Designer.framework.current.title:e=this.current.title,window.document.title=this.current.title+" - "+t):(JUL.Designer.framework.current.ns?e=JUL.Designer.framework.current.title:e="Project",window.document.title=t),ample.getElementById("label-project").setAttribute("value",e)},"shiftNode":function(e,t){var n=t?e.previousSibling:e,r=t?e:e.nextSibling,i=JUL.Designer.getWhere(n),s=JUL.Designer.getWhere(r);this.state.clipboard.undo={"operation":"shiftNode","prev":i,"next":s,"show":this.findPath((t?s:i).val())};var o=s.val();s.ref().splice(s.key(),1),s.ref().splice(i.key(),0,o);var u=s.key();s.key(i.key()),i.key(u),this.save(!0,!0);var a=e.parentNode;this.removeTree(r,!1,!0),a.removeChild(r),a.insertBefore(r,n),this.buildTree(r,s,!0),ample.getElementById("tree-interface").reflow(),t&&ample.getElementById("tree-interface").selectItem(r)},"show":function(e,t){if(e==="edit"&&!this.current.ns){window.alert("There is no current project");return}if(e==="new"&&!t&&!this.state.pending&&this.checkSave("new"))return;this.state.newProject={"ui":null,"logic":{},"parserConfig":{},"lastComponentId":1};var n=null;delete this.state.mapsToModule;if(e==="new"&&JUL.Designer.app.current.ns&&!t){var r=JUL.Designer.app.current,i="module1",s=2;while(r.modules[i])i="module"+s++;t={"ns":r.ns+"."+i,"title":r.title+" - "+i.substr(0,1).toUpperCase()+i.substr(1),"parserConfig":this.copy(r.defaultParser)},r.preferredFramework&&(t.suggestedFramework=r.preferredFramework),n={"mapsToModule":{"tooltip":"if non-empty, the module with this name will be added or updated to map to this project","template":"<string>"}},this.state.mapsToModule=i}var o=this.state.newProject;e==="new"&&JUL.Designer.framework.current.ns&&(o.suggestedFramework=JUL.Designer.framework.current.ns),t&&JUL.apply(o,t);if(e==="edit")for(var u in this.current)this.current.hasOwnProperty(u)&&(u==="ui"||u==="logic"?o[u]=this.current[u]:o[u]=this.copy(this.current[u]));JUL.Designer.empty(ample.getElementById("listbox-project-settings").body),JUL.Designer.empty(ample.getElementById("listbox-project-parser").body),o.template||(o.template=JUL.Designer.config.defaultTemplate),ample.getElementById("textbox-project-template").setAttribute("value",o.template),JUL.Designer.fillListbox("listbox-project-settings",this.fields,o),n&&JUL.Designer.fillListbox("listbox-project-settings",n,this.state),JUL.Designer.fillListbox("listbox-project-parser",this.parserFields,o.parserConfig),this.state.currentOperation=e,JUL.Designer.panels.project.setAttribute("title",e==="new"?"New project":"Edit project - "+o.title),JUL.Designer.state.lastDialog=JUL.Designer.panels.project,JUL.Designer.panels.project.showModal();var a=JUL.Designer.panels.project.querySelector("xul|tabs");a.firstChild.$activate()},"showBrowse":function(e){if(e==="project"&&!this.state.pending&&this.checkSave("open"))return;JUL.Designer.state.browseType=e,JUL.Designer.fillBrowseList(),JUL.Designer.panels.browse.setAttribute("title","Open "+e.replace("app","application")),JUL.Designer.panels.browse.showModal()},"showClipboard":function(){var e=this.state.clipboard,t=e.contentNodes||[],n=e.contentMembers||{},r={},i="/* Components' UI */\n";for(var s=0;s<t.length;s++)r[s]=t[s].ui;i=i+"["+JUL.Designer.parser.obj2str(r).slice(1,-1)+"]\n",i+="\n/* Components' logic */\n",r={};for(s=0;s<t.length;s++)JUL.apply(r,t[s].logic);i=i+JUL.Designer.parser.obj2str(r)+"\n",ample.getElementById("textbox-clipboard-components").setAttribute("value"
,i),i="/* Members */\n",i=i+JUL.Designer.parser.obj2str(n)+"\n",ample.getElementById("textbox-clipboard-members").setAttribute("value",i),i="* special members ",this.current.ns&&(i=i+" like "+this.getExclude().map(function(e){return"'"+e+"'"}).join(", ")+" "),i+="won't be pasted over",ample.getElementById("description-exclude-paste").setAttribute("value",i),typeof e.pasteStart=="undefined"&&(ample.getElementById("checkbox-paste-range").setAttribute("checked",!1),ample.getElementById("textbox-range-start").setAttribute("value",""),ample.getElementById("textbox-range-end").setAttribute("value",""),ample.getElementById("textbox-range-start").setAttribute("disabled",!0),ample.getElementById("textbox-range-end").setAttribute("disabled",!0)),typeof e.pasteFilter=="undefined"&&(ample.getElementById("checkbox-paste-filter").setAttribute("checked",!1),ample.getElementById("textbox-filter-members").setAttribute("value",""),ample.getElementById("textbox-filter-members").setAttribute("disabled",!0)),typeof e.mapClass=="undefined"&&(ample.getElementById("checkbox-map-class").setAttribute("checked",!1),ample.getElementById("textbox-map-class-from").setAttribute("value",""),ample.getElementById("textbox-map-class-to").setAttribute("value",""),ample.getElementById("textbox-map-class-from").setAttribute("disabled",!0),ample.getElementById("textbox-map-class-to").setAttribute("disabled",!0)),JUL.Designer.panels.clipboard.showModal()},"showJs":function(){if(!this.current.ns)return;var e=this.current,t=null;this.currentNode&&(t=JUL.Designer.getWhere(this.currentNode),this.removeConfigListeners(t.val()),this.cleanConfig(t.val())),JUL.Designer.applyRequired(this.fields,e),JUL.Designer.applyRequired(this.parserFields,e.parserConfig);var n=JUL.Designer.keySort(e,["template","parserConfig","ui","logic"]);n.logic=JUL.Designer.keySort(n.logic),delete n.template,delete n.lastComponentId,ample.getElementById("textbox-js").setAttribute("value",this.testJs(n,!0)),t&&(this.fillComponentLists(t.val()),this.addConfigListeners(t.val()));var r=JUL.Designer.panels.js;r.setAttribute("title",this.current.title+" - JavaScript"),r.showModal(),setTimeout(function(){ample.getElementById("textbox-js").focus()},500)},"showMembers":function(e,t){var n=this.currentParser,r=JUL.Designer.getWhere(this.currentNode),i=r.val(),s=n.getMembers(i);if(s.indexOf(e)<0)return;var o=this.getId(i);if(!t&&e===r.showWhat)return;var u=i[e]?JUL.typeOf(i[e]):"Array";o&&this.current.logic[o]&&this.current.logic[o][e]&&typeof this.current.logic[o][e]=="object"&&(u=JUL.typeOf(this.current.logic[o][e])),ample.getElementById("menulist-designer-members-type").setAttribute("value",u),ample.getElementById("menulist-designer-members-where").setAttribute("value",o&&this.current.logic[o]&&this.current.logic[o][e]&&typeof this.current.logic[o][e]=="object"?"logic":"ui"),this.removeTree(this.currentNode,!1,!0),r.showWhat=e,this.buildTree(this.currentNode,r,!0),ample.getElementById("tree-interface").reflow()},"showPath":function(e,t){var n=this.getFrom(e);if(!n)return;var r=ample.query("#tree-interface>xul|treebody>xul|treechildren");if(!r.length)return;var i=r.get(0),s=null,o=e.length?e.split("."):[];o.length&&JUL.UI._regExps.uint.test(o[0])?(i=i.items.item(parseInt(o[0])),o.shift()):i=i.items.item(0);var u=i;u.setAttribute("open",!0);var a="";while(o.length){a=o.shift(),s=JUL.Designer.getWhere(u),a!==s.showWhat&&(this.removeTree(u,!1,!0),s.showWhat=a,this.buildTree(u,s,!0));if(!o.length){u=u.querySelector("xul|treechildren").items.item(0),u.setAttribute("open",!0);break}a=parseInt(o[0]),isNaN(a)?a=0:o.shift(),u=u.querySelector("xul|treechildren").items.item(a),u.setAttribute("open",!0)}t&&(s=JUL.Designer.getWhere(u)),t&&s.showWhat!==t&&(this.removeTree(u,!1,!0),s.showWhat=t,this.buildTree(u,s,!0)),ample.getElementById("tree-interface").reflow(),u.scrollIntoView(),ample.getElementById("tree-interface").selectItem(u)},"showSelect":function(e,t){var n=document.getElementById("iframe-test"),r=n.contentDocument||n.contentWindow.document;e&&(e=JUL.apply({},e),e.left+=(n.contentWindow||n).pageXOffset||(r.documentElement||r).scrollLeft,e.top+=(n.contentWindow||n).pageYOffset||(r.documentElement||r).scrollTop),ample.getElementById("statusbarpanel-selection").setAttribute("label",e?(typeof e.zIndex=="undefined"?"":e.zIndex.toFixed(0)+": ")+"["+e.left.toFixed(0)+", "+e.top.toFixed(0)+"] -> ["+(e.left+e.width).toFixed(0)+", "+(e.top+e.height).toFixed(0)+"]":"");var i={"top":"line-select-top","left":"line-select-left","bottom":"line-select-bottom","right":"line-select-right"};this.state.hintTimer&&(clearTimeout(this.state.hintTimer),delete this.state.hintTimer);var s;for(var o in i)i.hasOwnProperty(o)&&(s=r.getElementById(i[o]))&&r.body.removeChild(s);if(!e)return;for(o in i)i.hasOwnProperty(o)&&(s=r.createElement("div"),s.setAttribute("id",i[o]),s.style.cssText=s.style.cssText+"position:absolute;z-index:16777271;border:1px solid red;"+(o==="left"||o==="right"?"width:0.1px;":"height:0.1px;")+(o==="left"||o==="right"?"height:"+e.height+"px;":"width:"+e.width+"px;")+(o==="right"?"left:"+(e.left+e.width)+"px;":"left:"+e.left+"px;")+(o==="bottom"?"top:"+(e.top+e.height)+"px;":"top:"+e.top+"px;"),r.body.appendChild(s));if(!t)try{r.getElementById(i.top).scrollIntoView(),r.getElementById(i.left).scrollIntoView()}catch(u){}this.state.hintTimer=setTimeout(function(){delete JUL.Designer.designer.state.hintTimer,ample.getElementById("statusbarpanel-selection").setAttribute("label","");var e;for(var t in i)i.hasOwnProperty(t)&&(e=r.getElementById(i[t]))&&r.body.removeChild(e)},3e3)},"showXml":function(){if(!this.current.ns)return;this.state._xmlOptions=this.state._xmlOptions||{"cssProperty":JUL.UI.cssProperty,"htmlProperty":JUL.UI.htmlProperty,"rootWrapper":"content","exportListeners":!1,"stripFunction":!1,"listenerPrefix":"","mergeLogic":!1,"expandMembers":!1},ample.getElementById("textbox-xml-css").setAttribute("value",this.state._xmlOptions.cssProperty),ample.getElementById("textbox-xml-html").setAttribute("value",this.state._xmlOptions.htmlProperty),ample.getElementById("textbox-xml-wrapper").setAttribute("value",this.state._xmlOptions.rootWrapper),ample.getElementById("checkbox-xml-export-listeners").setAttribute("checked",this.state._xmlOptions.exportListeners),ample.getElementById("checkbox-xml-strip-function").setAttribute("checked",this.state._xmlOptions.stripFunction),ample.getElementById("textbox-xml-listener-prefix").setAttribute("value",this.state._xmlOptions.listenerPrefix),ample.getElementById("checkbox-xml-merge-logic").setAttribute("checked",this.state._xmlOptions.mergeLogic),ample.getElementById("checkbox-xml-expand-members").setAttribute("checked",this.state._xmlOptions.expandMembers),ample.getElementById("textbox-xml").setAttribute("value",this.toXml(this.state._xmlOptions));var e=JUL.Designer.panels.xml;e.setAttribute("title",this.current.title+" - XML layout"),e.showModal(),setTimeout(function(){ample.getElementById("textbox-xml").focus()},500)},"swapLogic":function(e,t,n,r){if(t===n)return;if(!r&&this.current.noLogic&&(!n||!this.current.logic[n]))return;e=e||JUL.Designer.getWhere(this.currentNode);var i=e.val();if(t)if(n&&this.current.logic[n])this.current.logic[t]=this.current.logic[n],delete this.current.logic[n];else{this.current.logic[t]={};var s=this.findComponent(i);if(s){var o=JUL.Designer.framework.getInherited(s,"members")||{};for(var u in JUL.Designer.keySort(o))o.hasOwnProperty(u)&&o[u].logic&&typeof i[u]!="undefined"&&(this.current.logic[t][u]=i[u],delete i[u])}i[this.current.listenersProperty]&&(this.current.logic[t][this.current.listenersProperty]=i[this.current.listenersProperty],delete i[this.current.listenersProperty])}else{if(!n||!this.current.logic[n])return;JUL.apply(i,this.current.logic[n]),delete this.current.logic[n]}if(r)return;this.state.selectTimer&&clearTimeout(this.state.selectTimer),this.state.selectTimer=setTimeout(function(){var e=JUL.Designer.designer;delete e.state.selectTimer,e.onSelectNode(JUL.Designer.designer.currentNode)},100)},"test":function(){if(this.current.ns){var e=this.testUrl(),t=ample.getElementById("iframe-test").getAttribute("src");if(t===e){var n=document.getElementById("iframe-test").contentWindow.location;n.href=e}else ample.getElementById("iframe-test").setAttribute("src",e)}else ample.getElementById("iframe-test").setAttribute("src","about:blank")},"testJs":function(e,t){var n="/* generated by "+JUL.Designer.title+" version "+JUL.Designer.version+" */\n";e.parserConfig=JUL.apply(JUL.apply({},e.parserConfig),e.parserConfig._otherProperties||{},!0);if(t){var r=JUL.Designer.keySort(e);delete r.parserConfig,delete r.ui,delete r.logic;var i=JUL.Designer.keySort(e.parserConfig);delete i._keepInstance,delete i._otherProperties;for(var s in i)i.hasOwnProperty(s)&&typeof JUL.UI[s]!="undefined"&&JSON.stringify(i[s])===JSON.stringify(JUL.UI[s])&&delete i[s];e=this.cleanTree(e.ui,e.logic);var o=[{"suf":"","ref":r,"desc":""},{"suf":".parserConfig","ref":i,"desc":" parser config"},{"suf":".ui","ref":e.ui,"desc":" UI"},{"suf":".logic","ref":e.logic,"desc":" logic"}];n=n+"/* '"+r.title+"' namespace */\n",n=n+"var oProject = jul.ns('"+r.ns+"');\n\n";for(var u=0;u<o.length;u++){var a=o[u];n+=a.suf?"oProject"+a.suf+" =\n":"jul.apply(oProject,\n",n=n+"/* begin '"+r.title+"'"+a.desc+" */\n",n=n+JUL.Designer.parser.obj2str(a.ref)+"\n",n=n+"/* end '"+r.title+"'"+a.desc+" */\n",n=n+(a.suf?"":")")+";\n\n"}}else n=n+"var oProject = jul.ns('"+e.ns+"');\n",n=n+"jul.apply(oProject, "+JUL.Designer.parser.obj2str(e)+");\n";return JUL.Designer.wrapExport(n,t)},"testUrl":function(){return"assets/projects/"+encodeURIComponent(this.current.ns)+".html?"+"version="+encodeURIComponent(this.current.version)},"toXml":function(e){var t='<?xml version="1.0"?>';if(!this.current.ui)return t;e=e||{},e=JUL.apply({"exportListeners":!0,"stripFunction":!0,"listenerPrefix":"","listenersProperty":this.current.listenersProperty,"mergeLogic":!0,"expandMembers":!this.currentParser.useTags,"rootWrapper":"root"},[this.current.parserConfig,e]),e.topDown=!0,e.expandMembers&&(e.membersProperties=[].concat(e.childrenProperty,e.membersProperties||[]),e.childrenProperty="_children_"),e.xmlDoc=JUL.UI._createXml(t.replace('"1.0"','"1.0" encoding="UTF-8"')+'<root xmlns="#customXMLns:" />'),e.xmlDoc.removeChild(e.xmlDoc.lastChild);var n=JUL.typeOf(this.current.ui)==="Array";e.xmlNS=JUL.apply({},JUL.UI.xmlNS);for(var r in e.xmlNS)e.xmlNS.hasOwnProperty(r)&&(e.xmlNS[r]="#customXMLns:"+e.xmlNS[r]);e.customFactory=this.createXml;var i=new JUL.UI.Parser(e),s=e.expandMembers?n?this.current.ui.map(i.expand,i):i.expand(this.current.ui):this.current.ui,o=null;if(e.mergeLogic){o=e.expandMembers?JUL.apply({},this.current.logic):this.current.logic;if(e.expandMembers)for(var u in o)o.hasOwnProperty(u)&&(o[u]=i.expand(o[u]))}if(n){var a={};a[i.classProperty]=i.useTags?i.defaultClass:e.rootWrapper,i.useTags&&(a[i.tagProperty]=e.rootWrapper),a[i.parentProperty]=e.xmlDoc,i.createComponent(a)}i.create(s,o,n?e.xmlDoc.lastChild:e.xmlDoc);try{JUL.Designer.state._serializer=JUL.Designer.state._serializer||new XMLSerializer}catch(f){}var l=JUL.Designer.state._serializer,c=e.xmlDoc.xmlEncoding||e.xmlDoc.characterSet||e.xmlDoc.charset,h=l?l.serializeToString(e.xmlDoc):e.xmlDoc.xml||"";h=h.replace(/#customXMLns:/g,"");var p=0;h.substr(0,5)==="<?xml"?(p=h.indexOf("?>")+2,t=h.substr(0,p),h=h.substr(h.indexOf("<",p))):c&&(t=t.replace('"1.0"','"1.0" encoding="'+c.toUpperCase()+'"'));var d=this.formatXml(h.replace(/\t/g,"&#9;").replace(/\n/g,"&#10;")).split("\n");for(var v=0;v<d.length;v++)p=d[v].indexOf("<"),d[v]=d[v].replace(/&#10;/g,"\n"+(p>0?d[v].substr(0,p):"")).replace(/&#9;/g,"	");return(t+"\n"+d.join("\n")).replace(/\t/g,JUL.Designer.parser._tabString)},"undo":function(){var e=this.state.clipboard.undo,t=0;if(!e){window.alert("Nothing to undo");return}this.removeTree();switch(e.operation){case"removeNodes":for(t=0;t<e.ui.length;t++){if(e.wasArray[t]){var n=e.where[t].parent;n.val(n.val()||[]),JUL.typeOf(n.val())!=="Array"&&n.val([n.val()]),e.where[t].ref(n.val()),e.where[t].ref().splice(e.where[t].key(),0,e.ui[t])}else e.where[t].val(e.ui[t]);e.logic[t]&&JUL.apply(this.current.logic,e.logic[t])}break;case"addNodes":for(t=e.where.length-1;t>=0;t--)e.where[t].parent?(e.where[t].ref().splice(e.where[t].key(),1),t||(e.toArray?e.where[t].parent.val(e.where[t].ref()[0]):e.where[t].ref().length||e.where[t].parent.del())):e.where[t].del();for(t=e.logic.length-1;t>=0;t--)delete this.current.logic[e.logic[t]];break;case"changeMembers":var r=this.currentParser;this.initConfig(e.show.val()),e.tabIndex===1&&(e.owner=this.getTarget(e.show.val())),e.tabIndex===2&&(e.owner=this.getTarget(e.show.val())[this.current.listenersProperty]);if(r.idProperty in e.items||e.del.indexOf(r.idProperty)>-1){var i=e.owner[r.bindingProperty];this.swapLogic(e.show,e.items[r.idProperty]||i,e.owner[r.idProperty]||i,!0)}if(r.bindingProperty in e.items||e.del.indexOf(r.bindingProperty)>-1){var s=e.owner[r.idProperty];this.swapLogic(e.show,s||e.items[r.bindingProperty],s||e.owner[r.bindingProperty],!0)}for(var o in e.items)e.items.hasOwnProperty(o)&&(e.owner[o]=e.items[o]);for(t=0;t<e.del.length;t++)delete e.owner[e.del[t]];break;case"shiftNode":var u=e.next.val();e.next.ref().splice(e.next.key(),1),e.next.ref().splice(e.prev.key(),0,u);var a=e.next.key();e.next.key(e.prev.key()),e.prev.key(a);break;case"changeWhere":var f=e.where.val(),l=this.getId(f);e.toLogic?(f[e.what]=this.current.logic[l][e.what],delete this.current.logic[l][e.what]):(this.current.logic[l]||(this.current.logic[l]={}),this.current.logic[l][e.what]=f[e.what],delete f[e.what]);break;case"changeType":e.toArray?e.target[e.what]=e.target[e.what][0]:e.target[e.what]=[e.target[e.what]];break;default:delete this.state.clipboard.undo;return}this.save(!0),this.buildTree(),e.show&&typeof e.show=="object"&&(e.show=this.findPath(e.show.val())),e.show!==!1&&(this.state.showTab=e.tabIndex,this.showPath(e.show,e.show?e.show.showWhat:!1)),delete this.state.clipboard.undo}})}(),function(){"use strict";JUL.ns("JUL.Designer.framework"),JUL.Designer.framework.ui={"tag":"dialog","id":"dialog-framework","title":"Framework","width":980,"height":470,"hidden":!0,"children":[{"tag":"tabbox","children":[{"tag":"tabs","id":"tabs-framework","children":[{"tag":"tab","label":"Settings","width":80,"pack":"center"},{"tag":"tab","label":"Components","width":80,"pack":"center"}]}]},{"tag":"deck","id":"deck-framework","flex":1,"children":[{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-framework-settings","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Setting","width":250},{"tag":"listheader","label":"Value","width":380},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"hbox","flex":1,"children":[{"tag":"vbox","id":"vbox-framework-components","width":220,"minwidth":120,"children":[{"tag":"description","css":"caption","value":"Component"},{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","label":"Add","id":"button-add-component"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Remove","id":"button-remove-component"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Change","id":"button-change-component"}]},{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"hbox","width":"95%","children":[{"tag":"textbox","id":"textbox-component-name","style":"margin-top:6px","tooltiptext":"Component name","width":200}]}]},{"tag":"listbox","flex":1,"id":"listbox-framework-components","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Name","width":200}]},{"tag":"listbody"}]}]},{"tag":"splitter"},{"tag":"vbox","flex":1,"children":[{"tag":"description","css":"caption","value":"Component settings"},{"tag":"listbox","height":150,"minheight":70,"id":"listbox-framework-component-settings","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Setting","width":240},{"tag":"listheader","label":"Value","width":320},{"tag":"listheader","label":"Code","width":40}]},{"tag":"listbody"}]},{"tag":"splitter"},{"tag":"description","css":"caption","value":"Members & events"},{"tag":"tabbox","id":"tabbox-current-component","children":[{"tag":"tabs","id":"tabs-framework-component-members","children":[{"tag":"tab","label":"Members","width":60,"pack":"center"},{"tag":"tab","label":"Events","width":60,"pack":"center"}]}]},{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","label":"Add","id":"button-add-member"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Remove","id":"button-remove-member"},{"tag":"toolbarseparator"},{"tag":"toolbarbutton","label":"Change","id":"button-change-member"},{"tag":"toolbarseparator"},{"tag":"hbox","width":"95%","children":[{"tag":"textbox","id":"textbox-member-name","style":"margin-top:6px","tooltiptext":"Member or event name","width":200}]}]},{"tag":"deck","id":"deck-framework-component-members","flex":1,"children":[{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-framework-component-members","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Name","width":150},{"tag":"listheader","label":"Description","width":80},{"tag":"listheader","label":"Logic","width":60},{"tag":"listheader","label":"Required","width":60},{"tag":"listheader","label":"Default value","width":150},{"tag":"listheader","label":"Code","width":40},{"tag":"listheader","label":"Template","width":80},{"tag":"listheader","label":"Hidden","width":60}]},{"tag":"listbody"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"listbox","flex":1,"id":"listbox-framework-component-events","children":[{"tag":"listhead","children":[{"tag":"listheader","label":"Name","width":150},{"tag":"listheader","label":"Description","width":90},{"tag":"listheader","label":"Template","width":90},{"tag":"listheader","label":"Hidden","width":60}]},{"tag":"listbody"}]}]}]}]}]}]}]}]},JUL.Designer.framework.logic={"button-add-component":{"listeners":{"command":function(){JUL.Designer.framework.addComponent()}}},"button-add-member":{"listeners":{"command":function(){var e=ample.getElementById("tabbox-current-component").selectedIndex;JUL.Designer.framework.addMember(e?"events":"members")}}},"button-change-component":{"listeners":{"command":function(){var e=ample.getElementById("listbox-framework-components").selectedItems;if(!e.length){window.alert("Please select an item");return}var t=e.item(e.length-1);JUL.Designer.framework.changeComponent(JUL.Designer.getWhere(t),t)}}},"button-change-member":{"listeners":{"command":function(){var e=ample.getElementById("tabbox-current-component").selectedIndex,t=e?"events":"members",n=ample.getElementById("listbox-framework-component-"+t).selectedItems;if(!n.length){window.alert("Please select an item");return}var r=n.item(n.length-1);JUL.Designer.framework.changeMember(JUL.Designer.getWhere(r),t,r)}}},"button-remove-component":{"listeners":{"command":function(){var e=ample.getElementById("listbox-framework-components").selectedItems;if(!e.length){window.alert("Please select some items");return}var t=[];for(var n=0;n<e.length;n++)t[n]=JUL.Designer.getWhere(e.item(n));JUL.Designer.framework.removeComponents(t),JUL.Designer.empty(e,!0)}}},"button-remove-member":{"listeners":{"command":function(){var e=ample.getElementById("tabbox-current-component").selectedIndex,t=e?"events":"members",n=ample.getElementById("listbox-framework-component-"+t).selectedItems;if(!n.length){window.alert("Please select some items");return}var r=[];for(var i=0;i<n.length;i++)r[i]=JUL.Designer.getWhere(n.item(i));JUL.Designer.empty(n,!0),JUL.Designer.framework.removeMembers(r)}}},"dialog-framework":{"listeners":{"dialogaccept":function(){return JUL.Designer.framework.save(),JUL.Designer.cleanMap(),!1},"dialogcancel":function(){return JUL.Designer.framework.cancel(),JUL.Designer.cleanMap(),!1}}},"listbox-framework-component-events":{"listeners":{"select":function(e){var t=this.selectedItems;ample.getElementById("textbox-member-name").setAttribute("value",t.length?JUL.Designer.getWhere(t.item(t.length-1)):"")}}},"listbox-framework-component-members":{"listeners":{"select":function(e){var t=this.selectedItems;ample.getElementById("textbox-member-name").setAttribute("value",t.length?JUL.Designer.getWhere(t.item(t.length-1)):"")}}},"listbox-framework-components":{"listeners":{"select":function(e){var t=JUL.Designer.framework;t.state.selectTimer&&clearTimeout(t.state.selectTimer),t.state.selectTimer=setTimeout(function(){delete t.state.selectTimer;var e=ample.getElementById("listbox-framework-components").selectedItems;t.onSelectComponent(e.length?JUL.Designer.getWhere(e.item(e.length-1)):null)},100)}}},"tabs-framework":{"listeners":{"select":function(){ample.getElementById("deck-framework").setAttribute("selectedIndex",this.parentNode.selectedIndex)}}},"tabs-framework-component-members":{"listeners":{"select":function(){var e=ample.getElementById("tabbox-current-component").selectedIndex;ample.getElementById("deck-framework-component-members").setAttribute("selectedIndex",e);var t=e?"events":"members";JUL.Designer.framework.currentConfig=JUL.Designer.framework.currentComponent?JUL.Designer.framework.currentComponent[t]:null;var n=ample.getElementById("listbox-framework-component-"+t).selectedItems;ample.getElementById("textbox-member-name").setAttribute("value",n.length?JUL.Designer.getWhere(n.item(n.length-1)):"")}}},"textbox-component-name":{"listeners":{"keypress":function(e){if(e.keyIdentifier==="Enter"){var t=ample.getElementById("listbox-framework-components").selectedItems;if(t.length&&!e.shiftKey){var n=t.item(t.length-1);JUL.Designer.framework.changeComponent(JUL.Designer.getWhere(n),n)}else JUL.Designer.framework.addComponent()}}}},"textbox-member-name":{"listeners":{"keypress":function(e){if(e.keyIdentifier==="Enter"){var t=ample.getElementById("tabbox-current-component").selectedIndex,n=t?"events":"members",r=ample.getElementById("listbox-framework-component-"+n).selectedItems;if(r.length&&!e.shiftKey){var i=r.item(r.length-1);JUL.Designer.framework.changeMember(JUL.Designer.getWhere(i),n,i)}else JUL.Designer.framework.addMember(n)}}}}},JUL.apply(JUL.Designer.framework,{"augmentLevel":10,"componentFields":{"description":{"tooltip":"Component description","id":"setting-component-description","template":"<string>"},"restrictParent":{"tooltip":"Array of component class names this can be child of (special value 'document')","id":"setting-component-restrict-parent","template":'Class1", "Class2" ... ]'},"inherits":{"tooltip":"Name or array of names of inherited component classes","id":"setting-component-inherits","template":"<string>"},"getBoundingRect":{"tooltip":"Component (inherited) method that gets the visible bounding rectangle","id":"setting-component-bouding-rect","template":"\u00a0function(/*this*/) { ... return {left: <>, top: <>, width: <>, height: <>[, zIndex: <>]}; }"}},"current":{},"currentComponent":null,"currentConfig":null,"fields":{"title":{"tooltip":"Framework's title","id":"setting-framework-title","defaultValue":"Framework 1","required":!0,"template":"<string>"},"ns":{"tooltip":"Namespace path","id":"setting-framework-ns","defaultValue":"framework1","required":!0,"template":"<string>"},"nsAlias":{"tooltip":"Use this namespace instead, when adding or finding the components","id":"setting-framework-ns-alias","template":"<string>"},"prependNS":{"tooltip":"If checked, framework's namespace will be prepended to each component name","id":"setting-framework-prepend-ns","required":!0,"defaultValue":!1,"template":"<boolean>"},"getBoundingRect":{"tooltip":"Framework method that gets the visible bounding rectangle","id":"setting-framework-bouding-rect","template":"\u00a0function(/*this*/) { ... return {left: <>, top: <>, width: <>, height: <>[, zIndex: <>]}; }"},"augments":{"tooltip":"Framework namespace to build this upon (inherit all components and their configs)","id":"setting-framework-augments","template":"<string>"},"groupByLevel":{"tooltip":"Groups components by the framework inheritance level","id":"setting-framework-group-by","required":!0,"defaultValue":!1,"template":"<boolean>"}},"state":{"newFramework":null,"currentOperation":""},"addComponent":function(){var e=this.state.newFramework;e.components||(e.components={});var t=1,n=JUL.trim(ample.getElementById("textbox-component-name").getAttribute("value"));if(!n||e.components[n])while((n="component"+t++)&&e.components[n]);ample.getElementById("textbox-component-name").setAttribute("value",""),e.components[n]={};var r={};r[n]=e.components[n],JUL.Designer.fillListbox("listbox-framework-components",r,e.components,["label"]),ample.getElementById("listbox-framework-components").querySelector("xul|listbody").lastChild.scrollIntoView(),ample.getElementById("listbox-framework-components").clearSelection()},"addLevelMap":function(e,t){if(!e)return;t||(t=0,this.state.levelMap={}),t="l"+(1e3+t).toString().substr(1);if(typeof e!="object"){this.state.levelMap[e]=t;return}for(var n in e)e.hasOwnProperty(n)&&(this.state.levelMap[n]=t)},"addMember":function(e){if(!this.currentComponent){window.alert("Please select a component from the left");return}var t=1,n=JUL.trim(ample.getElementById("textbox-member-name").getAttribute("value"));if(!n||this.currentConfig[n])while((n=e.slice(0,-1)+t++)&&this.currentConfig[n]);ample.getElementById("textbox-member-name").setAttribute("value",""),this.currentConfig[n]={};var r={};e==="events"?(this.currentConfig[n]={"hidden":!1},r[n]={},JUL.Designer.fillListbox("listbox-framework-component-events",r,this.currentConfig,["label","description-description","description-template","value-hidden"],!0)):(this.currentConfig[n]={"logic":!1,"required":!1,"hidden":!1},r[n]={},JUL.Designer.fillListbox("listbox-framework-component-members",r,this.currentConfig,["label","description-description","value-logic","value-required","value-defaultValue","code-defaultValue","description-template","value-hidden"],!0)),ample.getElementById("listbox-framework-component-"+e).querySelector("xul|listbody").lastChild.scrollIntoView(),ample.getElementById("listbox-framework-component-"+e).clearSelection()},"augment":function(e){var t=JUL.Designer.framework,n=e?JSON.parse(e,JUL.makeCaller(JUL.Designer.parser,JUL.Designer.jsonReviver)):null;n&&!n.error?(JUL.Designer.makeCompat(n,e),n=n.result):n=null;if(n){t.current.getetBoundingRect=t.current.getetBoundingRect||n.getBoundingRect,t.current.augments=n.augments,n.components=n.components||{};for(var r in n.components)if(n.components.hasOwnProperty(r)){t.current.components=t.current.components||{},t.addLevelMap(r,t.state.parents.length);if(t.current.components[r]){var i=t.current.components[r];i.restrictParent=i.restrictParent||n.components[r].restrictParent,i.inherits=i.inherits||n.components[r].inherits,i.getBoundingRect=i.getBoundingRect||n.components[r].getBoundingRect;var s=n.components[r].members||{};for(var o in s)s.hasOwnProperty(o)&&(i.members=i.members||{},i.members[o]||(i.members[o]=s[o]));var u=n.components[r].events||{};for(o in u)u.hasOwnProperty(o)&&(i.events=i.events||{},i.events[o]||(i.events[o]=u[o]))}else t.current.components[r]=n.components[r]}}if(!t.current.augments||t.state.parents.length>t.augmentLevel||t.state.parents.indexOf(t.current.augments)>-1||e&&!n){delete t.current.augments,JUL.Designer.panels.browse.hide(),JUL.Designer.panels.framework.hide(),JUL.Designer.state.lastDialog=null,t.onSelectComponent(),JUL.Designer.empty(ample.getElementById("listbox-framework-components").body),t.onSwitchCurrent();return}n&&t.state.parents.push(t.current.ns),ample.getElementById("statusbarpanel-framework").setAttribute("label","+ "+t.current.augments+" ..."),ample.get("assets/frameworks/"+t.current.augments.split(".").join("/")+".txt",{"ts":(new Date).getTime()},t.augment)},"cancel":function(){this.state.newFramework=null,JUL.Designer.panels.framework.hide(),JUL.Designer.state.lastDialog=null},"changeComponent":function(e,t){var n=JUL.trim(ample.getElementById("textbox-component-name").getAttribute("value")),r=this.state.newFramework;if(!n||n===e||r.components[n]){ample.getElementById("textbox-component-name").setAttribute("value",e);return}r.components[n]=r.components[e],delete r.components[e],JUL.Designer.state.map[t.getAttribute("id")]=n,t.firstChild.setAttribute("label",n),ample.getElementById("listbox-framework-components").clearSelection()},"changeMember":function(e,t,n){var r=JUL.trim(ample.getElementById("textbox-member-name").getAttribute("value"));if(!r||r===e||this.currentConfig[r])return ample.getElementById("textbox-member-name").setAttribute("value",e),!1;this.currentConfig[r]=this.currentConfig[e],delete this.currentConfig[e],JUL.Designer.state.map[n.getAttribute("id")]=r,n.firstChild.setAttribute("label",r);var i=n.childNodes[1];while(i){var s=JUL.Designer.getWhere(i.firstChild);s.field.label=r+" - "+s.key(),s.key()==="defaultValue"&&i.firstChild.nodeName==="xul:button"&&i.firstChild.setAttribute("tooltiptext",s.field.label),i=i.nextSibling}return ample.getElementById("listbox-framework-component-"+t).clearSelection(),r},"close":function(){this.onSelectComponent(),JUL.Designer.empty(ample.getElementById("listbox-framework-components").body),this.current={},this.state.origFramework=null,this.onSwitchCurrent()},"del":function(){if(!this.current.ns){window.alert("There is no current framework");return}if(!window.confirm("Are you sure to permanently delete '"+this.current.title+"' framework?"))return;ample.get("assets/alter.txt",{"ts":(new Date).getTime()},function(e){e=JSON.parse(e),e.error?window.alert(e.error):JUL.Designer.framework.close()})},"fillScrollbox":function(e){JUL.Designer.empty(ample.getElementById("scrollbox-components")),JUL.Designer.empty(ample.getElementById("table-add-component").lastChild);var t=this.current;if(!t.components)return;var n=t.nsAlias||t.ns,r=!1;if(e){var i=JUL.Designer.designer.currentParser;r=e[i.classProperty]||i.defaultClass,i.useTags?r=r===n?e[i.tagProperty]:"":t.prependNS&&r.indexOf(n+".")===0&&(r=r.substr(n.length+1))}var s=ample.getElementById("scrollbox-components"),o=ample.getElementById("table-add-component").lastChild,u=[];for(var a in t.components)t.components.hasOwnProperty(a)&&u.push(a);var f=/_/g,l=this.state.levelMap,c=function(e,n){return t.groupByLevel&&l[e]!==l[n]?l[e]>l[n]?1:-1:(e=e.replace(f,"~"),n=n.replace(f,"~"),e.toUpperCase()===n.toUpperCase()?e>n?1:-1:e.toUpperCase()>n.toUpperCase()?1:-1)};u.sort(c);var h=1;for(var p=0;p<u.length;p++){a=u[p];var d=t.components[a],v=[];d.restrictParent&&(v=v.concat(d.restrictParent));if(t.components.hasOwnProperty(a)&&(!d.restrictParent||r===!1&&v.indexOf("document")>-1||v.indexOf(r||"")>-1)){var m={"tag":"button","id":"button-add-comp-"+h,"label":a,"width":"99%","css":"cbutton","parent":s,"listeners":{"command":function(){JUL.Designer.designer.addComponent(JUL.Designer.getWhere(this))}}};JUL.Designer.state.map[m.id]=a,d.description&&(m.tooltiptext=d.description),JUL.Designer.parser.createComponent(m),delete m.width,delete m.css,m.tag="menuitem",m.id="menubutton-add-comp-"+h,m.parent=o,JUL.Designer.state.map[m.id]=a,JUL.Designer.parser.createComponent(m),h++}}},"getInherited":function(e,t){if(!e.inherits)return e[t];var n={},r=[].concat(e.inherits),i=this.current.components;for(var s=0;s<r.length;s++){var o=r[s];i[o]&&i[o]!==e&&JUL.apply(n,this.getInherited(i[o],t))}return e[t]&&JUL.apply(n,e[t]),n},"getInheritedProperty":function(e,t){if(!e.inherits||typeof e[t]!="undefined")return e[t];var n=this._undef,r=[].concat(e.inherits),i=this.current.components;for(var s=r.length-1;s>-1;s--){var o=r[s];if(i[o]&&i[o]!==e){n=this.getInheritedProperty(i[o],t);if(typeof n!="undefined")return n}}return n},"onSelectComponent":function(e){JUL.Designer.empty(ample.getElementById("listbox-framework-component-settings").body),ample.getElementById("textbox-member-name").setAttribute("value",""),JUL.Designer.empty(ample.getElementById("listbox-framework-component-members").body),JUL.Designer.empty(ample.getElementById("listbox-framework-component-events").body),ample.getElementById("tabbox-current-component").querySelector("xul|tabs").firstChild.$activate();if(!e){ample.getElementById("textbox-component-name").setAttribute("value",""),this.currentComponent=null,this.currentConfig=null;return}var t=this.state.newFramework;this.currentComponent=t.components[e];if(!this.currentComponent)return;this.currentComponent.members||(this.currentComponent.members={}),this.currentComponent.events||(this.currentComponent.events={});for(var n in this.currentComponent.members)this.currentComponent.members.hasOwnProperty(n)&&JUL.apply(this.currentComponent
.members[n],{"logic":!1,"required":!1,"hidden":!1},!0);for(n in this.currentComponent.events)this.currentComponent.events.hasOwnProperty(n)&&JUL.apply(this.currentComponent.events[n],{"hidden":!1},!0);this.currentConfig=this.currentComponent.members,ample.getElementById("textbox-component-name").setAttribute("value",e),JUL.Designer.fillListbox("listbox-framework-component-settings",this.componentFields,this.currentComponent),JUL.Designer.fillListbox("listbox-framework-component-members",JUL.Designer.keySort(this.currentComponent.members),this.currentComponent.members,["label","description-description","value-logic","value-required","value-defaultValue","code-defaultValue","description-template","value-hidden"],!0),JUL.Designer.fillListbox("listbox-framework-component-events",JUL.Designer.keySort(this.currentComponent.events),this.currentComponent.events,["label","description-description","description-template","value-hidden"],!0)},"onSwitchCurrent":function(){JUL.Designer.designer.setTitle(),ample.getElementById("command-prepend-namespace").setAttribute("checked",this.current.prependNS||!1);var e=JUL.Designer.designer;if(e.currentNode){var t=JUL.Designer.getWhere(e.currentNode);this.fillScrollbox(t.val()),e.removeConfigListeners(t.val()),e.fillComponentLists(t.val()),e.addConfigListeners(t.val()),e.filterMembers(t)}else this.fillScrollbox(),e.filterMembers()},"open":function(e){ample.get("assets/frameworks/"+e.split(".").join("/")+".txt",{"ts":(new Date).getTime()},function(e){var t=JSON.parse(e,JUL.makeCaller(JUL.Designer.parser,JUL.Designer.jsonReviver));if(t.error){window.alert(t.error);return}JUL.Designer.makeCompat(t,e);var n=JUL.Designer.framework;n.state.origFramework=t.result,n.current=JUL.Designer.designer.copy(n.state.origFramework),n.addLevelMap(n.current.components||{}),n.state.parents=[n.current.ns],n.augment()})},"removeComponents":function(e){var t=this.state.newFramework,n;if(!t.components)return;for(var r=0;r<e.length;r++)n=e[r],t.components[n]&&(this.currentComponent===t.components[n]&&(this.currentComponent=null,this.currentConfig=null),delete t.components[n])},"removeMembers":function(e){var t;if(!this.currentConfig)return;for(var n=0;n<e.length;n++)t=e[n],delete this.currentConfig[t]},"save":function(){var e=this.state.newFramework;if(!JUL.Designer.validNS(e.ns)){window.alert("Invalid namespace");return}if(e.nsAlias&&!JUL.Designer.validNS(e.nsAlias)){window.alert("Invalid namespace alias");return}if(e.augments&&!JUL.Designer.validNS(e.augments)){window.alert("Invalid augments namespace");return}e.version="1."+(new Date).getTime(),JUL.Designer.applyRequired(this.fields,e),e=JUL.Designer.keySort(e,"components");if(e.components){JUL.Designer.isEmpty(e.components)?delete e.components:e.components=JUL.Designer.keySort(e.components);for(var t in e.components)if(e.components.hasOwnProperty(t)){var n=e.components[t];JUL.Designer.applyRequired(this.componentFields,n),n=JUL.Designer.keySort(n,["members","events"]),e.components[t]=n,n.members&&(JUL.Designer.isEmpty(n.members)?delete n.members:n.members=JUL.Designer.keySort(n.members)),n.events&&(JUL.Designer.isEmpty(n.events)?delete n.events:n.events=JUL.Designer.keySort(n.events))}}ample.get("assets/alter.txt",{"ts":(new Date).getTime()},function(e){e=JSON.parse(e);if(e.error)window.alert(e.error);else{var t=JUL.Designer.framework;t.state.origFramework=t.state.newFramework,t.state.newFramework=null,t.current=JUL.Designer.designer.copy(t.state.origFramework),t.addLevelMap(t.current.components||{}),t.state.parents=[t.current.ns],t.augment()}})},"scrollLists":function(){var e=ample.getElementById("listbox-framework-components").selectedItems;e.length&&e.item(e.length-1).scrollIntoView(),e=ample.getElementById("listbox-framework-component-members").selectedItems,e.length&&e.item(e.length-1).scrollIntoView(),e=ample.getElementById("listbox-framework-component-events").selectedItems,e.length&&e.item(e.length-1).scrollIntoView()},"show":function(e){if(e==="edit"&&!this.current.ns){window.alert("There is no current framework");return}e==="new"?this.state.newFramework={}:this.state.newFramework=JUL.Designer.designer.copy(this.state.origFramework);var t=this.state.newFramework;JUL.Designer.empty(ample.getElementById("listbox-framework-settings").body),ample.getElementById("textbox-component-name").setAttribute("value",""),JUL.Designer.empty(ample.getElementById("listbox-framework-component-settings").body),ample.getElementById("textbox-member-name").setAttribute("value",""),JUL.Designer.empty(ample.getElementById("listbox-framework-component-members").body),JUL.Designer.empty(ample.getElementById("listbox-framework-component-events").body),JUL.Designer.empty(ample.getElementById("listbox-framework-components").body),JUL.Designer.fillListbox("listbox-framework-settings",this.fields,t),t.components&&JUL.Designer.fillListbox("listbox-framework-components",JUL.Designer.keySort(t.components),t.components,["label"]),this.state.currentOperation=e,JUL.Designer.panels.framework.setAttribute("title",e==="new"?"New framework":"Edit framework - "+t.title),JUL.Designer.state.lastDialog=JUL.Designer.panels.framework,JUL.Designer.panels.framework.showModal(),JUL.Designer.panels.framework.querySelector("xul|tabs").firstChild.$activate()}})}(),function(){"use strict";JUL.ns("JUL.Designer.help"),JUL.Designer.help.ui={"tag":"window","hidden":!0,"title":JUL.Designer.title+" Help","width":980,"height":480,"children":[{"tag":"toolbox","children":[{"tag":"toolbar","children":[{"tag":"toolbargrippy"},{"tag":"toolbarbutton","type":"checkbox","checked":!0,"label":"Show contents","listeners":{"command":function(){ample.getElementById("tree-help").setAttribute("hidden",this.getAttribute("checked")!=="true")}}},{"tag":"toolbarseparator"},{"tag":"vbox","flex":1},{"xclass":"html","tag":"div","width":220,"style":"padding:5px 18px 0 0;text-align:right","children":[{"xclass":"html","tag":"a","target":"_blank","href":"docs/index.html?1489485881291","html":"Open in a new window"}]}]}]},{"tag":"hbox","flex":1,"children":[{"tag":"tree","id":"tree-help","seltype":"single","width":280,"height":"100%","children":[{"tag":"treecols","children":[{"tag":"treecol","primary":!0,"width":310,"label":"Contents"}]},{"tag":"treebody"}],"listeners":{"select":function(e){var t=this.selectedItems;if(!t.length)return;var n=ample.getElementById("iframe-help");n.setAttribute("src",JUL.Designer.help.src+"#"+t.item(t.length-1).getAttribute("id").substr(10))}}},{"tag":"vbox","flex":1,"children":[{"xclass":"html","tag":"div","flex":1,"children":[{"xclass":"html","tag":"iframe","id":"iframe-help","name":"iframe-help","width":"100%","height":"100%","seamless":"yes","style":"border:0","src":"docs/index.html?1489485881291"}]}]}]}]},JUL.apply(JUL.Designer.help,{"src":"docs/index.html?"+(new Date).getTime(),"onLoad":function(){var e=document.getElementById("iframe-help");e=e.contentDocument||e.contentWindow.document;var t=e.getElementById("toc");if(!t||!t.firstChild)return;var n=e.styleSheets[e.styleSheets.length-1];n.insertRule?n.insertRule(".to-top{display:none;}",0):n.addRule&&n.addRule(".to-top","display:none",0),t.style.cssText=t.style.cssText+";display:none";var r=function(e,t){if(!e.firstChild)return;var n,i,s;if(e.nodeType===1&&e.nodeName.toLowerCase()==="li"){n=JUL.Designer.parser.create({"tag":"treeitem","id":"node-help-"+e.firstChild.hash.substr(1),"container":!0,"open":!0,"children":[{"tag":"treerow","children":[{"tag":"treecell","label":e.firstChild.text||e.firstChild.innerText}]}]},null,t);for(i=1;i<e.childNodes.length;i++){s=e.childNodes[i];if(s.nodeType===1&&s.nodeName.toLowerCase()==="ul"){r(s,n);break}}}if(e.nodeType===1&&e.nodeName.toLowerCase()==="ul"){n=JUL.Designer.parser.create({"tag":"treechildren"},null,t);for(i=0;i<e.childNodes.length;i++)s=e.childNodes[i],s.nodeType===1&&s.nodeName.toLowerCase()==="li"&&r(s,n)}},i=ample.getElementById("tree-help").querySelector("xul|treebody");for(var s=0;s<t.childNodes.length;s++){if(t.childNodes[s].nodeType===1&&t.childNodes[s].nodeName.toLowerCase()==="ul"){r(t.childNodes[s],i);break}ample.getElementById("tree-help").reflow()}}})}(),function(){"use strict";JUL.ns("JUL.Designer.about"),JUL.Designer.about.ui={"tag":"window","css":"logo-bg","hidden":!0,"title":"About","width":617,"height":251,"aml:resizable":!1,"orient":"horizontal","children":[{"tag":"vbox","width":262,"children":[{"xclass":"html","tag":"div","style":"padding: 8px","flex":1,"children":[{"xclass":"html","tag":"img","width":240,"height":224,"alt":JUL.Designer.title,"src":"media/jul224.png"}]}]},{"tag":"vbox","flex":1,"children":[{"tag":"spacer","height":60},{"tag":"description","css":"logo-title","value":JUL.Designer.title},{"tag":"description","value":"Version "+JUL.Designer.version},{"tag":"description","html":'Copyright &copy; 2014 - 20182019 <a target="_blank" href="'+ample.$encodeXMLCharacters(JUL.Designer.config.zb_link)+'">The Zonebuilder</a>'},{"tag":"description","html":'Powered by <a target="_blank" href="http://www.amplesdk.com/">Ample SDK</a>, <a target="_blank" href="http://nodejs.org/">Node.js</a> &amp; <a target="_blank" href="http://kohanaframework.org/">Kohana PHP</a>'}]}],"listeners":{"click":function(e){e.target.nodeName!=="a"&&this.hide(e)}}},JUL.apply(JUL.Designer.about,{})}();
