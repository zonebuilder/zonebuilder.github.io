/* generated by JUL Designer version 1.8.5 */
/* 'JWL Components - Options object stored as JSON' namespace */
JUL.ns('JWL.components.jsonoptions');

JUL.apply(JWL.components.jsonoptions,
/* begin 'JWL Components - Options object stored as JSON' */
{
	keepBindings: true,
	listenersProperty: 'listeners',
	noLogic: false,
	ns: 'JWL.components.jsonoptions',
	suggestedFramework: 'html',
	title: 'JWL Components - Options object stored as JSON',
	version: '1.1470634687332',
	init: function () {
		JWL.parser._keepInstance = true;
		JWL.parser.create(this.ui, this.logic, document.body);
	}
}
/* end 'JWL Components - Options object stored as JSON' */
);

JWL.components.jsonoptions.parserConfig =
/* begin 'JWL Components - Options object stored as JSON' parser config */
{
	customFactory: 'JUL.UI.createDom',
	defaultClass: 'html',
	topDown: true,
	useTags: true
}
/* end 'JWL Components - Options object stored as JSON' parser config */
;

JWL.components.jsonoptions.ui =
/* begin 'JWL Components - Options object stored as JSON' UI */
{
	tag: 'div',
	cid: '.jsonoptions',
	css: 'jsonoptions',
	children: [
		{tag: 'a', cid: '.jsonoptions-show', css: 'fa fa-gear', href: '#', title: 'Options'},
		{tag: 'div', css: 'jsonoptions-opts-wrap', children: [
			{tag: 'div', css: 'jsonoptions-opts', children: [
				{tag: 'textarea', cid: '.jsonoptions-edit', cols: '30', rows: '10', wrap: 'off'},
				{tag: 'div', css: 'jsonoptions-buttons', children: [
					{tag: 'button', cid: '.jsonoptions-ok', html: 'OK'},
					{tag: 'button', cid: '.jsonoptions-cancel', html: 'Cancel'}
				]}
			]}
		]}
	]
}
/* end 'JWL Components - Options object stored as JSON' UI */
;

JWL.components.jsonoptions.logic =
/* begin 'JWL Components - Options object stored as JSON' logic */
{
	'.jsonoptions': {
		'data-options': ''
	},
	'.jsonoptions-cancel': {
		listeners: {
			click: function () {
				var oOpts = this.parentNode.parentNode;
				var sClass = oOpts.getAttribute('class');
				oOpts.setAttribute('class', sClass.replace('shown', ''));
			}
		}
	},
	'.jsonoptions-ok': {
		listeners: {
			click: function () {
				var oOpts = this.parentNode.parentNode;
				var sJson = JUL.trim(oOpts.firstChild.value);
				if (sJson) {
					try { sJson = JSON.stringify(JSON.parse(sJson)); }
					catch (e) { window.alert('Text must be valid JSON.\n' + (e.description || e.message)); return; }
				}
			oOpts.parentNode.parentNode.setAttribute('data-options', sJson);
				var sClass = oOpts.getAttribute('class');
				oOpts.setAttribute('class', sClass.replace('shown', ''));
				JWL.trigger(oOpts.parentNode.parentNode, 'optionschanged');
			}
		}
	},
	'.jsonoptions-show': {
		listeners: {
			click: function (oEvent) {
				oEvent = oEvent || event;	
				try { oEvent.preventDefault(); } catch(e) {}
				var oOpts = this.nextSibling.firstChild;
			
				var sClass = oOpts.getAttribute('class');
				if (sClass.indexOf('shown') > -1) {
					oOpts.setAttribute('class', sClass.replace('shown', ''));
			}
				else {
					var sJson = this.parentNode.getAttribute('data-options') || '';
					try { sJson = JUL.UI.obj2str(JSON.parse(sJson), true); } catch (e) {}
					oOpts.firstChild.value = sJson;
					oOpts.setAttribute('class', sClass + ' shown');
				}
				return false;
			}
		}
	}
}
/* end 'JWL Components - Options object stored as JSON' logic */
;

